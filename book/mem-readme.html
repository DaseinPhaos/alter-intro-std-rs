<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="rustdoc">
    <title>std::mem</title>

    <link rel="stylesheet" type="text/css" href="rustbook.css">

    
</head>
<body class="rustdoc">
    <!--[if lte IE 8]>
    <div class="warning">
        This old browser is unsupported and will most likely display funky
        things.
    </div>
    <![endif]-->

    
                <div id="nav">
                    <button id="toggle-nav">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="bar"></span>
                        <span class="bar"></span>
                        <span class="bar"></span>
                    </button>
                </div>
<div id='toc' class='mobile-hidden'>
<ol class='chapter'>
<li><a  href='README.html'><b>1.</b> Introduction</a>
</li>
<li><a  href='macros-readme.html'><b>2.</b> Macros in std</a>
</li>
<li><a  href='mods-readme.html'><b>3.</b> Uncategorized Modules</a>
<ol class='section'>
<li><a  href='any-readme.html'><b>3.1.</b> std::any</a>
</li>
<li><a  href='ascii-readme.html'><b>3.2.</b> std::ascii</a>
</li>
<li><a  href='borrow-readme.html'><b>3.3.</b> std::borrow</a>
</li>
<li><a  href='boxed-readme.html'><b>3.4.</b> std::boxed</a>
</li>
<li><a  href='cell-readme.html'><b>3.5.</b> std::cell</a>
</li>
<li><a  href='clone-readme.html'><b>3.6.</b> std::clone</a>
</li>
<li><a  href='cmp-readme.html'><b>3.7.</b> std::cmp</a>
</li>
<li><a  href='collections-readme.html'><b>3.8.</b> std::collections</a>
</li>
<li><a  href='convert-readme.html'><b>3.9.</b> std::convert</a>
</li>
<li><a  href='default-readme.html'><b>3.10.</b> std::default</a>
</li>
<li><a  href='env-readme.html'><b>3.11.</b> std::env</a>
</li>
<li><a  href='error-readme.html'><b>3.12.</b> std::error</a>
</li>
<li><a  href='ffi-readme.html'><b>3.13.</b> std::ffi</a>
</li>
<li><a  href='fmt-readme.html'><b>3.14.</b> std::fmt</a>
</li>
<li><a  href='fs-readme.html'><b>3.15.</b> std::fs</a>
</li>
<li><a  href='hash-readme.html'><b>3.16.</b> std::hash</a>
</li>
<li><a  href='io-readme.html'><b>3.17.</b> std::io</a>
</li>
<li><a  href='iter-readme.html'><b>3.18.</b> std::iter</a>
</li>
<li><a  href='marker-readme.html'><b>3.19.</b> std::marker</a>
</li>
<li><a class='active' href='mem-readme.html'><b>3.20.</b> std::mem</a>
</li>
</ol>
</li>
</ol>
</div>
<div id='page-wrapper'>
<div id='page'>


    <h1 class="title">std::mem</h1>
    <blockquote>
<p><a href="https://doc.rust-lang.org/std/mem/">https://doc.rust-lang.org/std/mem/</a></p>
</blockquote>

<p>This module contains functions dealing with memories.</p>

<pre class='rust rust-example-rendered'>
<span class='kw'>pub</span> <span class='kw'>fn</span> <span class='ident'>size_of</span><span class='op'>&lt;</span><span class='ident'>T</span><span class='op'>&gt;</span>() <span class='op'>-&gt;</span> <span class='ident'>usize</span><a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=fn%20main()%20%7B%0Apub%20fn%20size_of%3CT%3E()%20-%3E%20usize%0A%7D">Run</a></pre>

<p>returns the size of a type, in bytes.</p>

<hr>

<pre class='rust rust-example-rendered'>
<span class='kw'>pub</span> <span class='kw'>fn</span> <span class='ident'>size_of_val</span><span class='op'>&lt;</span><span class='ident'>T</span>: <span class='question-mark'>?</span><span class='ident'>Sized</span><span class='op'>&gt;</span>(<span class='ident'>val</span>: <span class='kw-2'>&amp;</span><span class='ident'>T</span>) <span class='op'>-&gt;</span> <span class='ident'>usize</span><a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=fn%20main()%20%7B%0Apub%20fn%20size_of_val%3CT%3A%20%3FSized%3E(val%3A%20%26T)%20-%3E%20usize%0A%7D">Run</a></pre>

<p>returns the size of the type of the pointed value, in bytes.</p>

<p>Unlike <code>size_of</code>, this function can be used to get the dynamically-known size of a DST.</p>

<hr>

<pre class='rust rust-example-rendered'>
<span class='kw'>pub</span> <span class='kw'>fn</span> <span class='ident'>align_of</span><span class='op'>&lt;</span><span class='ident'>T</span><span class='op'>&gt;</span>() <span class='op'>-&gt;</span> <span class='ident'>usize</span><a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=fn%20main()%20%7B%0Apub%20fn%20align_of%3CT%3E()%20-%3E%20usize%0A%7D">Run</a></pre>

<p>returns the ABI-required minimum alignment of a type.</p>

<hr>

<pre class='rust rust-example-rendered'>
<span class='kw'>pub</span> <span class='kw'>fn</span> <span class='ident'>align_of_val</span><span class='op'>&lt;</span><span class='ident'>T</span>: <span class='question-mark'>?</span><span class='ident'>Sized</span><span class='op'>&gt;</span>(<span class='ident'>val</span>: <span class='kw-2'>&amp;</span><span class='ident'>T</span>) <span class='op'>-&gt;</span> <span class='ident'>usize</span><a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=fn%20main()%20%7B%0Apub%20fn%20align_of_val%3CT%3A%20%3FSized%3E(val%3A%20%26T)%20-%3E%20usize%0A%7D">Run</a></pre>

<p>returns the ABI-required minimum alignment of the type of value that reference <code>val</code> points to.</p>

<hr>

<pre class='rust rust-example-rendered'>
<span class='kw'>pub</span> <span class='kw'>fn</span> <span class='ident'>drop</span><span class='op'>&lt;</span><span class='ident'>T</span><span class='op'>&gt;</span>(<span class='ident'>_x</span>: <span class='ident'>T</span>) { }<a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=fn%20main()%20%7B%0Apub%20fn%20drop%3CT%3E(_x%3A%20T)%20%7B%20%7D%0A%7D">Run</a></pre>

<p>Disposes a value.</p>

<hr>

<pre class='rust rust-example-rendered'>
<span class='kw'>pub</span> <span class='kw'>fn</span> <span class='ident'>forget</span><span class='op'>&lt;</span><span class='ident'>T</span><span class='op'>&gt;</span>(<span class='ident'>t</span>: <span class='ident'>T</span>)<a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=fn%20main()%20%7B%0Apub%20fn%20forget%3CT%3E(t%3A%20T)%0A%7D">Run</a></pre>

<p>Unlike <code>drop</code>, <code>forget</code> takes ownership of the passed value, but <em>forgets</em> it: <strong>no destructor invoked!</strong></p>

<p>Common use cases:</p>

<ul>
<li><p>an uninitialized value produced by <code>mem::uninitialized</code> should either be initialized or forgotten before it goes out of the scope. Otherwise, running dtors on it would cause UB.</p></li>
<li><p>a bitwise-duplication of a droppable item was made. One of the value has to be forgotten before going out of scope, or double-dropping would introduce UB.</p></li>
<li><p>transferring ownership across FFI.</p></li>
</ul>

<hr>

<pre class='rust rust-example-rendered'>
<span class='kw'>pub</span> <span class='kw'>fn</span> <span class='ident'>swap</span><span class='op'>&lt;</span><span class='ident'>T</span><span class='op'>&gt;</span>(<span class='ident'>x</span>: <span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='ident'>T</span>, <span class='ident'>y</span>: <span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='ident'>T</span>)<a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=fn%20main()%20%7B%0Apub%20fn%20swap%3CT%3E(x%3A%20%26mut%20T%2C%20y%3A%20%26mut%20T)%0A%7D">Run</a></pre>

<p>Swaps the values at two mutable locations, without deinitializing either one.</p>

<hr>

<pre class='rust rust-example-rendered'>
<span class='kw'>pub</span> <span class='kw'>fn</span> <span class='ident'>replace</span><span class='op'>&lt;</span><span class='ident'>T</span><span class='op'>&gt;</span>(<span class='ident'>dest</span>: <span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='ident'>T</span>,<span class='kw-2'>mut</span> <span class='ident'>src</span>: <span class='ident'>T</span>) <span class='op'>-&gt;</span> <span class='ident'>T</span> {
    <span class='ident'>swap</span>(<span class='ident'>dest</span>, <span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='ident'>src</span>);
    <span class='ident'>src</span>
}<a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=fn%20main()%20%7B%0Apub%20fn%20replace%3CT%3E(dest%3A%20%26mut%20T%2Cmut%20src%3A%20T)%20-%3E%20T%20%7B%0A%20%20%20%20swap(dest%2C%20%26mut%20src)%3B%0A%20%20%20%20src%0A%7D%0A%7D">Run</a></pre>

<p>replaces the value at <code>dest</code> with <code>src</code>, returning the old value at <code>dest</code>, without deinitializing either one.</p>

<hr>

<pre class='rust rust-example-rendered'>
<span class='kw'>pub</span> <span class='kw'>unsafe</span> <span class='kw'>extern</span> <span class='string'>&quot;rust-intrinic&quot;</span> <span class='kw'>fn</span> <span class='ident'>transmute</span><span class='op'>&lt;</span><span class='ident'>T</span>, <span class='ident'>U</span><span class='op'>&gt;</span>(<span class='ident'>e</span>: <span class='ident'>T</span>) <span class='op'>-&gt;</span> <span class='ident'>U</span><a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=fn%20main()%20%7B%0Apub%20unsafe%20extern%20%22rust-intrinic%22%20fn%20transmute%3CT%2C%20U%3E(e%3A%20T)%20-%3E%20U%0A%7D">Run</a></pre>

<p>reinterprets the bits of a value of one type as another. The compiler only makes sure that <code>size_of&lt;T&gt;() == size_of&lt;U&gt;()</code>, nothing more. It is semantically equivalent to a bitwise move of a value of one type into a value of another type, After the transmutation the original type would be forgotten thus <strong>no dropping</strong> occurs.</p>

<p>This is marked as <code>unsafe</code>, because the caller must ensure that Rust&#39;s safety model won&#39;t be violated. Some common hints:</p>

<ul>
<li>The returned value must be in a valid state.</li>
<li>Transmuting between non-repr(C) types is UB.</li>
<li>Transmuting an immutable reference to a mutable one is UB.</li>
</ul>

<hr>

<pre class='rust rust-example-rendered'>
<span class='kw'>pub</span> <span class='kw'>unsafe</span> <span class='kw'>fn</span> <span class='ident'>transmute_copy</span><span class='op'>&lt;</span><span class='ident'>T</span>, <span class='ident'>U</span><span class='op'>&gt;</span>(<span class='ident'>src</span>: <span class='kw-2'>&amp;</span><span class='ident'>T</span>) <span class='op'>-&gt;</span> <span class='ident'>U</span><a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=fn%20main()%20%7B%0Apub%20unsafe%20fn%20transmute_copy%3CT%2C%20U%3E(src%3A%20%26T)%20-%3E%20U%0A%7D">Run</a></pre>

<p>reinterprets the bits of a value of a pointed type as another. The compiler made <strong>no</strong> assumption about the relation on size of the two types. It is semantically equivalent to a bitwise <strong>copy</strong>, starting from the location pointed by <code>src</code>, with a size of <code>size_of&lt;U&gt;()</code>, and returns the copied result as <code>U</code>.</p>

<p>Like <code>transmute</code>, this function is marked as <code>unsafe</code>. Callers must ensure that Rust&#39;s safety model won&#39;t be violated. Common hints include:</p>

<ul>
<li>Making sure that the returned value of type <code>U</code> is in a valid state.</li>
<li>Transmuting from a <code>src: &amp;T</code> to <code>U</code> where <code>size_of_val(src) &lt; size_of&lt;U&gt;()</code> <em>always</em> introduces UB.</li>
</ul>

<hr>

<pre class='rust rust-example-rendered'>
<span class='kw'>pub</span> <span class='kw'>unsafe</span> <span class='kw'>fn</span> <span class='ident'>uninitialized</span><span class='op'>&lt;</span><span class='ident'>T</span><span class='op'>&gt;</span>() <span class='op'>-&gt;</span> <span class='ident'>T</span><a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=fn%20main()%20%7B%0Apub%20unsafe%20fn%20uninitialized%3CT%3E()%20-%3E%20T%0A%7D">Run</a></pre>

<p>bypasses Rust&#39;s normal memory initialization checks, by pretending to produce a valid value of type <code>T</code>.</p>

<p>This is useful when dealing with <code>FFI</code> or initializing some complex arrays.</p>

<p>But the caller must ensure that any subsequent usage of the returned type <em>actually</em> respects that the value was uninitialized:</p>

<ul>
<li>reading always causes UB.</li>
<li>writing to such a value of type <code>T</code> where <code>T: Drop</code> or recursively contains any droppable fields also causes UB, because a value at invalid state would have been dropped before the new value being written in. The only way to safely initialize such a value is with <code>std::ptr::write</code>, <code>std::ptr::copy</code> or <code>std::ptr::copy_nonoverlapping</code>.</li>
<li>before it goes out of scope, it must be either forgotten or be given a valid state. Otherwise, subsequent dropping may introduce UB.</li>
</ul>

<p>The caller must make sure that such a value <em>is</em> properly initialized into a valid state before it can be used outside the <code>unsafe</code> code blocks.</p>

<hr>

<pre class='rust rust-example-rendered'>
<span class='kw'>pub</span> <span class='kw'>unsafe</span> <span class='kw'>fn</span> <span class='ident'>zeroed</span><span class='op'>&lt;</span><span class='ident'>T</span><span class='op'>&gt;</span>() <span class='op'>-&gt;</span> <span class='ident'>T</span><a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=fn%20main()%20%7B%0Apub%20unsafe%20fn%20zeroed%3CT%3E()%20-%3E%20T%0A%7D">Run</a></pre>

<p>Creates a value whose bits are all <code>0</code>.</p>

<p>Being <code>unsafe</code>, this gives the same responsibility to the caller as <code>uninitialized</code> does.</p>

    <script src='rustbook.js'></script>
</div></div>


</body>
</html>