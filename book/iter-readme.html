<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="rustdoc">
    <title>std::iter</title>

    <link rel="stylesheet" type="text/css" href="rustbook.css">

    
</head>
<body class="rustdoc">
    <!--[if lte IE 8]>
    <div class="warning">
        This old browser is unsupported and will most likely display funky
        things.
    </div>
    <![endif]-->

    
                <div id="nav">
                    <button id="toggle-nav">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="bar"></span>
                        <span class="bar"></span>
                        <span class="bar"></span>
                    </button>
                </div>
<div id='toc' class='mobile-hidden'>
<ol class='chapter'>
<li><a  href='README.html'><b>1.</b> Introduction</a>
</li>
<li><a  href='macros-readme.html'><b>2.</b> Macros in std</a>
</li>
<li><a  href='mods-readme.html'><b>3.</b> Uncategorized Modules</a>
<ol class='section'>
<li><a  href='any-readme.html'><b>3.1.</b> std::any</a>
</li>
<li><a  href='ascii-readme.html'><b>3.2.</b> std::ascii</a>
</li>
<li><a  href='borrow-readme.html'><b>3.3.</b> std::borrow</a>
</li>
<li><a  href='boxed-readme.html'><b>3.4.</b> std::boxed</a>
</li>
<li><a  href='cell-readme.html'><b>3.5.</b> std::cell</a>
</li>
<li><a  href='clone-readme.html'><b>3.6.</b> std::clone</a>
</li>
<li><a  href='cmp-readme.html'><b>3.7.</b> std::cmp</a>
</li>
<li><a  href='collections-readme.html'><b>3.8.</b> std::collections</a>
</li>
<li><a  href='convert-readme.html'><b>3.9.</b> std::convert</a>
</li>
<li><a  href='default-readme.html'><b>3.10.</b> std::default</a>
</li>
<li><a  href='env-readme.html'><b>3.11.</b> std::env</a>
</li>
<li><a  href='error-readme.html'><b>3.12.</b> std::error</a>
</li>
<li><a  href='ffi-readme.html'><b>3.13.</b> std::ffi</a>
</li>
<li><a  href='fmt-readme.html'><b>3.14.</b> std::fmt</a>
</li>
<li><a  href='fs-readme.html'><b>3.15.</b> std::fs</a>
</li>
<li><a  href='hash-readme.html'><b>3.16.</b> std::hash</a>
</li>
<li><a  href='io-readme.html'><b>3.17.</b> std::io</a>
</li>
<li><a class='active' href='iter-readme.html'><b>3.18.</b> std::iter</a>
</li>
</ol>
</li>
</ol>
</div>
<div id='page-wrapper'>
<div id='page'>


    <h1 class="title">std::iter</h1>
    <blockquote>
<p><a href="https://doc.rust-lang.org/std/iter/">https://doc.rust-lang.org/std/iter/</a></p>
</blockquote>

<p>This module introduces iteration into Rust.</p>

<h1 id='introduction' class='section-header'><a href='#introduction'>Introduction</a></h1>
<p>The heart and soul of this module is the <code>Iterator</code> trait:</p>

<pre class='rust rust-example-rendered'>
<span class='kw'>pub</span> <span class='kw'>trait</span> <span class='ident'>Iterator</span> {
    <span class='kw'>type</span> <span class='ident'>Item</span>;
    <span class='kw'>fn</span> <span class='ident'>next</span>(<span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='self'>self</span>) <span class='op'>-&gt;</span> <span class='prelude-ty'>Option</span><span class='op'>&lt;</span><span class='self'>Self</span>::<span class='ident'>Item</span><span class='op'>&gt;</span>;
}<a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=fn%20main()%20%7B%0Apub%20trait%20Iterator%20%7B%0A%20%20%20%20type%20Item%3B%0A%20%20%20%20fn%20next(%26mut%20self)%20-%3E%20Option%3CSelf%3A%3AItem%3E%3B%0A%7D%0A%7D">Run</a></pre>

<p>The required associated type, <code>Item</code>, represents the type of elements that this iterator is to iterate over.</p>

<p>The required <code>next</code> method defines the actual mechanism of iteration. Every invocation of it means another round of iteration. It returns an <code>Option&lt;Item&gt;</code>. If the returned value is a <code>Some</code>, that element is the result of this round of iteration. Returning a <code>None</code>, on the other hand, means that the iterator has finished the whole iteration process. The iterator is permitted to resume iteration after such a <code>None</code> is returned, however. Subsequent calls to <code>next</code> <em>can</em> start returning <code>Some</code> again at some point. it is up to the implementation to decide how the returned value should be obtained. However, the general philosophy of iterators is to apply some sort of &quot;lazy evaluation&quot;, that is, we don&#39;t perform any evaluation unless we have to.</p>

<p>The module also defines some other more specific kinds of iterators on top of this trait. This trait itself also has a bunch of default methods for utility usage. Lots of these methods deal with iterator composition, the module also contains corresponding generic struct definitions for composited iterators (aka. adapters). We will come to these definitions later in this post.</p>

<p>For now let&#39;s just check out how to define a simple iterator:</p>

<pre class='rust rust-example-rendered'>
<span class='kw'>struct</span> <span class='ident'>EvenNums</span> {
    <span class='ident'>i</span>: <span class='ident'>u32</span>,
}

<span class='kw'>impl</span> <span class='ident'>EvenNums</span> {
    <span class='kw'>fn</span> <span class='ident'>new</span>() <span class='op'>-&gt;</span> <span class='ident'>EvenNums</span> {
        <span class='ident'>Counter</span> { <span class='ident'>i</span>: <span class='number'>0</span> }
    }
}

<span class='kw'>impl</span> <span class='ident'>Iterator</span> <span class='kw'>for</span> <span class='ident'>EvenNums</span> {
    <span class='kw'>type</span> <span class='ident'>Item</span> <span class='op'>=</span> <span class='ident'>u32</span>;
    <span class='kw'>fn</span> <span class='ident'>next</span>(<span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='self'>self</span>) <span class='op'>-&gt;</span> <span class='prelude-ty'>Option</span><span class='op'>&lt;</span><span class='ident'>usize</span><span class='op'>&gt;</span> {
        <span class='kw'>let</span> <span class='ident'>ret</span> <span class='op'>=</span> <span class='number'>2</span> <span class='op'>*</span> <span class='self'>self</span>.<span class='ident'>i</span>;
        <span class='self'>self</span>.<span class='ident'>i</span> <span class='op'>+=</span> <span class='number'>1</span>;
        <span class='prelude-val'>Some</span>(<span class='ident'>ret</span>)
    }
}

<span class='kw'>let</span> <span class='kw-2'>mut</span> <span class='ident'>evenNums</span> <span class='op'>=</span> <span class='ident'>EvenNums</span>::<span class='ident'>new</span>();
<span class='macro'>assert_eq</span><span class='macro'>!</span>(<span class='ident'>evenNums</span>.<span class='ident'>next</span>().<span class='ident'>unwrap</span>(), <span class='number'>0</span>);
<span class='macro'>assert_eq</span><span class='macro'>!</span>(<span class='ident'>evenNums</span>.<span class='ident'>next</span>().<span class='ident'>unwrap</span>(), <span class='number'>2</span>);
<span class='macro'>assert_eq</span><span class='macro'>!</span>(<span class='ident'>evenNums</span>.<span class='ident'>next</span>().<span class='ident'>unwrap</span>(), <span class='number'>4</span>);<a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=fn%20main()%20%7B%0Astruct%20EvenNums%20%7B%0A%20%20%20%20i%3A%20u32%2C%0A%7D%0A%0Aimpl%20EvenNums%20%7B%0A%20%20%20%20fn%20new()%20-%3E%20EvenNums%20%7B%0A%20%20%20%20%20%20%20%20Counter%20%7B%20i%3A%200%20%7D%0A%20%20%20%20%7D%0A%7D%0A%0Aimpl%20Iterator%20for%20EvenNums%20%7B%0A%20%20%20%20type%20Item%20%3D%20u32%3B%0A%20%20%20%20fn%20next(%26mut%20self)%20-%3E%20Option%3Cusize%3E%20%7B%0A%20%20%20%20%20%20%20%20let%20ret%20%3D%202%20*%20self.i%3B%0A%20%20%20%20%20%20%20%20self.i%20%2B%3D%201%3B%0A%20%20%20%20%20%20%20%20Some(ret)%0A%20%20%20%20%7D%0A%7D%0A%0Alet%20mut%20evenNums%20%3D%20EvenNums%3A%3Anew()%3B%0Aassert_eq!(evenNums.next().unwrap()%2C%200)%3B%0Aassert_eq!(evenNums.next().unwrap()%2C%202)%3B%0Aassert_eq!(evenNums.next().unwrap()%2C%204)%3B%0A%7D">Run</a></pre>

<h2 id='for-loops-and-intoiterator' class='section-header'><a href='#for-loops-and-intoiterator'>For Loops and IntoIterator</a></h2>
<p>Another core trait is</p>

<pre class='rust rust-example-rendered'>
<span class='kw'>pub</span> <span class='kw'>trait</span> <span class='ident'>IntoIterator</span> {
    <span class='kw'>type</span> <span class='ident'>Item</span>;
    <span class='kw'>type</span> <span class='ident'>IntoIter</span>: <span class='ident'>Iterator</span><span class='op'>&lt;</span><span class='ident'>Item</span><span class='op'>=</span><span class='self'>Self</span>::<span class='ident'>Item</span><span class='op'>&gt;</span>;

    <span class='kw'>fn</span> <span class='ident'>into_iter</span>(<span class='self'>self</span>) <span class='op'>-&gt;</span> <span class='self'>Self</span>::<span class='ident'>IntoIter</span>;
}<a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=fn%20main()%20%7B%0Apub%20trait%20IntoIterator%20%7B%0A%20%20%20%20type%20Item%3B%0A%20%20%20%20type%20IntoIter%3A%20Iterator%3CItem%3DSelf%3A%3AItem%3E%3B%0A%0A%20%20%20%20fn%20into_iter(self)%20-%3E%20Self%3A%3AIntoIter%3B%0A%7D%0A%7D">Run</a></pre>

<p>The trait represents a value type that can be consumed into a iterator. The type of the iterator it converts into is captured by the associated type <code>IntoIter</code>. The type of item the converted iterator iterates over is captured by type <code>Item</code>. The <code>into_iter</code> method consumes the caller and returns the converted <code>IntoIter</code>.</p>

<p>Any struct implementing this trait can be consumed by a <code>for</code> statement. <code>Vec&lt;T&gt;</code> implements this trait, that is the reason why we can write:</p>

<pre class='rust rust-example-rendered'>
<span class='kw'>let</span> <span class='ident'>values</span> <span class='op'>=</span> <span class='macro'>vec</span><span class='macro'>!</span>[<span class='number'>1</span>, <span class='number'>2</span>, <span class='number'>3</span>];

<span class='kw'>for</span> <span class='ident'>x</span> <span class='kw'>in</span> <span class='ident'>values</span> {
    <span class='macro'>println</span><span class='macro'>!</span>(<span class='string'>&quot;{}&quot;</span>, <span class='ident'>x</span>);
}<a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=fn%20main()%20%7B%0Alet%20values%20%3D%20vec!%5B1%2C%202%2C%203%5D%3B%0A%0Afor%20x%20in%20values%20%7B%0A%20%20%20%20println!(%22%7B%7D%22%2C%20x)%3B%0A%7D%0A%7D">Run</a></pre>

<p>The <code>for</code> statement will be desugared to something equivalent as</p>

<pre class='rust rust-example-rendered'>

<span class='kw'>let</span> <span class='ident'>iter</span> <span class='op'>=</span> <span class='ident'>values</span>.<span class='ident'>into_iter</span>();
<span class='kw'>while</span> <span class='kw'>let</span> <span class='prelude-val'>Some</span>(<span class='ident'>x</span>) <span class='op'>=</span> <span class='ident'>iter</span>.<span class='ident'>next</span>() {
    <span class='macro'>println</span><span class='macro'>!</span>(<span class='string'>&quot;{}&quot;</span>, <span class='ident'>x</span>);
}<a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=fn%20main()%20%7B%0Alet%20values%20%3D%20vec!%5B1%2C%202%2C%203%5D%3B%0A%0Alet%20iter%20%3D%20values.into_iter()%3B%0Awhile%20let%20Some(x)%20%3D%20iter.next()%20%7B%0A%20%20%20%20println!(%22%7B%7D%22%2C%20x)%3B%0A%7D%0A%7D">Run</a></pre>

<h1 id='iterator' class='section-header'><a href='#iterator'>Iterator</a></h1>
<p>Now let&#39;s dig deeper into the provided methods of <code>Iterator</code>.</p>

<hr>

<pre class='rust rust-example-rendered'>
<span class='kw'>pub</span> <span class='kw'>trait</span> <span class='ident'>Iterator</span> {
    <span class='attribute'>#[<span class='ident'>inline</span>]</span>
    <span class='kw'>fn</span> <span class='ident'>size_hint</span>(<span class='kw-2'>&amp;</span><span class='self'>self</span>) <span class='op'>-&gt;</span> (<span class='ident'>usize</span>, <span class='prelude-ty'>Option</span><span class='op'>&lt;</span><span class='ident'>usize</span><span class='op'>&gt;</span>) { (<span class='number'>0</span>, <span class='prelude-val'>None</span>) }
}<a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=fn%20main()%20%7B%0Apub%20trait%20Iterator%20%7B%0A%20%20%20%20%23%5Binline%5D%0A%20%20%20%20fn%20size_hint(%26self)%20-%3E%20(usize%2C%20Option%3Cusize%3E)%20%7B%20(0%2C%20None)%20%7D%0A%7D%0A%7D">Run</a></pre>

<p>This method returns the bounds on the remaining items&#39; size. The first element is the lower bound, the second is the upper bound, with <code>None</code> meaning either the bound is unknown or beyond the range of <code>usize</code>. The default implementation simply returns <code>(0, None)</code>, which is of course valid but of not much use. Explicit implementation can choose to return a more correct estimation.</p>

<p>The result acquired from this method, as its name suggests, should be used as a hint for optimizations such as reserving space ahead. It must not be trusted though.</p>

<hr>

<pre class='rust rust-example-rendered'>
<span class='kw'>pub</span> <span class='kw'>trait</span> <span class='ident'>Iterator</span> {
    <span class='attribute'>#[<span class='ident'>inline</span>]</span>
    <span class='kw'>fn</span> <span class='ident'>count</span>(<span class='self'>self</span>) <span class='op'>-&gt;</span> <span class='ident'>usize</span> <span class='kw'>where</span> <span class='self'>Self</span>: <span class='ident'>Sized</span> {
        <span class='self'>self</span>.<span class='ident'>fold</span>(<span class='number'>0</span>, <span class='op'>|</span><span class='ident'>count</span>, _<span class='op'>|</span> <span class='ident'>count</span> <span class='op'>+</span> <span class='number'>1</span>)
    }
}<a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=fn%20main()%20%7B%0Apub%20trait%20Iterator%20%7B%0A%20%20%20%20%23%5Binline%5D%0A%20%20%20%20fn%20count(self)%20-%3E%20usize%20where%20Self%3A%20Sized%20%7B%0A%20%20%20%20%20%20%20%20self.fold(0%2C%20%7Ccount%2C%20_%7C%20count%20%2B%201)%0A%20%20%20%20%7D%0A%7D%0A%7D">Run</a></pre>

<p>This method consumes the iterator and tries to count the number of iterations it provides. Internally, it makes use of another trait method <code>fold</code>, which is more general.</p>

<hr>

<pre class='rust rust-example-rendered'>
<span class='kw'>pub</span> <span class='kw'>trait</span> <span class='ident'>Iterator</span> {
    <span class='kw'>fn</span> <span class='ident'>fold</span><span class='op'>&lt;</span><span class='ident'>B</span>, <span class='ident'>F</span><span class='op'>&gt;</span>(<span class='self'>self</span>, <span class='ident'>init</span>: <span class='ident'>B</span>, <span class='kw-2'>mut</span> <span class='ident'>f</span>: <span class='ident'>F</span>) <span class='op'>-&gt;</span> <span class='ident'>B</span>
        <span class='kw'>where</span> <span class='self'>Self</span>: <span class='ident'>Sized</span>,
              <span class='ident'>F</span>: <span class='ident'>FnMut</span>(<span class='ident'>B</span>, <span class='self'>Self</span>::<span class='ident'>Item</span>) <span class='op'>-&gt;</span> <span class='ident'>B</span>, {
        <span class='kw'>let</span> <span class='kw-2'>mut</span> <span class='ident'>accum</span> <span class='op'>=</span> <span class='ident'>init</span>;
        <span class='kw'>for</span> <span class='ident'>x</span> <span class='kw'>in</span> <span class='self'>self</span> { <span class='comment'>// This is valid because `IntoIterator` is implemented for `T: Iterator`,</span>
                        <span class='comment'>// with its `into_iter` simply returning `self`</span>
            <span class='ident'>accum</span> <span class='op'>=</span> <span class='ident'>f</span>(<span class='ident'>accum</span>, <span class='ident'>x</span>);
        }
        <span class='ident'>accum</span>
    }
}<a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=fn%20main()%20%7B%0Apub%20trait%20Iterator%20%7B%0A%20%20%20%20fn%20fold%3CB%2C%20F%3E(self%2C%20init%3A%20B%2C%20mut%20f%3A%20F)%20-%3E%20B%0A%20%20%20%20%20%20%20%20where%20Self%3A%20Sized%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20F%3A%20FnMut(B%2C%20Self%3A%3AItem)%20-%3E%20B%2C%20%7B%0A%20%20%20%20%20%20%20%20let%20mut%20accum%20%3D%20init%3B%0A%20%20%20%20%20%20%20%20for%20x%20in%20self%20%7B%20%2F%2F%20This%20is%20valid%20because%20%60IntoIterator%60%20is%20implemented%20for%20%60T%3A%20Iterator%60%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20with%20its%20%60into_iter%60%20simply%20returning%20%60self%60%0A%20%20%20%20%20%20%20%20%20%20%20%20accum%20%3D%20f(accum%2C%20x)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20accum%0A%20%20%20%20%7D%0A%7D%0A%7D">Run</a></pre>

<p><code>fold</code> consumes the iterator, and takes two additional arguments, an <code>init</code>ial value, and a closure <code>f</code>. The closure should represents an &quot;accumulator&quot;, that is, a function which takes the a value of <code>init</code>ial&#39;s type, and another argument of the iterator&#39;s <code>Item</code> type, returning another value of type of <code>init</code>.</p>

<p>Internally, the method applies the closure over and over again until the iterator has been consumed, then returns the final accumulated result.</p>

<p>A quick demo:</p>

<pre class='rust rust-example-rendered'>
<span class='kw'>let</span> <span class='ident'>values</span> <span class='op'>=</span> <span class='macro'>vec</span><span class='macro'>!</span>[<span class='number'>1</span>, <span class='number'>2</span>, <span class='number'>3</span>];
<span class='kw'>let</span> <span class='ident'>sum</span> <span class='op'>=</span> <span class='ident'>values</span>.<span class='ident'>into_iter</span>().<span class='ident'>fold</span>(<span class='number'>0</span>, <span class='op'>|</span><span class='ident'>sum</span>, <span class='ident'>next</span><span class='op'>|</span> <span class='ident'>sum</span> <span class='op'>+</span> <span class='ident'>next</span>);
<span class='macro'>assert_eq</span><span class='macro'>!</span>(<span class='ident'>sum</span>, <span class='number'>6</span>);<a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=fn%20main()%20%7B%0Alet%20values%20%3D%20vec!%5B1%2C%202%2C%203%5D%3B%0Alet%20sum%20%3D%20values.into_iter().fold(0%2C%20%7Csum%2C%20next%7C%20sum%20%2B%20next)%3B%0Aassert_eq!(sum%2C%206)%3B%0A%7D">Run</a></pre>

<hr>

<pre class='rust rust-example-rendered'>
<span class='kw'>pub</span> <span class='kw'>trait</span> <span class='ident'>Iterator</span> {
    <span class='kw'>fn</span> <span class='ident'>last</span>(<span class='self'>self</span>) <span class='op'>-&gt;</span> <span class='prelude-ty'>Option</span><span class='op'>&lt;</span><span class='self'>Self</span>::<span class='ident'>Item</span><span class='op'>&gt;</span> <span class='kw'>where</span> <span class='self'>Self</span>: <span class='ident'>Sized</span> {
        <span class='kw'>let</span> <span class='kw-2'>mut</span> <span class='ident'>last</span> <span class='op'>=</span> <span class='prelude-val'>None</span>;
        <span class='kw'>for</span> <span class='ident'>x</span> <span class='kw'>in</span> <span class='self'>self</span> { <span class='ident'>last</span> <span class='op'>=</span> <span class='prelude-val'>Some</span>(<span class='ident'>x</span>); }
        <span class='ident'>last</span>
    }
}<a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=fn%20main()%20%7B%0Apub%20trait%20Iterator%20%7B%0A%20%20%20%20fn%20last(self)%20-%3E%20Option%3CSelf%3A%3AItem%3E%20where%20Self%3A%20Sized%20%7B%0A%20%20%20%20%20%20%20%20let%20mut%20last%20%3D%20None%3B%0A%20%20%20%20%20%20%20%20for%20x%20in%20self%20%7B%20last%20%3D%20Some(x)%3B%20%7D%0A%20%20%20%20%20%20%20%20last%0A%20%20%20%20%7D%0A%7D%0A%7D">Run</a></pre>

<p>The method tries to consume the iterator and returns its last element.</p>

<hr>

<pre class='rust rust-example-rendered'>
<span class='kw'>pub</span> <span class='kw'>trait</span> <span class='ident'>Iterator</span> {
    <span class='kw'>fn</span> <span class='ident'>nth</span>(<span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='self'>self</span>, <span class='kw-2'>mut</span> <span class='ident'>n</span>: <span class='ident'>usize</span>) <span class='op'>-&gt;</span> <span class='prelude-ty'>Option</span><span class='op'>&lt;</span><span class='self'>Self</span>::<span class='ident'>Item</span><span class='op'>&gt;</span> {
        <span class='kw'>for</span> <span class='ident'>x</span> <span class='kw'>in</span> <span class='self'>self</span> {
            <span class='kw'>if</span> <span class='ident'>n</span> <span class='op'>==</span> <span class='number'>0</span> { <span class='kw'>return</span> <span class='prelude-val'>Some</span>(<span class='ident'>x</span>) }
            <span class='ident'>n</span> <span class='op'>-=</span> <span class='number'>1</span>;
        }
        <span class='prelude-val'>None</span>
    }
}<a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=fn%20main()%20%7B%0Apub%20trait%20Iterator%20%7B%0A%20%20%20%20fn%20nth(%26mut%20self%2C%20mut%20n%3A%20usize)%20-%3E%20Option%3CSelf%3A%3AItem%3E%20%7B%0A%20%20%20%20%20%20%20%20for%20x%20in%20self%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20n%20%3D%3D%200%20%7B%20return%20Some(x)%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20n%20-%3D%201%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20None%0A%20%20%20%20%7D%0A%7D%0A%7D">Run</a></pre>

<p>The method tries to return the <code>n</code>th element of the iterator.</p>

<p>Note that <code>for</code> loop, which operates on a <code>self: &amp;mut Self</code>. This is valid because the module also contains a generic implementation:</p>

<pre class='rust rust-example-rendered'>
<span class='kw'>impl</span><span class='op'>&lt;</span><span class='lifetime'>&#39;a</span>, <span class='ident'>I</span>: <span class='ident'>Iterator</span> <span class='op'>+</span> <span class='question-mark'>?</span><span class='ident'>Sized</span><span class='op'>&gt;</span> <span class='ident'>Iterator</span> <span class='kw'>for</span> <span class='kw-2'>&amp;</span><span class='lifetime'>&#39;a</span> <span class='kw-2'>mut</span> <span class='ident'>I</span> {
    <span class='kw'>type</span> <span class='ident'>Item</span> <span class='op'>=</span> <span class='ident'>I</span>::<span class='ident'>Item</span>;
    <span class='kw'>fn</span> <span class='ident'>next</span>(<span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='self'>self</span>) <span class='op'>-&gt;</span> <span class='prelude-ty'>Option</span><span class='op'>&lt;</span><span class='ident'>I</span>::<span class='ident'>Item</span><span class='op'>&gt;</span> { (<span class='kw-2'>*</span><span class='kw-2'>*</span><span class='self'>self</span>).<span class='ident'>next</span>() }

    <span class='comment'>// preserves valid size hint</span>
    <span class='kw'>fn</span> <span class='ident'>size_hint</span>(<span class='kw-2'>&amp;</span><span class='self'>self</span>) <span class='op'>-&gt;</span> (<span class='ident'>usize</span>, <span class='prelude-ty'>Option</span><span class='op'>&lt;</span><span class='ident'>usize</span><span class='op'>&gt;</span>) { (<span class='kw-2'>*</span><span class='kw-2'>*</span><span class='self'>self</span>).<span class='ident'>size_hint</span>() }

    <span class='comment'>// preserve redundant round of dereferencing</span>
    <span class='kw'>fn</span> <span class='ident'>nth</span>(<span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='self'>self</span>, <span class='ident'>n</span>: <span class='ident'>usize</span>) <span class='op'>-&gt;</span> <span class='prelude-ty'>Option</span><span class='op'>&lt;</span><span class='self'>Self</span>::<span class='ident'>Item</span><span class='op'>&gt;</span> {
        (<span class='kw-2'>*</span><span class='kw-2'>*</span><span class='self'>self</span>).<span class='ident'>nth</span>(<span class='ident'>n</span>)
    }
}<a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=fn%20main()%20%7B%0Aimpl%3C'a%2C%20I%3A%20Iterator%20%2B%20%3FSized%3E%20Iterator%20for%20%26'a%20mut%20I%20%7B%0A%20%20%20%20type%20Item%20%3D%20I%3A%3AItem%3B%0A%20%20%20%20fn%20next(%26mut%20self)%20-%3E%20Option%3CI%3A%3AItem%3E%20%7B%20(**self).next()%20%7D%0A%0A%20%20%20%20%2F%2F%20preserves%20valid%20size%20hint%0A%20%20%20%20fn%20size_hint(%26self)%20-%3E%20(usize%2C%20Option%3Cusize%3E)%20%7B%20(**self).size_hint()%20%7D%0A%0A%20%20%20%20%2F%2F%20preserve%20redundant%20round%20of%20dereferencing%0A%20%20%20%20fn%20nth(%26mut%20self%2C%20n%3A%20usize)%20-%3E%20Option%3CSelf%3A%3AItem%3E%20%7B%0A%20%20%20%20%20%20%20%20(**self).nth(n)%0A%20%20%20%20%7D%0A%7D%0A%7D">Run</a></pre>

<p>Together with the generic implementation we mentioned above:</p>

<pre class='rust rust-example-rendered'>
<span class='kw'>impl</span><span class='op'>&lt;</span><span class='ident'>I</span><span class='op'>&gt;</span> <span class='ident'>IntoInterator</span> <span class='kw'>for</span> <span class='ident'>I</span> <span class='kw'>where</span> <span class='ident'>I</span>: <span class='ident'>Iterator</span> {
    <span class='kw'>type</span> <span class='ident'>Item</span> <span class='op'>=</span> <span class='ident'>I</span>::<span class='ident'>Item</span>;
    <span class='kw'>type</span> <span class='ident'>IntoIter</span> <span class='op'>=</span> <span class='ident'>I</span>;
    <span class='kw'>fn</span> <span class='ident'>into_iter</span>(<span class='self'>self</span>) <span class='op'>-&gt;</span> <span class='ident'>I</span> { <span class='self'>self</span> }
}<a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=fn%20main()%20%7B%0Aimpl%3CI%3E%20IntoInterator%20for%20I%20where%20I%3A%20Iterator%20%7B%0A%20%20%20%20type%20Item%20%3D%20I%3A%3AItem%3B%0A%20%20%20%20type%20IntoIter%20%3D%20I%3B%0A%20%20%20%20fn%20into_iter(self)%20-%3E%20I%20%7B%20self%20%7D%0A%7D%0A%7D">Run</a></pre>

<p>The <code>for</code> loop here is just identical as a call of <code>for</code> on <code>self: Self</code>.</p>

<hr>

<pre class='rust rust-example-rendered'>
<span class='kw'>pub</span> <span class='kw'>trait</span> <span class='ident'>Iterator</span> {
    <span class='attribute'>#[<span class='ident'>inline</span>]</span>
    <span class='kw'>fn</span> <span class='ident'>chain</span><span class='op'>&lt;</span><span class='ident'>U</span><span class='op'>&gt;</span>(<span class='self'>self</span>, <span class='ident'>other</span>: <span class='ident'>U</span>) <span class='op'>-&gt;</span> <span class='ident'>Chain</span><span class='op'>&lt;</span><span class='self'>Self</span>, <span class='ident'>U</span>::<span class='ident'>IntoIter</span><span class='op'>&gt;</span>
        <span class='kw'>where</span> <span class='self'>Self</span>: <span class='ident'>Sized</span>, <span class='ident'>U</span>: <span class='ident'>IntoIterator</span><span class='op'>&lt;</span><span class='ident'>Item</span><span class='op'>=</span><span class='self'>Self</span>::<span class='ident'>Item</span><span class='op'>&gt;</span> {
        <span class='ident'>Chain</span>{ <span class='ident'>a</span>: <span class='self'>self</span>, <span class='ident'>b</span>: <span class='ident'>other</span>.<span class='ident'>into_iter</span>(), <span class='ident'>state</span>: <span class='ident'>ChainState</span>::<span class='ident'>Both</span> }
    }
}<a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=fn%20main()%20%7B%0Apub%20trait%20Iterator%20%7B%0A%20%20%20%20%23%5Binline%5D%0A%20%20%20%20fn%20chain%3CU%3E(self%2C%20other%3A%20U)%20-%3E%20Chain%3CSelf%2C%20U%3A%3AIntoIter%3E%0A%20%20%20%20%20%20%20%20where%20Self%3A%20Sized%2C%20U%3A%20IntoIterator%3CItem%3DSelf%3A%3AItem%3E%20%7B%0A%20%20%20%20%20%20%20%20Chain%7B%20a%3A%20self%2C%20b%3A%20other.into_iter()%2C%20state%3A%20ChainState%3A%3ABoth%20%7D%0A%20%20%20%20%7D%0A%7D%0A%7D">Run</a></pre>

<p>This method consumes the iterator, and chains it with another iterator-can-be.</p>

<p>The returned <code>Chain</code> is one of the iterator adaptor defined by the module:</p>

<pre class='rust rust-example-rendered'>
<span class='kw'>pub</span> <span class='kw'>struct</span> <span class='ident'>Chain</span><span class='op'>&lt;</span><span class='ident'>A</span>, <span class='ident'>B</span><span class='op'>&gt;</span> {
    <span class='ident'>a</span>: <span class='ident'>A</span>,
    <span class='ident'>b</span>: <span class='ident'>B</span>,
    <span class='ident'>state</span>: <span class='ident'>ChainState</span>,
}

<span class='kw'>enum</span> <span class='ident'>ChainState</span> {
    <span class='ident'>Both</span>, <span class='comment'>// both iterator are remaining</span>
    <span class='ident'>Front</span>, <span class='comment'>// only the first iterator remains</span>
    <span class='ident'>Back</span>, <span class='comment'>// only the later iterator remains</span>
}

<span class='kw'>impl</span><span class='op'>&lt;</span><span class='ident'>A</span>, <span class='ident'>B</span><span class='op'>&gt;</span> <span class='ident'>Iterator</span> <span class='kw'>for</span> <span class='ident'>Chain</span><span class='op'>&lt;</span><span class='ident'>A</span>, <span class='ident'>B</span><span class='op'>&gt;</span>
    <span class='kw'>where</span> <span class='ident'>A</span>: <span class='ident'>Iterator</span>,
          <span class='ident'>B</span>: <span class='ident'>Iterator</span><span class='op'>&lt;</span><span class='ident'>Item</span><span class='op'>=</span><span class='ident'>A</span>::<span class='ident'>Item</span><span class='op'>&gt;</span> {
    <span class='kw'>type</span> <span class='ident'>Item</span> <span class='op'>=</span> <span class='ident'>A</span>::<span class='ident'>Item</span>;

    <span class='attribute'>#[<span class='ident'>inline</span>]</span>
    <span class='kw'>fn</span> <span class='ident'>next</span>(<span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='self'>self</span>) <span class='op'>-&gt;</span> <span class='prelude-ty'>Option</span><span class='op'>&lt;</span><span class='ident'>A</span>::<span class='ident'>Item</span><span class='op'>&gt;</span> {
        <span class='kw'>match</span> <span class='self'>self</span>.<span class='ident'>state</span> {
            <span class='ident'>ChainState</span>::<span class='ident'>Both</span> <span class='op'>=&gt;</span> <span class='kw'>match</span> <span class='self'>self</span>.<span class='ident'>a</span>.<span class='ident'>next</span>() {
                <span class='prelude-val'>Some</span>(<span class='ident'>item</span>) <span class='op'>=&gt;</span> <span class='prelude-val'>Some</span>(<span class='ident'>item</span>),
                <span class='prelude-val'>None</span> <span class='op'>=&gt;</span> {
                    <span class='self'>self</span>.<span class='ident'>state</span> <span class='op'>=</span> <span class='ident'>ChainState</span>::<span class='ident'>Back</span>;
                    <span class='self'>self</span>.<span class='ident'>b</span>.<span class='ident'>next</span>()
                }
            },
            <span class='ident'>ChainState</span>::<span class='ident'>Front</span> <span class='op'>=&gt;</span> <span class='self'>self</span>.<span class='ident'>a</span>.<span class='ident'>next</span>(),
            <span class='ident'>ChainState</span>::<span class='ident'>Back</span> <span class='op'>=&gt;</span> <span class='self'>self</span>.<span class='ident'>b</span>.<span class='ident'>next</span>(),
        }
    }
}

<span class='comment'>// ...</span><a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=fn%20main()%20%7B%0Apub%20struct%20Chain%3CA%2C%20B%3E%20%7B%0A%20%20%20%20a%3A%20A%2C%0A%20%20%20%20b%3A%20B%2C%0A%20%20%20%20state%3A%20ChainState%2C%0A%7D%0A%0Aenum%20ChainState%20%7B%0A%20%20%20%20Both%2C%20%2F%2F%20both%20iterator%20are%20remaining%0A%20%20%20%20Front%2C%20%2F%2F%20only%20the%20first%20iterator%20remains%0A%20%20%20%20Back%2C%20%2F%2F%20only%20the%20later%20iterator%20remains%0A%7D%0A%0Aimpl%3CA%2C%20B%3E%20Iterator%20for%20Chain%3CA%2C%20B%3E%0A%20%20%20%20where%20A%3A%20Iterator%2C%0A%20%20%20%20%20%20%20%20%20%20B%3A%20Iterator%3CItem%3DA%3A%3AItem%3E%20%7B%0A%20%20%20%20type%20Item%20%3D%20A%3A%3AItem%3B%0A%0A%20%20%20%20%23%5Binline%5D%0A%20%20%20%20fn%20next(%26mut%20self)%20-%3E%20Option%3CA%3A%3AItem%3E%20%7B%0A%20%20%20%20%20%20%20%20match%20self.state%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20ChainState%3A%3ABoth%20%3D%3E%20match%20self.a.next()%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20Some(item)%20%3D%3E%20Some(item)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20None%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.state%20%3D%20ChainState%3A%3ABack%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.b.next()%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20ChainState%3A%3AFront%20%3D%3E%20self.a.next()%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20ChainState%3A%3ABack%20%3D%3E%20self.b.next()%2C%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%7D%0A%0A%2F%2F%20...%0A%7D">Run</a></pre>

<p>From the implementation it&#39;s not hard to infer how this &quot;chain&quot; works.</p>

<p>Also notice that the sturcture also implements <code>DoubleEndedIterator</code> if its subcomponents implement it. The same goes for <code>Clone</code> and <code>Debug</code>.</p>

<hr>

<pre class='rust rust-example-rendered'>
<span class='kw'>pub</span> <span class='kw'>trait</span> <span class='ident'>Iterator</span> {
    <span class='kw'>fn</span> <span class='ident'>zip</span><span class='op'>&lt;</span><span class='ident'>U</span><span class='op'>&gt;</span>(<span class='self'>self</span>, <span class='ident'>other</span>: <span class='ident'>U</span>) <span class='op'>-&gt;</span> <span class='ident'>Zip</span><span class='op'>&lt;</span><span class='self'>Self</span>, <span class='ident'>U</span>::<span class='ident'>IntoIter</span><span class='op'>&gt;</span>
        <span class='kw'>where</span> <span class='self'>Self</span>: <span class='ident'>Sized</span>, <span class='ident'>U</span>: <span class='ident'>IntoIterator</span> {
        <span class='ident'>Zip</span>::<span class='ident'>new</span>(<span class='self'>self</span>, <span class='ident'>other</span>.<span class='ident'>into_iter</span>())
    }
}<a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=fn%20main()%20%7B%0Apub%20trait%20Iterator%20%7B%0A%20%20%20%20fn%20zip%3CU%3E(self%2C%20other%3A%20U)%20-%3E%20Zip%3CSelf%2C%20U%3A%3AIntoIter%3E%0A%20%20%20%20%20%20%20%20where%20Self%3A%20Sized%2C%20U%3A%20IntoIterator%20%7B%0A%20%20%20%20%20%20%20%20Zip%3A%3Anew(self%2C%20other.into_iter())%0A%20%20%20%20%7D%0A%7D%0A%7D">Run</a></pre>

<p>This method consumes the calling iterator and &quot;zips&quot; it up with another.</p>

<p>The returned <code>Zip</code> type is defined as follows:</p>

<pre class='rust rust-example-rendered'>
<span class='kw'>pub</span> <span class='kw'>struct</span> <span class='ident'>Zip</span><span class='op'>&lt;</span><span class='ident'>A</span>, <span class='ident'>B</span><span class='op'>&gt;</span> {
    <span class='ident'>a</span>: <span class='ident'>A</span>,
    <span class='ident'>b</span>: <span class='ident'>B</span>,
    <span class='ident'>index</span>: <span class='ident'>usize</span>,
    <span class='ident'>len</span>: <span class='ident'>usize</span>,
}

<span class='kw'>impl</span><span class='op'>&lt;</span><span class='ident'>A</span>, <span class='ident'>B</span><span class='op'>&gt;</span> <span class='ident'>Iterator</span> <span class='kw'>for</span> <span class='ident'>Zip</span><span class='op'>&lt;</span><span class='ident'>A</span>, <span class='ident'>B</span><span class='op'>&gt;</span>
    <span class='kw'>where</span> <span class='ident'>A</span>: <span class='ident'>Iterator</span>, <span class='ident'>B</span>: <span class='ident'>Iterator</span> {
    <span class='kw'>type</span> <span class='ident'>Item</span> <span class='op'>=</span> (<span class='ident'>A</span>::<span class='ident'>Item</span>, <span class='ident'>B</span>::<span class='ident'>Item</span>);

    <span class='attribute'>#[<span class='ident'>inline</span>]</span>
    <span class='kw'>fn</span> <span class='ident'>next</span>(<span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='self'>self</span>) <span class='op'>-&gt;</span> <span class='prelude-ty'>Option</span><span class='op'>&lt;</span><span class='self'>Self</span>::<span class='ident'>Item</span><span class='op'>&gt;</span> {
        <span class='ident'>ZupImpl</span>::<span class='ident'>next</span>(<span class='self'>self</span>)
    }

    <span class='attribute'>#[<span class='ident'>inline</span>]</span>
    <span class='kw'>fn</span> <span class='ident'>size_hint</span>(<span class='kw-2'>&amp;</span><span class='self'>self</span>) <span class='op'>-&gt;</span> (<span class='ident'>usize</span>, <span class='prelude-ty'>Option</span><span class='op'>&lt;</span><span class='ident'>usize</span><span class='op'>&gt;</span>) {
        <span class='ident'>ZipImpl</span>::<span class='ident'>size_hint</span>(<span class='self'>self</span>)
    }
}

<span class='kw'>impl</span><span class='op'>&lt;</span><span class='ident'>A</span>, <span class='ident'>B</span><span class='op'>&gt;</span> <span class='ident'>DoubleEndedIterator</span> <span class='kw'>for</span> <span class='ident'>Zip</span><span class='op'>&lt;</span><span class='ident'>A</span>, <span class='ident'>B</span><span class='op'>&gt;</span> <span class='kw'>where</span>
    <span class='ident'>A</span>: <span class='ident'>DoubleEndedIterator</span> <span class='op'>+</span> <span class='ident'>ExactSizeIterator</span>,
    <span class='ident'>B</span>: <span class='ident'>DoubleEndedIterator</span> <span class='op'>+</span> <span class='ident'>ExactSizeIterator</span>,
{
    <span class='attribute'>#[<span class='ident'>inline</span>]</span>
    <span class='kw'>fn</span> <span class='ident'>next_back</span>(<span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='self'>self</span>) <span class='op'>-&gt;</span> <span class='prelude-ty'>Option</span><span class='op'>&lt;</span>(<span class='ident'>A</span>::<span class='ident'>Item</span>, <span class='ident'>B</span>::<span class='ident'>Item</span>)<span class='op'>&gt;</span> {
        <span class='ident'>ZipImpl</span>::<span class='ident'>next_back</span>(<span class='self'>self</span>)
    }
}<a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=fn%20main()%20%7B%0Apub%20struct%20Zip%3CA%2C%20B%3E%20%7B%0A%20%20%20%20a%3A%20A%2C%0A%20%20%20%20b%3A%20B%2C%0A%20%20%20%20index%3A%20usize%2C%0A%20%20%20%20len%3A%20usize%2C%0A%7D%0A%0Aimpl%3CA%2C%20B%3E%20Iterator%20for%20Zip%3CA%2C%20B%3E%0A%20%20%20%20where%20A%3A%20Iterator%2C%20B%3A%20Iterator%20%7B%0A%20%20%20%20type%20Item%20%3D%20(A%3A%3AItem%2C%20B%3A%3AItem)%3B%0A%0A%20%20%20%20%23%5Binline%5D%0A%20%20%20%20fn%20next(%26mut%20self)%20-%3E%20Option%3CSelf%3A%3AItem%3E%20%7B%0A%20%20%20%20%20%20%20%20ZupImpl%3A%3Anext(self)%0A%20%20%20%20%7D%0A%0A%20%20%20%20%23%5Binline%5D%0A%20%20%20%20fn%20size_hint(%26self)%20-%3E%20(usize%2C%20Option%3Cusize%3E)%20%7B%0A%20%20%20%20%20%20%20%20ZipImpl%3A%3Asize_hint(self)%0A%20%20%20%20%7D%0A%7D%0A%0Aimpl%3CA%2C%20B%3E%20DoubleEndedIterator%20for%20Zip%3CA%2C%20B%3E%20where%0A%20%20%20%20A%3A%20DoubleEndedIterator%20%2B%20ExactSizeIterator%2C%0A%20%20%20%20B%3A%20DoubleEndedIterator%20%2B%20ExactSizeIterator%2C%0A%7B%0A%20%20%20%20%23%5Binline%5D%0A%20%20%20%20fn%20next_back(%26mut%20self)%20-%3E%20Option%3C(A%3A%3AItem%2C%20B%3A%3AItem)%3E%20%7B%0A%20%20%20%20%20%20%20%20ZipImpl%3A%3Anext_back(self)%0A%20%20%20%20%7D%0A%7D%0A%7D">Run</a></pre>

<p>Note that the actual implementation is forwarded into another trait, <code>ZipImpl</code>. The trait makes use of a currently unstable feature, <a href="https://github.com/rust-lang/rfcs/blob/master/text/1210-impl-specialization.html">impl-specialization</a>, to improve the performance of <code>Zip</code> on certain types. We omit that implementation here, interested readers can look into it in the source code, or find more info at the <a href="https://github.com/rust-lang/rust/pull/33090">related PR</a>.</p>

<hr>

<pre class='rust rust-example-rendered'>
<span class='kw'>pub</span> <span class='kw'>trait</span> <span class='ident'>Iterator</span> {
    <span class='kw'>fn</span> <span class='ident'>map</span><span class='op'>&lt;</span><span class='ident'>B</span>, <span class='ident'>F</span><span class='op'>&gt;</span>(<span class='self'>self</span>, <span class='ident'>f</span>: <span class='ident'>F</span>) <span class='op'>-&gt;</span> <span class='ident'>Map</span><span class='op'>&lt;</span><span class='self'>Self</span>, <span class='ident'>F</span><span class='op'>&gt;</span>
        <span class='kw'>where</span> <span class='self'>Self</span>: <span class='ident'>Sized</span>, <span class='ident'>F</span>: <span class='ident'>FnMut</span>(<span class='self'>Self</span>::<span class='ident'>Item</span>) <span class='op'>-&gt;</span> <span class='ident'>B</span> {
        <span class='ident'>Map</span> { <span class='ident'>iter</span>: <span class='self'>self</span>, <span class='ident'>f</span>: <span class='ident'>F</span> }
    }
}<a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=fn%20main()%20%7B%0Apub%20trait%20Iterator%20%7B%0A%20%20%20%20fn%20map%3CB%2C%20F%3E(self%2C%20f%3A%20F)%20-%3E%20Map%3CSelf%2C%20F%3E%0A%20%20%20%20%20%20%20%20where%20Self%3A%20Sized%2C%20F%3A%20FnMut(Self%3A%3AItem)%20-%3E%20B%20%7B%0A%20%20%20%20%20%20%20%20Map%20%7B%20iter%3A%20self%2C%20f%3A%20F%20%7D%0A%20%20%20%20%7D%0A%7D%0A%7D">Run</a></pre>

<p>This method consumes the iterator, then creates a new iterator calling the closure on each of the original iterator&#39;s elements.</p>

<p>The returned <code>Map</code> is defined as follows:</p>

<pre class='rust rust-example-rendered'>
<span class='kw'>pub</span> <span class='kw'>struct</span> <span class='ident'>Map</span><span class='op'>&lt;</span><span class='ident'>I</span>, <span class='ident'>F</span><span class='op'>&gt;</span> {
    <span class='ident'>iter</span>: <span class='ident'>I</span>,
    <span class='ident'>f</span>: <span class='ident'>F</span>,
}

<span class='kw'>impl</span><span class='op'>&lt;</span><span class='ident'>B</span>, <span class='ident'>I</span>: <span class='ident'>Iterator</span>, <span class='ident'>F</span><span class='op'>&gt;</span> <span class='ident'>Iterator</span> <span class='kw'>for</span> <span class='ident'>Map</span><span class='op'>&lt;</span><span class='ident'>I</span>, <span class='ident'>F</span><span class='op'>&gt;</span>
    <span class='kw'>where</span> <span class='ident'>F</span>: <span class='ident'>FnMut</span>(<span class='ident'>I</span>::<span class='ident'>Item</span>) <span class='op'>-&gt;</span> <span class='ident'>B</span>
{
    <span class='kw'>type</span> <span class='ident'>Item</span> <span class='op'>=</span> <span class='ident'>B</span>;

    <span class='attribute'>#[<span class='ident'>inline</span>]</span>
    <span class='kw'>fn</span> <span class='ident'>next</span>(<span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='self'>self</span>) <span class='op'>-&gt;</span> <span class='prelude-ty'>Option</span><span class='op'>&lt;</span><span class='ident'>B</span><span class='op'>&gt;</span> {
        <span class='self'>self</span>.<span class='ident'>iter</span>.<span class='ident'>next</span>().<span class='ident'>map</span>(<span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='self'>self</span>.<span class='ident'>f</span>)
    }

    <span class='attribute'>#[<span class='ident'>inline</span>]</span>
    <span class='kw'>fn</span> <span class='ident'>size_hint</span>(<span class='kw-2'>&amp;</span><span class='self'>self</span>) <span class='op'>-&gt;</span> (<span class='ident'>usize</span>, <span class='prelude-ty'>Option</span>(<span class='ident'>usize</span>)) {
        <span class='self'>self</span>.<span class='ident'>iter</span>.<span class='ident'>size_hint</span>()
    }

    <span class='attribute'>#[<span class='ident'>inline</span>]</span>
    <span class='kw'>fn</span> <span class='ident'>fold</span><span class='op'>&lt;</span><span class='ident'>Acc</span>, <span class='ident'>G</span><span class='op'>&gt;</span>(<span class='self'>self</span>, <span class='ident'>init</span>: <span class='ident'>Acc</span>, <span class='kw-2'>mut</span> <span class='ident'>g</span>: <span class='ident'>G</span>) <span class='op'>-&gt;</span> <span class='ident'>Acc</span>
        <span class='kw'>where</span> <span class='ident'>G</span>: <span class='ident'>FnMut</span>(<span class='ident'>Acc</span>, <span class='self'>Self</span>::<span class='ident'>Item</span>) <span class='op'>-&gt;</span> <span class='ident'>Acc</span>
    {
        <span class='kw'>let</span> <span class='ident'>muf</span> <span class='ident'>f</span> <span class='op'>=</span> <span class='self'>self</span>.<span class='ident'>f</span>;
        <span class='self'>self</span>.<span class='ident'>iter</span>.<span class='ident'>fold</span>(<span class='ident'>init</span>, <span class='kw'>move</span> <span class='op'>|</span><span class='ident'>acc</span>, <span class='ident'>elt</span><span class='op'>|</span> <span class='ident'>g</span>(<span class='ident'>acc</span>, <span class='ident'>f</span>(<span class='ident'>elt</span>))) <span class='comment'>// move `g` inside the closure</span>
    }
}<a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=fn%20main()%20%7B%0Apub%20struct%20Map%3CI%2C%20F%3E%20%7B%0A%20%20%20%20iter%3A%20I%2C%0A%20%20%20%20f%3A%20F%2C%0A%7D%0A%0Aimpl%3CB%2C%20I%3A%20Iterator%2C%20F%3E%20Iterator%20for%20Map%3CI%2C%20F%3E%0A%20%20%20%20where%20F%3A%20FnMut(I%3A%3AItem)%20-%3E%20B%0A%7B%0A%20%20%20%20type%20Item%20%3D%20B%3B%0A%0A%20%20%20%20%23%5Binline%5D%0A%20%20%20%20fn%20next(%26mut%20self)%20-%3E%20Option%3CB%3E%20%7B%0A%20%20%20%20%20%20%20%20self.iter.next().map(%26mut%20self.f)%0A%20%20%20%20%7D%0A%0A%20%20%20%20%23%5Binline%5D%0A%20%20%20%20fn%20size_hint(%26self)%20-%3E%20(usize%2C%20Option(usize))%20%7B%0A%20%20%20%20%20%20%20%20self.iter.size_hint()%0A%20%20%20%20%7D%0A%0A%20%20%20%20%23%5Binline%5D%0A%20%20%20%20fn%20fold%3CAcc%2C%20G%3E(self%2C%20init%3A%20Acc%2C%20mut%20g%3A%20G)%20-%3E%20Acc%0A%20%20%20%20%20%20%20%20where%20G%3A%20FnMut(Acc%2C%20Self%3A%3AItem)%20-%3E%20Acc%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20let%20muf%20f%20%3D%20self.f%3B%0A%20%20%20%20%20%20%20%20self.iter.fold(init%2C%20move%20%7Cacc%2C%20elt%7C%20g(acc%2C%20f(elt)))%20%2F%2F%20move%20%60g%60%20inside%20the%20closure%0A%20%20%20%20%7D%0A%7D%0A%7D">Run</a></pre>

<p>Note that for <code>I: DoubleEndedIterator</code> or <code>ExactSizeIterator</code> or <code>FusedIterator</code>, and some other utility traits like <code>Debug</code>, <code>Clone</code>, etc.. ; <code>Map</code> and <code>Zip</code> would also have these corresponding traits implemented. The same goes for a lot of other adapters. These details would be omitted in this intro.</p>

<hr>

<pre class='rust rust-example-rendered'>
<span class='kw'>pub</span> <span class='kw'>trait</span> <span class='ident'>Iterator</span> {
    <span class='kw'>fn</span> <span class='ident'>filter</span><span class='op'>&lt;</span><span class='ident'>P</span><span class='op'>&gt;</span>(<span class='self'>self</span>, <span class='ident'>predicate</span>: <span class='ident'>P</span>) <span class='op'>-&gt;</span> <span class='ident'>Filter</span><span class='op'>&lt;</span><span class='self'>Self</span>, <span class='ident'>P</span><span class='op'>&gt;</span>
        <span class='kw'>where</span> <span class='self'>Self</span>: <span class='ident'>Sized</span>, <span class='ident'>P</span>: <span class='ident'>FnMut</span>(<span class='kw-2'>&amp;</span><span class='self'>Self</span>::<span class='ident'>Item</span>) <span class='op'>-&gt;</span> <span class='ident'>bool</span>
    {
        <span class='ident'>Filter</span> { <span class='ident'>iter</span>: <span class='self'>self</span>, <span class='ident'>predicate</span>: <span class='ident'>predicate</span> }
    }
}<a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=fn%20main()%20%7B%0Apub%20trait%20Iterator%20%7B%0A%20%20%20%20fn%20filter%3CP%3E(self%2C%20predicate%3A%20P)%20-%3E%20Filter%3CSelf%2C%20P%3E%0A%20%20%20%20%20%20%20%20where%20Self%3A%20Sized%2C%20P%3A%20FnMut(%26Self%3A%3AItem)%20-%3E%20bool%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20Filter%20%7B%20iter%3A%20self%2C%20predicate%3A%20predicate%20%7D%0A%20%20%20%20%7D%0A%7D%0A%7D">Run</a></pre>

<p>The returned <code>Filter</code> consumes the original iterator, and would yield the original iterator&#39;s items iff. the predicate <code>P</code> is true for that item.</p>

<p>The definition of the returned <code>Filter</code>:</p>

<pre class='rust rust-example-rendered'>
<span class='kw'>pub</span> <span class='kw'>struct</span> <span class='ident'>Filter</span><span class='op'>&lt;</span><span class='ident'>I</span>, <span class='ident'>P</span><span class='op'>&gt;</span> {
    <span class='ident'>iter</span>: <span class='ident'>I</span>,
    <span class='ident'>predicate</span>: <span class='ident'>P</span>,
}

<span class='kw'>impl</span><span class='op'>&lt;</span><span class='ident'>I</span>: <span class='ident'>Iterator</span>, <span class='ident'>P</span><span class='op'>&gt;</span> <span class='ident'>Iterator</span> <span class='kw'>for</span> <span class='ident'>Filter</span><span class='op'>&lt;</span><span class='ident'>I</span>, <span class='ident'>P</span><span class='op'>&gt;</span>
    <span class='kw'>where</span> <span class='ident'>P</span>: <span class='ident'>FnMut</span>(<span class='kw-2'>&amp;</span><span class='ident'>I</span>::<span class='ident'>Item</span>) <span class='op'>-&gt;</span> <span class='ident'>bool</span> 
{
    <span class='kw'>type</span> <span class='ident'>Item</span> <span class='op'>=</span> <span class='ident'>I</span>::<span class='ident'>Item</span>;

    <span class='attribute'>#[<span class='ident'>inline</span>]</span>
    <span class='kw'>fn</span> <span class='ident'>next</span>(<span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='self'>self</span>) <span class='op'>-&gt;</span> <span class='prelude-ty'>Option</span><span class='op'>&lt;</span><span class='ident'>I</span>::<span class='ident'>Item</span><span class='op'>&gt;</span> {
        <span class='kw'>for</span> <span class='ident'>x</span> <span class='kw'>in</span> <span class='self'>self</span>.<span class='ident'>iter</span>.<span class='ident'>by_ref</span>() {
            <span class='kw'>if</span> (<span class='self'>self</span>.<span class='ident'>predicate</span>)(<span class='kw-2'>&amp;</span><span class='ident'>x</span>) {
                <span class='kw'>return</span> <span class='prelude-val'>Some</span>(<span class='ident'>x</span>);
            }
        }
        <span class='prelude-val'>None</span>
    }

    <span class='attribute'>#[<span class='ident'>inline</span>]</span>
    <span class='kw'>fn</span> <span class='ident'>size_hint</span>(<span class='kw-2'>&amp;</span><span class='self'>self</span>) <span class='op'>-&gt;</span> (<span class='ident'>usize</span>, <span class='prelude-ty'>Option</span><span class='op'>&lt;</span><span class='ident'>usize</span><span class='op'>&gt;</span>) {
        <span class='kw'>let</span> (_, <span class='ident'>upper</span>) <span class='op'>=</span> <span class='self'>self</span>.<span class='ident'>iter</span>.<span class='ident'>size_hint</span>();
        (<span class='number'>0</span>, <span class='ident'>upper</span>) <span class='comment'>// because of the predicate, the original lower bound can&#39;t be trusted</span>
    }
}
<a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=fn%20main()%20%7B%0Apub%20struct%20Filter%3CI%2C%20P%3E%20%7B%0A%20%20%20%20iter%3A%20I%2C%0A%20%20%20%20predicate%3A%20P%2C%0A%7D%0A%0Aimpl%3CI%3A%20Iterator%2C%20P%3E%20Iterator%20for%20Filter%3CI%2C%20P%3E%0A%20%20%20%20where%20P%3A%20FnMut(%26I%3A%3AItem)%20-%3E%20bool%20%0A%7B%0A%20%20%20%20type%20Item%20%3D%20I%3A%3AItem%3B%0A%0A%20%20%20%20%23%5Binline%5D%0A%20%20%20%20fn%20next(%26mut%20self)%20-%3E%20Option%3CI%3A%3AItem%3E%20%7B%0A%20%20%20%20%20%20%20%20for%20x%20in%20self.iter.by_ref()%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(self.predicate)(%26x)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20Some(x)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20None%0A%20%20%20%20%7D%0A%0A%20%20%20%20%23%5Binline%5D%0A%20%20%20%20fn%20size_hint(%26self)%20-%3E%20(usize%2C%20Option%3Cusize%3E)%20%7B%0A%20%20%20%20%20%20%20%20let%20(_%2C%20upper)%20%3D%20self.iter.size_hint()%3B%0A%20%20%20%20%20%20%20%20(0%2C%20upper)%20%2F%2F%20because%20of%20the%20predicate%2C%20the%20original%20lower%20bound%20can't%20be%20trusted%0A%20%20%20%20%7D%0A%7D%0A%7D">Run</a></pre>

<hr>

<pre class='rust rust-example-rendered'>
<span class='kw'>pub</span> <span class='kw'>trait</span> <span class='ident'>Iterator</span> {
    <span class='kw'>fn</span> <span class='ident'>filter_map</span><span class='op'>&lt;</span><span class='ident'>B</span>, <span class='ident'>F</span><span class='op'>&gt;</span>(<span class='self'>self</span>, <span class='ident'>f</span>: <span class='ident'>F</span>) <span class='op'>-&gt;</span> <span class='ident'>FilterMap</span><span class='op'>&lt;</span><span class='self'>Self</span>, <span class='ident'>F</span><span class='op'>&gt;</span>
        <span class='kw'>where</span> <span class='self'>Self</span>: <span class='ident'>Sized</span>, <span class='ident'>F</span>: <span class='ident'>FnMut</span>(<span class='self'>Self</span>::<span class='ident'>Item</span>) <span class='op'>-&gt;</span> <span class='prelude-ty'>Option</span><span class='op'>&lt;</span><span class='ident'>B</span><span class='op'>&gt;</span>
    {
        <span class='ident'>FilterMap</span> { <span class='ident'>iter</span>: <span class='self'>self</span>, <span class='ident'>f</span>: <span class='ident'>f</span> }
    }
}<a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=fn%20main()%20%7B%0Apub%20trait%20Iterator%20%7B%0A%20%20%20%20fn%20filter_map%3CB%2C%20F%3E(self%2C%20f%3A%20F)%20-%3E%20FilterMap%3CSelf%2C%20F%3E%0A%20%20%20%20%20%20%20%20where%20Self%3A%20Sized%2C%20F%3A%20FnMut(Self%3A%3AItem)%20-%3E%20Option%3CB%3E%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20FilterMap%20%7B%20iter%3A%20self%2C%20f%3A%20f%20%7D%0A%20%20%20%20%7D%0A%7D%0A%7D">Run</a></pre>

<p>Like <code>map</code>, this method returns a mapping adapter. However, the functor taken does more than just mapping: by returning an <code>Option</code>, it also does the filtering.</p>

<p>The returned <code>FilterMap</code> is defined as follows:</p>

<pre class='rust rust-example-rendered'>
<span class='kw'>pub</span> <span class='kw'>struct</span> <span class='ident'>FilterMap</span><span class='op'>&lt;</span><span class='ident'>I</span>, <span class='ident'>F</span><span class='op'>&gt;</span> {
    <span class='ident'>iter</span>: <span class='ident'>I</span>,
    <span class='ident'>f</span>: <span class='ident'>F</span>,
}

<span class='kw'>impl</span><span class='op'>&lt;</span><span class='ident'>B</span>, <span class='ident'>I</span>: <span class='ident'>Iterator</span>, <span class='ident'>F</span><span class='op'>&gt;</span> <span class='ident'>Iterator</span> <span class='kw'>for</span> <span class='ident'>FilterMap</span><span class='op'>&lt;</span><span class='ident'>I</span>, <span class='ident'>F</span><span class='op'>&gt;</span>
    <span class='kw'>where</span> <span class='ident'>F</span>: <span class='ident'>FnMut</span>(<span class='ident'>I</span>::<span class='ident'>Item</span>) <span class='number'>0</span><span class='op'>&gt;</span> <span class='prelude-ty'>Option</span><span class='op'>&lt;</span><span class='ident'>B</span><span class='op'>&gt;</span>
{
    <span class='kw'>type</span> <span class='ident'>Item</span> <span class='op'>=</span> <span class='ident'>B</span>;
    <span class='attribute'>#[<span class='ident'>inline</span>]</span>
    <span class='kw'>fn</span> <span class='ident'>next</span>(<span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='self'>self</span>) <span class='op'>-&gt;</span> <span class='ident'>B</span> {
        <span class='kw'>for</span> <span class='ident'>x</span> <span class='kw'>in</span> <span class='self'>self</span>.<span class='ident'>iter</span>.<span class='ident'>by_ref</span>() {
            <span class='kw'>if</span> <span class='kw'>let</span> <span class='prelude-val'>Some</span>(<span class='ident'>ret</span>) <span class='op'>=</span> (<span class='self'>self</span>.<span class='ident'>f</span>)(<span class='ident'>x</span>) {
                <span class='kw'>return</span> <span class='prelude-val'>Some</span>(<span class='ident'>ret</span>);
            }
        }
        <span class='prelude-val'>None</span>
    }

    <span class='attribute'>#[<span class='ident'>inline</span>]</span>
    <span class='kw'>fn</span> <span class='ident'>size_hint</span>(<span class='kw-2'>&amp;</span><span class='self'>self</span>) <span class='op'>-&gt;</span> (<span class='ident'>usize</span>, <span class='prelude-ty'>Option</span><span class='op'>&lt;</span><span class='ident'>usize</span><span class='op'>&gt;</span>) {
        <span class='kw'>let</span> (_, <span class='ident'>upper</span>) <span class='op'>=</span> <span class='self'>self</span>.<span class='ident'>iter</span>.<span class='ident'>size_hint</span>();
        (<span class='number'>0</span>, <span class='ident'>upper</span>) <span class='comment'>// can&#39;t know a lower bound, due to the predicate</span>
    }
}<a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=fn%20main()%20%7B%0Apub%20struct%20FilterMap%3CI%2C%20F%3E%20%7B%0A%20%20%20%20iter%3A%20I%2C%0A%20%20%20%20f%3A%20F%2C%0A%7D%0A%0Aimpl%3CB%2C%20I%3A%20Iterator%2C%20F%3E%20Iterator%20for%20FilterMap%3CI%2C%20F%3E%0A%20%20%20%20where%20F%3A%20FnMut(I%3A%3AItem)%200%3E%20Option%3CB%3E%0A%7B%0A%20%20%20%20type%20Item%20%3D%20B%3B%0A%20%20%20%20%23%5Binline%5D%0A%20%20%20%20fn%20next(%26mut%20self)%20-%3E%20B%20%7B%0A%20%20%20%20%20%20%20%20for%20x%20in%20self.iter.by_ref()%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20let%20Some(ret)%20%3D%20(self.f)(x)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20Some(ret)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20None%0A%20%20%20%20%7D%0A%0A%20%20%20%20%23%5Binline%5D%0A%20%20%20%20fn%20size_hint(%26self)%20-%3E%20(usize%2C%20Option%3Cusize%3E)%20%7B%0A%20%20%20%20%20%20%20%20let%20(_%2C%20upper)%20%3D%20self.iter.size_hint()%3B%0A%20%20%20%20%20%20%20%20(0%2C%20upper)%20%2F%2F%20can't%20know%20a%20lower%20bound%2C%20due%20to%20the%20predicate%0A%20%20%20%20%7D%0A%7D%0A%7D">Run</a></pre>

<hr>

<pre class='rust rust-example-rendered'>
<span class='kw'>fn</span> <span class='ident'>enumerate</span>(<span class='self'>self</span>) <span class='op'>-&gt;</span> <span class='ident'>Enumerate</span><span class='op'>&lt;</span><span class='self'>Self</span><span class='op'>&gt;</span> <span class='kw'>where</span> <span class='self'>Self</span>: <span class='ident'>Sized</span> {
    <span class='ident'>Enumerate</span> { <span class='ident'>iter</span>: <span class='self'>self</span>, <span class='ident'>count</span>: <span class='number'>0</span> }
}<a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=fn%20main()%20%7B%0Afn%20enumerate(self)%20-%3E%20Enumerate%3CSelf%3E%20where%20Self%3A%20Sized%20%7B%0A%20%20%20%20Enumerate%20%7B%20iter%3A%20self%2C%20count%3A%200%20%7D%0A%7D%0A%7D">Run</a></pre>

<p>The method creates an adapter yielding the item as well as a <code>count: usize</code> of the current iteration, in a tuple as <code>(count, item)</code>. The is useful when counting is needed. Enumerating an iterator which can yield more <code>usize::MAX</code> might either produces the wrong result, or panics.</p>

<p>The returned adapter is defined as follows:</p>

<pre class='rust rust-example-rendered'>
<span class='kw'>pub</span> <span class='kw'>struct</span> <span class='ident'>Enumerate</span><span class='op'>&lt;</span><span class='ident'>T</span><span class='op'>&gt;</span> {
    <span class='ident'>iter</span>: <span class='ident'>I</span>,
    <span class='ident'>count</span>: <span class='ident'>usize</span>,
}

<span class='kw'>impl</span><span class='op'>&lt;</span><span class='ident'>I</span><span class='op'>&gt;</span> <span class='ident'>Iterator</span> <span class='kw'>for</span> <span class='ident'>Enumerate</span><span class='op'>&lt;</span><span class='ident'>I</span><span class='op'>&gt;</span> <span class='kw'>where</span> <span class='ident'>I</span>: <span class='ident'>Iterator</span> {
    <span class='kw'>type</span> <span class='ident'>Item</span> <span class='op'>=</span> (<span class='ident'>usize</span>, <span class='op'>&lt;</span><span class='ident'>I</span> <span class='kw'>as</span> <span class='ident'>Iterator</span><span class='op'>&gt;</span>::<span class='ident'>Item</span>);

    <span class='attribute'>#[<span class='ident'>inline</span>]</span>
    <span class='attribute'>#[<span class='ident'>rustc_inherit_overflow_checks</span>]</span> <span class='comment'>// The attribute ensures that in debug builds the method would always be checked against overflows.</span>
    <span class='kw'>fn</span> <span class='ident'>next</span>(<span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='self'>self</span>) <span class='op'>-&gt;</span> <span class='prelude-ty'>Option</span><span class='op'>&lt;</span>(<span class='ident'>usize</span>, <span class='op'>&lt;</span><span class='ident'>I</span> <span class='kw'>as</span> <span class='ident'>Iterator</span><span class='op'>&gt;</span>::<span class='ident'>Item</span>)<span class='op'>&gt;</span> {
        <span class='self'>self</span>.<span class='ident'>iter</span>.<span class='ident'>next</span>().<span class='ident'>map</span>(<span class='op'>|</span><span class='ident'>a</span><span class='op'>|</span> {
            <span class='kw'>let</span> <span class='ident'>ret</span> <span class='op'>=</span> (<span class='self'>self</span>.<span class='ident'>count</span>, <span class='ident'>a</span>);
            <span class='comment'>// possible overflows</span>
            <span class='self'>self</span>.<span class='ident'>count</span> <span class='op'>+=</span> <span class='number'>1</span>;
            <span class='ident'>ret</span>
        })
    }

    <span class='attribute'>#[<span class='ident'>inline</span>]</span>
    <span class='kw'>fn</span> <span class='ident'>size_hint</span>(<span class='kw-2'>&amp;</span><span class='self'>self</span>) <span class='op'>-&gt;</span> (<span class='ident'>usize</span>, <span class='prelude-ty'>Option</span><span class='op'>&lt;</span><span class='ident'>usize</span><span class='op'>&gt;</span>) {
        <span class='self'>self</span>.<span class='ident'>iter</span>.<span class='ident'>size_hint</span>()
    }

    <span class='attribute'>#[<span class='ident'>inline</span>]</span>
    <span class='attribute'>#[<span class='ident'>rustc_inherit_overflow_checks</span>]</span>
    <span class='kw'>fn</span> <span class='ident'>nth</span>(<span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='self'>self</span>, <span class='ident'>n</span>: <span class='ident'>usize</span>) <span class='op'>-&gt;</span> <span class='prelude-ty'>Option</span><span class='op'>&lt;</span>(<span class='ident'>usize</span>, <span class='ident'>I</span>::<span class='ident'>Item</span>)<span class='op'>&gt;</span> {
        <span class='self'>self</span>.<span class='ident'>iter</span>.<span class='ident'>nth</span>(<span class='ident'>n</span>).<span class='ident'>map</span>(<span class='op'>|</span><span class='ident'>a</span><span class='op'>|</span> {
            <span class='kw'>let</span> <span class='ident'>i</span> <span class='op'>=</span> <span class='self'>self</span>.<span class='ident'>count</span> <span class='op'>+</span> <span class='ident'>n</span>;
            <span class='self'>self</span>.<span class='ident'>count</span> <span class='op'>=</span> <span class='ident'>i</span> <span class='op'>+</span> <span class='number'>1</span>;
            (<span class='ident'>i</span>, <span class='ident'>a</span>)
        })
    }

    <span class='attribute'>#[<span class='ident'>inline</span>]</span>
    <span class='kw'>fn</span> <span class='ident'>count</span>(<span class='self'>self</span>) <span class='op'>-&gt;</span> <span class='ident'>usize</span> {
        <span class='self'>self</span>.<span class='ident'>iter</span>.<span class='ident'>count</span>()
    }
}<a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=fn%20main()%20%7B%0Apub%20struct%20Enumerate%3CT%3E%20%7B%0A%20%20%20%20iter%3A%20I%2C%0A%20%20%20%20count%3A%20usize%2C%0A%7D%0A%0Aimpl%3CI%3E%20Iterator%20for%20Enumerate%3CI%3E%20where%20I%3A%20Iterator%20%7B%0A%20%20%20%20type%20Item%20%3D%20(usize%2C%20%3CI%20as%20Iterator%3E%3A%3AItem)%3B%0A%0A%20%20%20%20%23%5Binline%5D%0A%20%20%20%20%23%5Brustc_inherit_overflow_checks%5D%20%2F%2F%20The%20attribute%20ensures%20that%20in%20debug%20builds%20the%20method%20would%20always%20be%20checked%20against%20overflows.%0A%20%20%20%20fn%20next(%26mut%20self)%20-%3E%20Option%3C(usize%2C%20%3CI%20as%20Iterator%3E%3A%3AItem)%3E%20%7B%0A%20%20%20%20%20%20%20%20self.iter.next().map(%7Ca%7C%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20let%20ret%20%3D%20(self.count%2C%20a)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20possible%20overflows%0A%20%20%20%20%20%20%20%20%20%20%20%20self.count%20%2B%3D%201%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20ret%0A%20%20%20%20%20%20%20%20%7D)%0A%20%20%20%20%7D%0A%0A%20%20%20%20%23%5Binline%5D%0A%20%20%20%20fn%20size_hint(%26self)%20-%3E%20(usize%2C%20Option%3Cusize%3E)%20%7B%0A%20%20%20%20%20%20%20%20self.iter.size_hint()%0A%20%20%20%20%7D%0A%0A%20%20%20%20%23%5Binline%5D%0A%20%20%20%20%23%5Brustc_inherit_overflow_checks%5D%0A%20%20%20%20fn%20nth(%26mut%20self%2C%20n%3A%20usize)%20-%3E%20Option%3C(usize%2C%20I%3A%3AItem)%3E%20%7B%0A%20%20%20%20%20%20%20%20self.iter.nth(n).map(%7Ca%7C%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20let%20i%20%3D%20self.count%20%2B%20n%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20self.count%20%3D%20i%20%2B%201%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20(i%2C%20a)%0A%20%20%20%20%20%20%20%20%7D)%0A%20%20%20%20%7D%0A%0A%20%20%20%20%23%5Binline%5D%0A%20%20%20%20fn%20count(self)%20-%3E%20usize%20%7B%0A%20%20%20%20%20%20%20%20self.iter.count()%0A%20%20%20%20%7D%0A%7D%0A%7D">Run</a></pre>

<hr>

<pre class='rust rust-example-rendered'>
<span class='kw'>pub</span> <span class='kw'>trait</span> <span class='ident'>Iterator</span> {
    <span class='kw'>fn</span> <span class='ident'>peekable</span>(<span class='self'>self</span>) <span class='op'>-&gt;</span> <span class='ident'>Peekable</span><span class='op'>&lt;</span><span class='self'>Self</span><span class='op'>&gt;</span> <span class='kw'>where</span> <span class='self'>Self</span>: <span class='ident'>Sized</span> {
        <span class='ident'>Peekable</span> { <span class='ident'>iter</span>: <span class='self'>self</span>, <span class='ident'>peeked</span>: <span class='prelude-val'>None</span> }
    }
}<a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=fn%20main()%20%7B%0Apub%20trait%20Iterator%20%7B%0A%20%20%20%20fn%20peekable(self)%20-%3E%20Peekable%3CSelf%3E%20where%20Self%3A%20Sized%20%7B%0A%20%20%20%20%20%20%20%20Peekable%20%7B%20iter%3A%20self%2C%20peeked%3A%20None%20%7D%0A%20%20%20%20%7D%0A%7D%0A%7D">Run</a></pre>

<p>The method creates an adapter that can <code>peek</code> into the net element of the iterator, without consuming it.</p>

<p>The returned adapter&#39;s type is defined as</p>

<pre class='rust rust-example-rendered'>
<span class='kw'>pub</span> <span class='kw'>struct</span> <span class='ident'>Peekable</span><span class='op'>&lt;</span><span class='ident'>I</span>: <span class='ident'>Iterator</span><span class='op'>&gt;</span> {
    <span class='ident'>iter</span>: <span class='ident'>I</span>,
    <span class='ident'>peeked</span>: <span class='prelude-ty'>Option</span><span class='op'>&lt;</span><span class='prelude-ty'>Option</span><span class='op'>&lt;</span><span class='ident'>I</span>::<span class='ident'>Item</span><span class='op'>&gt;&gt;</span>,
}

<span class='kw'>impl</span><span class='op'>&lt;</span><span class='ident'>I</span>: <span class='ident'>Iterator</span><span class='op'>&gt;</span> <span class='ident'>Iterator</span> <span class='kw'>for</span> <span class='ident'>Peekable</span><span class='op'>&lt;</span><span class='ident'>I</span><span class='op'>&gt;</span> {
    <span class='kw'>type</span> <span class='ident'>Item</span> <span class='op'>=</span> <span class='ident'>I</span>::<span class='ident'>Item</span>;

    <span class='attribute'>#[<span class='ident'>inline</span>]</span>
    <span class='kw'>fn</span> <span class='ident'>next</span>(<span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='self'>self</span>) <span class='op'>-&gt;</span> <span class='prelude-ty'>Option</span><span class='op'>&lt;</span><span class='ident'>I</span>::<span class='ident'>Item</span><span class='op'>&gt;</span> {
        <span class='kw'>match</span> <span class='self'>self</span>.<span class='ident'>peeked</span>.<span class='ident'>take</span>() {
            <span class='prelude-val'>Some</span>(<span class='ident'>v</span>) <span class='op'>=&gt;</span> <span class='ident'>v</span>,
            <span class='ident'>Non</span> <span class='op'>=&gt;</span> <span class='self'>self</span>.<span class='ident'>iter</span>.<span class='ident'>next</span>(),
        }
    }
}<a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=fn%20main()%20%7B%0Apub%20struct%20Peekable%3CI%3A%20Iterator%3E%20%7B%0A%20%20%20%20iter%3A%20I%2C%0A%20%20%20%20peeked%3A%20Option%3COption%3CI%3A%3AItem%3E%3E%2C%0A%7D%0A%0Aimpl%3CI%3A%20Iterator%3E%20Iterator%20for%20Peekable%3CI%3E%20%7B%0A%20%20%20%20type%20Item%20%3D%20I%3A%3AItem%3B%0A%0A%20%20%20%20%23%5Binline%5D%0A%20%20%20%20fn%20next(%26mut%20self)%20-%3E%20Option%3CI%3A%3AItem%3E%20%7B%0A%20%20%20%20%20%20%20%20match%20self.peeked.take()%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20Some(v)%20%3D%3E%20v%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20Non%20%3D%3E%20self.iter.next()%2C%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%7D%0A%7D">Run</a></pre>

<hr>

<pre class='rust rust-example-rendered'>
<span class='kw'>pub</span> <span class='kw'>trait</span> <span class='ident'>Iterator</span> {
    <span class='kw'>fn</span> <span class='ident'>skip_while</span><span class='op'>&lt;</span><span class='ident'>P</span><span class='op'>&gt;</span>(<span class='self'>self</span>, <span class='ident'>predicate</span>: <span class='ident'>P</span>) <span class='op'>-&gt;</span> <span class='ident'>SkipWhile</span><span class='op'>&lt;</span><span class='self'>Self</span>, <span class='ident'>P</span><span class='op'>&gt;</span>
        <span class='kw'>where</span> <span class='self'>Self</span>: <span class='ident'>Sized</span>, <span class='ident'>P</span>: <span class='ident'>FnMut</span>(<span class='kw-2'>&amp;</span><span class='self'>Self</span>::<span class='ident'>Item</span>) <span class='op'>-&gt;</span> <span class='ident'>bool</span>
    {
        <span class='ident'>SkipWhile</span>{ <span class='ident'>iter</span>: <span class='self'>self</span>, <span class='ident'>flag</span>: <span class='bool-val'>false</span>, <span class='ident'>predicate</span>: <span class='ident'>predicate</span> }
    }
}<a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=fn%20main()%20%7B%0Apub%20trait%20Iterator%20%7B%0A%20%20%20%20fn%20skip_while%3CP%3E(self%2C%20predicate%3A%20P)%20-%3E%20SkipWhile%3CSelf%2C%20P%3E%0A%20%20%20%20%20%20%20%20where%20Self%3A%20Sized%2C%20P%3A%20FnMut(%26Self%3A%3AItem)%20-%3E%20bool%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20SkipWhile%7B%20iter%3A%20self%2C%20flag%3A%20false%2C%20predicate%3A%20predicate%20%7D%0A%20%20%20%20%7D%0A%7D%0A%7D">Run</a></pre>

<p>This method returns an adapter that skips through the original iterator&#39;s yielding items until an invocation to the predicate returns <code>false</code>. After that, <em>every</em> succeeding element would be returned as is. The predicate would by then be done for. This is where this method differs from a negative <code>filter</code>.</p>

<p>The returned adapter is defined as follows:</p>

<pre class='rust rust-example-rendered'>
<span class='kw'>pub</span> <span class='kw'>struct</span> <span class='ident'>SkipWhile</span><span class='op'>&lt;</span><span class='ident'>I</span>, <span class='ident'>P</span><span class='op'>&gt;</span> {
    <span class='ident'>iter</span>: <span class='ident'>I</span>,
    <span class='ident'>flag</span>: <span class='ident'>bool</span>,
    <span class='ident'>predicate</span>: <span class='ident'>P</span>,
}

<span class='kw'>impl</span><span class='op'>&lt;</span><span class='ident'>I</span>: <span class='ident'>Iterator</span>, <span class='ident'>P</span><span class='op'>&gt;</span> <span class='ident'>Iterator</span> <span class='kw'>for</span> <span class='ident'>SkipWhile</span><span class='op'>&lt;</span><span class='ident'>I</span>, <span class='ident'>P</span><span class='op'>&gt;</span>
    <span class='kw'>where</span> <span class='ident'>P</span>: <span class='ident'>FnMut</span>(<span class='kw-2'>&amp;</span><span class='ident'>I</span>::<span class='ident'>Item</span>) <span class='op'>-&gt;</span> <span class='ident'>bool</span>
{
    <span class='kw'>type</span> <span class='ident'>Item</span> <span class='op'>=</span> <span class='ident'>I</span>::<span class='ident'>Item</span>;

    <span class='attribute'>#[<span class='ident'>inline</span>]</span>
    <span class='kw'>fn</span> <span class='ident'>next</span>(<span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='self'>self</span>) <span class='op'>-&gt;</span> <span class='prelude-ty'>Option</span><span class='op'>&lt;</span><span class='ident'>I</span>::<span class='ident'>Item</span><span class='op'>&gt;</span> {
        <span class='kw'>for</span> <span class='ident'>x</span> <span class='kw'>in</span> <span class='self'>self</span>.<span class='ident'>iter</span>.<span class='ident'>by_ref</span>() {
            <span class='kw'>if</span> <span class='self'>self</span>.<span class='ident'>flag</span> <span class='op'>||</span> <span class='op'>!</span>(<span class='self'>self</span>.<span class='ident'>predicate</span>)(<span class='kw-2'>&amp;</span><span class='ident'>x</span>) {
                <span class='self'>self</span>.<span class='ident'>flag</span> <span class='op'>=</span> <span class='bool-val'>true</span>;
                <span class='kw'>return</span> <span class='prelude-val'>Some</span>(<span class='ident'>x</span>);
            }
        }
        <span class='prelude-val'>None</span>
    }

    <span class='attribute'>#[<span class='ident'>inline</span>]</span>
    <span class='kw'>fn</span> <span class='ident'>size_hint</span>(<span class='kw-2'>&amp;</span><span class='self'>self</span>) <span class='op'>-&gt;</span> (<span class='ident'>usize</span>, <span class='prelude-ty'>Option</span><span class='op'>&lt;</span><span class='ident'>usize</span>) {
        <span class='kw'>let</span> (_, <span class='ident'>upper</span>) <span class='op'>=</span> <span class='self'>self</span>.<span class='ident'>iter</span>.<span class='ident'>size_hint</span>();
        (<span class='number'>0</span>, <span class='ident'>upper</span>) <span class='comment'>// lower bound can&#39;t be trusted due to skipping</span>
    }
}<a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=fn%20main()%20%7B%0Apub%20struct%20SkipWhile%3CI%2C%20P%3E%20%7B%0A%20%20%20%20iter%3A%20I%2C%0A%20%20%20%20flag%3A%20bool%2C%0A%20%20%20%20predicate%3A%20P%2C%0A%7D%0A%0Aimpl%3CI%3A%20Iterator%2C%20P%3E%20Iterator%20for%20SkipWhile%3CI%2C%20P%3E%0A%20%20%20%20where%20P%3A%20FnMut(%26I%3A%3AItem)%20-%3E%20bool%0A%7B%0A%20%20%20%20type%20Item%20%3D%20I%3A%3AItem%3B%0A%0A%20%20%20%20%23%5Binline%5D%0A%20%20%20%20fn%20next(%26mut%20self)%20-%3E%20Option%3CI%3A%3AItem%3E%20%7B%0A%20%20%20%20%20%20%20%20for%20x%20in%20self.iter.by_ref()%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20self.flag%20%7C%7C%20!(self.predicate)(%26x)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.flag%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20Some(x)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20None%0A%20%20%20%20%7D%0A%0A%20%20%20%20%23%5Binline%5D%0A%20%20%20%20fn%20size_hint(%26self)%20-%3E%20(usize%2C%20Option%3Cusize)%20%7B%0A%20%20%20%20%20%20%20%20let%20(_%2C%20upper)%20%3D%20self.iter.size_hint()%3B%0A%20%20%20%20%20%20%20%20(0%2C%20upper)%20%2F%2F%20lower%20bound%20can't%20be%20trusted%20due%20to%20skipping%0A%20%20%20%20%7D%0A%7D%0A%7D">Run</a></pre>

<p>Note that unlike most other adapters, this adapter doesn&#39;t persist a <code>ExactNumberAdapter</code> or <code>DoubleEndnedAdapter</code>.</p>

<hr>

<pre class='rust rust-example-rendered'>
<span class='kw'>pub</span> <span class='kw'>trait</span> <span class='ident'>Iterator</span> {
    <span class='kw'>fn</span> <span class='ident'>take_while</span><span class='op'>&lt;</span><span class='ident'>P</span><span class='op'>&gt;</span>(<span class='self'>self</span>, <span class='ident'>predicate</span>: <span class='ident'>P</span>) <span class='op'>-&gt;</span> <span class='ident'>TakeWhile</span><span class='op'>&lt;</span><span class='self'>Self</span>, <span class='ident'>P</span><span class='op'>&gt;</span> { <span class='comment'>/* ... */</span>}
}<a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=fn%20main()%20%7B%0Apub%20trait%20Iterator%20%7B%0A%20%20%20%20fn%20take_while%3CP%3E(self%2C%20predicate%3A%20P)%20-%3E%20TakeWhile%3CSelf%2C%20P%3E%20%7B%20%2F*%20...%20*%2F%7D%0A%7D%0A%7D">Run</a></pre>

<p>Creates an adapter that yields original iterator&#39;s elements until the <code>predicate</code> when applying on the element, returns a <code>false</code>. This is quiet the opposite of <code>skip_while</code>. We omit implementation details here.</p>

<hr>

<pre class='rust rust-example-rendered'>
<span class='kw'>pub</span> <span class='kw'>trait</span> <span class='ident'>Iterator</span> {
    <span class='kw'>fn</span> <span class='ident'>skip</span>(<span class='self'>self</span>, <span class='ident'>n</span>: <span class='ident'>usize</span>) <span class='op'>-&gt;</span> <span class='ident'>Skip</span><span class='op'>&lt;</span><span class='self'>Self</span><span class='op'>&gt;</span> { <span class='comment'>/* ... */</span>}
}<a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=fn%20main()%20%7B%0Apub%20trait%20Iterator%20%7B%0A%20%20%20%20fn%20skip(self%2C%20n%3A%20usize)%20-%3E%20Skip%3CSelf%3E%20%7B%20%2F*%20...%20*%2F%7D%0A%7D%0A%7D">Run</a></pre>

<p>Creates an adapter that skips the next <code>n</code> elements of the original iterator.</p>

<hr>

<pre class='rust rust-example-rendered'>
<span class='kw'>pub</span> <span class='kw'>trait</span> <span class='ident'>Iterator</span> {
    <span class='kw'>fn</span> <span class='ident'>take</span>(<span class='self'>self</span>, <span class='ident'>n</span>: <span class='ident'>usize</span>) <span class='op'>-&gt;</span> <span class='ident'>Take</span><span class='op'>&lt;</span><span class='self'>Self</span><span class='op'>&gt;</span> { <span class='comment'>/* ... */</span>}
}<a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=fn%20main()%20%7B%0Apub%20trait%20Iterator%20%7B%0A%20%20%20%20fn%20take(self%2C%20n%3A%20usize)%20-%3E%20Take%3CSelf%3E%20%7B%20%2F*%20...%20*%2F%7D%0A%7D%0A%7D">Run</a></pre>

<p>Creates an adapter that only takes the next <code>n</code> elements of the original iterator.</p>

<hr>

<pre class='rust rust-example-rendered'>
<span class='kw'>pub</span> <span class='kw'>trait</span> <span class='ident'>Iterator</span> {
    <span class='kw'>fn</span> <span class='ident'>scan</span><span class='op'>&lt;</span><span class='ident'>St</span>, <span class='ident'>B</span>, <span class='ident'>F</span><span class='op'>&gt;</span>(<span class='self'>self</span>, <span class='ident'>initial_state</span>: <span class='ident'>St</span>, <span class='ident'>f</span>: <span class='ident'>F</span>) <span class='op'>-&gt;</span> <span class='ident'>Scan</span><span class='op'>&lt;</span><span class='self'>Self</span>, <span class='ident'>St</span>, <span class='ident'>F</span><span class='op'>&gt;</span>
        <span class='kw'>where</span> <span class='self'>Self</span>: <span class='ident'>Sized</span>, <span class='ident'>F</span>: <span class='ident'>FnMut</span>(<span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='ident'>St</span>, <span class='self'>Self</span>::<span class='ident'>Item</span>) <span class='op'>-&gt;</span> <span class='prelude-ty'>Option</span><span class='op'>&lt;</span><span class='ident'>B</span><span class='op'>&gt;</span>
    {
        <span class='ident'>Scan</span> { <span class='ident'>iter</span>: <span class='self'>self</span>, <span class='ident'>f</span>: <span class='ident'>f</span>, <span class='ident'>state</span>: <span class='ident'>initial_state</span> }
    }
}<a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=fn%20main()%20%7B%0Apub%20trait%20Iterator%20%7B%0A%20%20%20%20fn%20scan%3CSt%2C%20B%2C%20F%3E(self%2C%20initial_state%3A%20St%2C%20f%3A%20F)%20-%3E%20Scan%3CSelf%2C%20St%2C%20F%3E%0A%20%20%20%20%20%20%20%20where%20Self%3A%20Sized%2C%20F%3A%20FnMut(%26mut%20St%2C%20Self%3A%3AItem)%20-%3E%20Option%3CB%3E%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20Scan%20%7B%20iter%3A%20self%2C%20f%3A%20f%2C%20state%3A%20initial_state%20%7D%0A%20%20%20%20%7D%0A%7D%0A%7D">Run</a></pre>

<p>Like <code>fold</code>, this method takes and accumulates a <code>state</code> object. Unlike <code>fold</code> which only returns the final result, <code>scan</code> here returns another iterator adapter, yielding out some &quot;intermediate results&quot; upon every iteration of the original iterator.</p>

<p>The definition of the returned structure is as follows:</p>

<pre class='rust rust-example-rendered'>
<span class='kw'>pub</span> <span class='kw'>struct</span> <span class='ident'>Scan</span><span class='op'>&lt;</span><span class='ident'>I</span>, <span class='ident'>St</span>, <span class='ident'>F</span><span class='op'>&gt;</span> {
    <span class='ident'>iter</span>: <span class='ident'>I</span>,
    <span class='ident'>f</span>: <span class='ident'>F</span>,
    <span class='ident'>state</span>: <span class='ident'>St</span>,
}

<span class='kw'>impl</span><span class='op'>&lt;</span><span class='ident'>B</span>, <span class='ident'>I</span>, <span class='ident'>St</span>, <span class='ident'>F</span><span class='op'>&gt;</span> <span class='ident'>Iterator</span> <span class='kw'>for</span> <span class='ident'>Scan</span><span class='op'>&lt;</span><span class='ident'>I</span>, <span class='ident'>St</span>, <span class='ident'>F</span><span class='op'>&gt;</span>
    <span class='kw'>where</span> <span class='ident'>I</span>: <span class='ident'>Iterator</span>,
          <span class='ident'>F</span>: <span class='ident'>FnMut</span>(<span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='ident'>St</span>, <span class='ident'>I</span>::<span class='ident'>Item</span>) <span class='op'>-&gt;</span> <span class='prelude-ty'>Option</span><span class='op'>&lt;</span><span class='ident'>B</span><span class='op'>&gt;</span>
{
    <span class='kw'>type</span> <span class='ident'>Item</span> <span class='op'>=</span> <span class='ident'>B</span>;

    <span class='attribute'>#[<span class='ident'>inline</span>]</span>
    <span class='kw'>fn</span> <span class='ident'>next</span>(<span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='self'>self</span>) <span class='op'>-&gt;</span> <span class='prelude-ty'>Option</span><span class='op'>&lt;</span><span class='ident'>B</span><span class='op'>&gt;</span> {
        <span class='self'>self</span>.<span class='ident'>iter</span>.<span class='ident'>next</span>().<span class='ident'>and_then</span>(<span class='op'>|</span><span class='ident'>a</span><span class='op'>|</span> (<span class='self'>self</span>.<span class='ident'>f</span>)(<span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='self'>self</span>.<span class='ident'>state</span>, <span class='ident'>a</span>))
    }

    <span class='attribute'>#[<span class='ident'>inline</span>]</span>
    <span class='kw'>fn</span> <span class='ident'>size_hint</span>(<span class='kw-2'>&amp;</span><span class='self'>self</span>) <span class='op'>-&gt;</span> (<span class='ident'>usize</span>, <span class='prelude-ty'>Option</span><span class='op'>&lt;</span><span class='ident'>usize</span><span class='op'>&gt;</span>) {
        <span class='kw'>let</span> (_, <span class='ident'>upper</span>) <span class='op'>=</span> <span class='self'>self</span>.<span class='ident'>iter</span>.<span class='ident'>size_hint</span>();
        (<span class='number'>0</span>, <span class='ident'>upper</span>)
    }
}<a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=fn%20main()%20%7B%0Apub%20struct%20Scan%3CI%2C%20St%2C%20F%3E%20%7B%0A%20%20%20%20iter%3A%20I%2C%0A%20%20%20%20f%3A%20F%2C%0A%20%20%20%20state%3A%20St%2C%0A%7D%0A%0Aimpl%3CB%2C%20I%2C%20St%2C%20F%3E%20Iterator%20for%20Scan%3CI%2C%20St%2C%20F%3E%0A%20%20%20%20where%20I%3A%20Iterator%2C%0A%20%20%20%20%20%20%20%20%20%20F%3A%20FnMut(%26mut%20St%2C%20I%3A%3AItem)%20-%3E%20Option%3CB%3E%0A%7B%0A%20%20%20%20type%20Item%20%3D%20B%3B%0A%0A%20%20%20%20%23%5Binline%5D%0A%20%20%20%20fn%20next(%26mut%20self)%20-%3E%20Option%3CB%3E%20%7B%0A%20%20%20%20%20%20%20%20self.iter.next().and_then(%7Ca%7C%20(self.f)(%26mut%20self.state%2C%20a))%0A%20%20%20%20%7D%0A%0A%20%20%20%20%23%5Binline%5D%0A%20%20%20%20fn%20size_hint(%26self)%20-%3E%20(usize%2C%20Option%3Cusize%3E)%20%7B%0A%20%20%20%20%20%20%20%20let%20(_%2C%20upper)%20%3D%20self.iter.size_hint()%3B%0A%20%20%20%20%20%20%20%20(0%2C%20upper)%0A%20%20%20%20%7D%0A%7D%0A%7D">Run</a></pre>

<p>Note from the implementation that, the adapter can terminate when:</p>

<ul>
<li>original iterator terminates,</li>
<li>scanning function decides that it should return <code>None</code>.</li>
</ul>

<hr>

<pre class='rust rust-example-rendered'>
<span class='kw'>pub</span> <span class='kw'>trait</span> <span class='ident'>Iterator</span> {
    <span class='kw'>fn</span> <span class='ident'>flat_map</span><span class='op'>&lt;</span><span class='ident'>U</span>, <span class='ident'>F</span><span class='op'>&gt;</span>(<span class='self'>self</span>, <span class='ident'>f</span>: <span class='ident'>F</span>) <span class='op'>-&gt;</span> <span class='ident'>FlatMap</span><span class='op'>&lt;</span><span class='self'>Self</span>, <span class='ident'>U</span>, <span class='ident'>F</span><span class='op'>&gt;</span>
        <span class='kw'>where</span> <span class='self'>Self</span>: <span class='ident'>Sized</span>, <span class='ident'>U</span>: <span class='ident'>IntoIterator</span>, <span class='ident'>F</span>: <span class='ident'>FnMut</span>(<span class='self'>Self</span>::<span class='ident'>Item</span>) <span class='op'>-&gt;</span> <span class='ident'>U</span>,
    {
        <span class='ident'>FlatMap</span> { <span class='ident'>iter</span>: <span class='self'>self</span>, <span class='ident'>f</span>: <span class='ident'>f</span>, <span class='ident'>frontiter</span>: <span class='prelude-val'>None</span>, <span class='ident'>backiter</span>: <span class='prelude-val'>None</span> }
    }
}<a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=fn%20main()%20%7B%0Apub%20trait%20Iterator%20%7B%0A%20%20%20%20fn%20flat_map%3CU%2C%20F%3E(self%2C%20f%3A%20F)%20-%3E%20FlatMap%3CSelf%2C%20U%2C%20F%3E%0A%20%20%20%20%20%20%20%20where%20Self%3A%20Sized%2C%20U%3A%20IntoIterator%2C%20F%3A%20FnMut(Self%3A%3AItem)%20-%3E%20U%2C%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20FlatMap%20%7B%20iter%3A%20self%2C%20f%3A%20f%2C%20frontiter%3A%20None%2C%20backiter%3A%20None%20%7D%0A%20%20%20%20%7D%0A%7D%0A%7D">Run</a></pre>

<p>Creates a &quot;flattened mapping&quot;. While <code>map</code> is certainly helpful, for deeply nested data, it can&#39;t do much.</p>

<p>Say we are to total number of <code>&#39;a&#39;</code>&#39;s in a collection of strings. This method captures such need precisely and efficiently:</p>

<pre class='rust rust-example-rendered'>
<span class='kw'>let</span> <span class='ident'>words</span> <span class='op'>=</span> [<span class='string'>&quot;alpha&quot;</span>, <span class='string'>&quot;beta&quot;</span>, <span class='string'>&quot;gamma&quot;</span>];
<span class='kw'>let</span> <span class='ident'>count_a</span> <span class='op'>=</span> <span class='ident'>words</span>.<span class='ident'>iter</span>().<span class='ident'>flat_map</span>(<span class='op'>|</span><span class='ident'>s</span><span class='op'>|</span> <span class='ident'>s</span>.<span class='ident'>chars</span>()) <span class='comment'>// Now a iterator over all characters</span>
    .<span class='ident'>filter</span>(<span class='op'>|</span><span class='ident'>c</span><span class='op'>|</span> <span class='kw-2'>*</span><span class='ident'>c</span><span class='op'>==</span><span class='string'>&#39;a&#39;</span>).<span class='ident'>count</span>();
<span class='macro'>assert_eq</span><span class='macro'>!</span>(<span class='ident'>count_a</span>, <span class='number'>5</span>);<a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=fn%20main()%20%7B%0Alet%20words%20%3D%20%5B%22alpha%22%2C%20%22beta%22%2C%20%22gamma%22%5D%3B%0Alet%20count_a%20%3D%20words.iter().flat_map(%7Cs%7C%20s.chars())%20%2F%2F%20Now%20a%20iterator%20over%20all%20characters%0A%20%20%20%20.filter(%7Cc%7C%20*c%3D%3D'a').count()%3B%0Aassert_eq!(count_a%2C%205)%3B%0A%7D">Run</a></pre>

<p>Let&#39;s take a look at how this is implemented:</p>

<pre class='rust rust-example-rendered'>
<span class='kw'>pub</span> <span class='kw'>struct</span> <span class='ident'>FlatMap</span><span class='op'>&lt;</span><span class='ident'>I</span>, <span class='ident'>U</span>: <span class='ident'>IntoIterator</span>, <span class='ident'>F</span><span class='op'>&gt;</span> {
    <span class='ident'>iter</span>: <span class='ident'>I</span>,
    <span class='ident'>f</span>: <span class='ident'>F</span>,
    <span class='ident'>frontiter</span>: <span class='prelude-ty'>Option</span><span class='op'>&lt;</span><span class='ident'>U</span>::<span class='ident'>IntoIter</span><span class='op'>&gt;</span>,
    <span class='ident'>backiter</span>: <span class='prelude-ty'>Option</span><span class='op'>&lt;</span><span class='ident'>U</span>::<span class='ident'>IntoIter</span><span class='op'>&gt;</span>, <span class='comment'>// for double ended iterators</span>
}

<span class='kw'>impl</span><span class='op'>&lt;</span><span class='ident'>I</span>: <span class='ident'>Iterator</span>, <span class='ident'>U</span>: <span class='ident'>IntoIterator</span>, <span class='ident'>F</span><span class='op'>&gt;</span> <span class='ident'>Iterator</span> <span class='kw'>for</span> <span class='ident'>FlatMap</span><span class='op'>&lt;</span><span class='ident'>I</span>, <span class='ident'>U</span>, <span class='ident'>F</span><span class='op'>&gt;</span>
    <span class='kw'>where</span> <span class='ident'>F</span>: <span class='ident'>FnMut</span>(<span class='ident'>I</span>::<span class='ident'>Item</span>) <span class='op'>-&gt;</span> <span class='ident'>U</span>
{
    <span class='kw'>type</span> <span class='ident'>Item</span> <span class='op'>=</span> <span class='ident'>U</span>::<span class='ident'>Item</span>;

    <span class='attribute'>#[<span class='ident'>inline</span>]</span>
    <span class='kw'>fn</span> <span class='ident'>next</span>(<span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='self'>self</span>) <span class='op'>-&gt;</span> <span class='prelude-ty'>Option</span><span class='op'>&lt;</span><span class='ident'>U</span>::<span class='ident'>Item</span><span class='op'>&gt;</span> {
        <span class='kw'>loop</span> {
            <span class='kw'>if</span> <span class='kw'>let</span> <span class='prelude-val'>Some</span>(<span class='kw-2'>ref</span> <span class='kw-2'>mut</span> <span class='ident'>inner</span>) <span class='op'>=</span> <span class='self'>self</span>.<span class='ident'>frontiter</span> {
                <span class='kw'>if</span> <span class='kw'>let</span> <span class='prelude-val'>Some</span>(<span class='ident'>x</span>) <span class='op'>=</span> <span class='ident'>inner</span>.<span class='ident'>by_ref</span>().<span class='ident'>next</span>() {
                    <span class='kw'>return</span> <span class='prelude-val'>Some</span>(<span class='ident'>x</span>)
                }
            }
            <span class='kw'>match</span> <span class='self'>self</span>.<span class='ident'>iter</span>.<span class='ident'>next</span>().<span class='ident'>map</span>(<span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='self'>self</span>.<span class='ident'>f</span>) {
                <span class='prelude-val'>None</span> <span class='op'>=&gt;</span> <span class='kw'>return</span> <span class='self'>self</span>.<span class='ident'>backiter</span>.<span class='ident'>as_mut</span>().<span class='ident'>and_then</span>(<span class='op'>|</span><span class='ident'>it</span><span class='op'>|</span> <span class='ident'>it</span>.<span class='ident'>next</span>()),
                <span class='ident'>next</span> <span class='op'>=&gt;</span> <span class='self'>self</span>.<span class='ident'>frontiter</span> <span class='op'>=</span> <span class='ident'>next</span>.<span class='ident'>map</span>(<span class='ident'>IntoIterator</span>::<span class='ident'>into_iter</span>),
            }
        }
    }

    <span class='attribute'>#[<span class='ident'>inline</span>]</span>
    <span class='kw'>fn</span> <span class='ident'>size_hint</span>(<span class='kw-2'>&amp;</span><span class='self'>self</span>) <span class='op'>-&gt;</span> (<span class='ident'>usize</span>, <span class='prelude-ty'>Option</span><span class='op'>&lt;</span><span class='ident'>usize</span><span class='op'>&gt;</span>) {
        <span class='kw'>let</span> (<span class='ident'>flo</span>, <span class='ident'>fhi</span>) <span class='op'>=</span> <span class='self'>self</span>.<span class='ident'>froniter</span>.<span class='ident'>as_ref</span>().<span class='ident'>map_or</span>(<span class='number'>0</span>, <span class='prelude-val'>Some</span>(<span class='number'>0</span>)), <span class='op'>|</span><span class='ident'>it</span><span class='op'>|</span> <span class='ident'>it</span>.<span class='ident'>size_hint</span>());
        <span class='kw'>let</span> (<span class='ident'>blo</span>, <span class='ident'>bhi</span>) <span class='op'>=</span> <span class='self'>self</span>.<span class='ident'>backiter</span>.<span class='ident'>as_ref</span>().<span class='ident'>map_or</span>(<span class='number'>0</span>, <span class='prelude-val'>Some</span>(<span class='number'>0</span>)), <span class='op'>|</span><span class='ident'>it</span><span class='op'>|</span> <span class='ident'>it</span>.<span class='ident'>size_hint</span>());
        <span class='kw'>let</span> <span class='ident'>lo</span> <span class='op'>=</span> <span class='ident'>flo</span>.<span class='ident'>saturating_add</span>(<span class='ident'>blo</span>);
        <span class='kw'>match</span> (<span class='self'>self</span>.<span class='ident'>iter</span>.<span class='ident'>size_hint</span>(), <span class='ident'>fhi</span>, <span class='ident'>bhi</span>) {
            (<span class='number'>0</span>, <span class='prelude-val'>Some</span>(<span class='number'>0</span>), <span class='prelude-val'>Some</span>(<span class='ident'>a</span>), <span class='prelude-val'>Some</span>(<span class='ident'>b</span>)) <span class='op'>=&gt;</span> (<span class='ident'>lo</span>, <span class='ident'>a</span>.<span class='ident'>checked_add</span>(<span class='ident'>b</span>)),
            _ <span class='op'>=&gt;</span> (<span class='ident'>lo</span>, <span class='prelude-val'>None</span>)
        }
    }
}<a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=fn%20main()%20%7B%0Apub%20struct%20FlatMap%3CI%2C%20U%3A%20IntoIterator%2C%20F%3E%20%7B%0A%20%20%20%20iter%3A%20I%2C%0A%20%20%20%20f%3A%20F%2C%0A%20%20%20%20frontiter%3A%20Option%3CU%3A%3AIntoIter%3E%2C%0A%20%20%20%20backiter%3A%20Option%3CU%3A%3AIntoIter%3E%2C%20%2F%2F%20for%20double%20ended%20iterators%0A%7D%0A%0Aimpl%3CI%3A%20Iterator%2C%20U%3A%20IntoIterator%2C%20F%3E%20Iterator%20for%20FlatMap%3CI%2C%20U%2C%20F%3E%0A%20%20%20%20where%20F%3A%20FnMut(I%3A%3AItem)%20-%3E%20U%0A%7B%0A%20%20%20%20type%20Item%20%3D%20U%3A%3AItem%3B%0A%0A%20%20%20%20%23%5Binline%5D%0A%20%20%20%20fn%20next(%26mut%20self)%20-%3E%20Option%3CU%3A%3AItem%3E%20%7B%0A%20%20%20%20%20%20%20%20loop%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20let%20Some(ref%20mut%20inner)%20%3D%20self.frontiter%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20let%20Some(x)%20%3D%20inner.by_ref().next()%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20Some(x)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20match%20self.iter.next().map(%26mut%20self.f)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20None%20%3D%3E%20return%20self.backiter.as_mut().and_then(%7Cit%7C%20it.next())%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20next%20%3D%3E%20self.frontiter%20%3D%20next.map(IntoIterator%3A%3Ainto_iter)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%0A%20%20%20%20%23%5Binline%5D%0A%20%20%20%20fn%20size_hint(%26self)%20-%3E%20(usize%2C%20Option%3Cusize%3E)%20%7B%0A%20%20%20%20%20%20%20%20let%20(flo%2C%20fhi)%20%3D%20self.froniter.as_ref().map_or(0%2C%20Some(0))%2C%20%7Cit%7C%20it.size_hint())%3B%0A%20%20%20%20%20%20%20%20let%20(blo%2C%20bhi)%20%3D%20self.backiter.as_ref().map_or(0%2C%20Some(0))%2C%20%7Cit%7C%20it.size_hint())%3B%0A%20%20%20%20%20%20%20%20let%20lo%20%3D%20flo.saturating_add(blo)%3B%0A%20%20%20%20%20%20%20%20match%20(self.iter.size_hint()%2C%20fhi%2C%20bhi)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20(0%2C%20Some(0)%2C%20Some(a)%2C%20Some(b))%20%3D%3E%20(lo%2C%20a.checked_add(b))%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20_%20%3D%3E%20(lo%2C%20None)%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%7D%0A%7D">Run</a></pre>

<p>Note that to support <code>DoubleEndedIterator</code>s, the structure adds some additional checking, which would otherwise be redundant. I think when specialization kicks in <code>stable</code> this tiny overhead should be gone.</p>

<hr>

<pre class='rust rust-example-rendered'>
<span class='kw'>pub</span> <span class='kw'>trait</span> <span class='ident'>Iterator</span> {
    <span class='kw'>fn</span> <span class='ident'>fuse</span>(<span class='self'>self</span>) <span class='op'>-&gt;</span> <span class='ident'>Fuse</span><span class='op'>&lt;</span><span class='self'>Self</span><span class='op'>&gt;</span> {<span class='comment'>/* ... */</span>}
}<a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=fn%20main()%20%7B%0Apub%20trait%20Iterator%20%7B%0A%20%20%20%20fn%20fuse(self)%20-%3E%20Fuse%3CSelf%3E%20%7B%2F*%20...%20*%2F%7D%0A%7D%0A%7D">Run</a></pre>

<p>The <code>Iterator</code> trait allows its implementation to somewhat resume iterating after yielding a <code>None</code> item. For those that once returned <code>None</code> always returning <code>None</code> from then on, the module provides another wrapper trait, <code>FusedIterator</code>. Currently it is unstable, however this method do let us create such a iterator adapter that implements it.</p>

<hr>

<pre class='rust rust-example-rendered'>
<span class='kw'>pub</span> <span class='kw'>trait</span> <span class='ident'>Iterator</span> {
    <span class='kw'>fn</span> <span class='ident'>inspect</span><span class='op'>&lt;</span><span class='ident'>F</span><span class='op'>&gt;</span>(<span class='self'>self</span>, <span class='ident'>f</span>: <span class='ident'>F</span>) <span class='op'>-&gt;</span> <span class='ident'>Inspect</span><span class='op'>&lt;</span><span class='self'>Self</span>, <span class='ident'>F</span><span class='op'>&gt;</span>
        <span class='kw'>where</span> <span class='self'>Self</span>: <span class='ident'>Sized</span>, <span class='ident'>F</span>: <span class='ident'>FnMut</span>(<span class='kw-2'>&amp;</span><span class='self'>Self</span>::<span class='ident'>Item</span>) { <span class='comment'>/* ... */</span> }
}<a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=fn%20main()%20%7B%0Apub%20trait%20Iterator%20%7B%0A%20%20%20%20fn%20inspect%3CF%3E(self%2C%20f%3A%20F)%20-%3E%20Inspect%3CSelf%2C%20F%3E%0A%20%20%20%20%20%20%20%20where%20Self%3A%20Sized%2C%20F%3A%20FnMut(%26Self%3A%3AItem)%20%7B%20%2F*%20...%20*%2F%20%7D%0A%7D%0A%7D">Run</a></pre>

<p>Creates an adapter inspects the original iterator&#39;s elements with <code>f: F</code>, and passing the value on.</p>

<p>When working with iterators, usually we&#39;d have to do a lot of chaining. This is where inspection gets useful.</p>

<p>Continuing with our last example, we can now add some inspections:</p>

<pre class='rust rust-example-rendered'>
<span class='kw'>let</span> <span class='ident'>words</span> <span class='op'>=</span> [<span class='string'>&quot;alpha&quot;</span>, <span class='string'>&quot;beta&quot;</span>, <span class='string'>&quot;gamma&quot;</span>];
<span class='kw'>let</span> <span class='ident'>count_a</span> <span class='op'>=</span> <span class='ident'>words</span>.<span class='ident'>iter</span>()
    .<span class='ident'>inspect</span>(<span class='op'>|</span><span class='ident'>s</span><span class='op'>|</span> <span class='macro'>println</span><span class='macro'>!</span>(<span class='string'>&quot;before flat mapping: {}&quot;</span>, <span class='ident'>s</span>))
    .<span class='ident'>flat_map</span>(<span class='op'>|</span><span class='ident'>s</span><span class='op'>|</span> <span class='ident'>s</span>.<span class='ident'>chars</span>()) <span class='comment'>// Now a iterator over all characters</span>
    .<span class='ident'>inspect</span>(<span class='op'>|</span><span class='ident'>c</span><span class='op'>|</span> <span class='macro'>println</span><span class='macro'>!</span>(<span class='string'>&quot;before filtering: {}&quot;</span>, <span class='ident'>c</span>))
    .<span class='ident'>filter</span>(<span class='op'>|</span><span class='ident'>c</span><span class='op'>|</span> <span class='kw-2'>*</span><span class='ident'>c</span><span class='op'>==</span><span class='string'>&#39;a&#39;</span>)
    .<span class='ident'>inspect</span>(<span class='op'>|</span><span class='ident'>c</span><span class='op'>|</span> <span class='macro'>println</span><span class='macro'>!</span>(<span class='string'>&quot;after filtering: {}&quot;</span>, <span class='ident'>c</span>))
    .<span class='ident'>count</span>();
<span class='macro'>assert_eq</span><span class='macro'>!</span>(<span class='ident'>count_a</span>, <span class='number'>5</span>);<a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=fn%20main()%20%7B%0Alet%20words%20%3D%20%5B%22alpha%22%2C%20%22beta%22%2C%20%22gamma%22%5D%3B%0Alet%20count_a%20%3D%20words.iter()%0A%20%20%20%20.inspect(%7Cs%7C%20println!(%22before%20flat%20mapping%3A%20%7B%7D%22%2C%20s))%0A%20%20%20%20.flat_map(%7Cs%7C%20s.chars())%20%2F%2F%20Now%20a%20iterator%20over%20all%20characters%0A%20%20%20%20.inspect(%7Cc%7C%20println!(%22before%20filtering%3A%20%7B%7D%22%2C%20c))%0A%20%20%20%20.filter(%7Cc%7C%20*c%3D%3D'a')%0A%20%20%20%20.inspect(%7Cc%7C%20println!(%22after%20filtering%3A%20%7B%7D%22%2C%20c))%0A%20%20%20%20.count()%3B%0Aassert_eq!(count_a%2C%205)%3B%0A%7D">Run</a></pre>

<hr>

<pre class='rust rust-example-rendered'>
<span class='kw'>pub</span> <span class='kw'>trait</span> <span class='ident'>Iterator</span> {
    <span class='kw'>fn</span> <span class='ident'>by_ref</span>(<span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='self'>self</span>) <span class='op'>-&gt;</span> <span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='self'>Self</span> { <span class='comment'>/* ... */</span> }
}<a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=fn%20main()%20%7B%0Apub%20trait%20Iterator%20%7B%0A%20%20%20%20fn%20by_ref(%26mut%20self)%20-%3E%20%26mut%20Self%20%7B%20%2F*%20...%20*%2F%20%7D%0A%7D%0A%7D">Run</a></pre>

<p>Borrows the iterator by <strong>mutable</strong> reference. Note that naming convention of rust methods is violated here. This method is useful with adapter chaining, when we don&#39;t want the original iterator to be consumed.</p>

<hr>

<pre class='rust rust-example-rendered'>
<span class='kw'>pub</span> <span class='kw'>trait</span> <span class='ident'>Iterator</span> {
    <span class='kw'>fn</span> <span class='ident'>collect</span><span class='op'>&lt;</span><span class='ident'>B</span><span class='op'>&gt;</span>(<span class='self'>self</span>) <span class='op'>-&gt;</span> <span class='ident'>B</span> <span class='kw'>where</span> <span class='ident'>B</span>: <span class='ident'>FromIterator</span> { <span class='comment'>/* ... */</span> }
}<a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=fn%20main()%20%7B%0Apub%20trait%20Iterator%20%7B%0A%20%20%20%20fn%20collect%3CB%3E(self)%20-%3E%20B%20where%20B%3A%20FromIterator%20%7B%20%2F*%20...%20*%2F%20%7D%0A%7D%0A%7D">Run</a></pre>

<p>Collects all the items of the iterator into a <code>B: FromIterator</code>. Such a <code>B</code> is often some sort of collections:</p>

<pre class='rust rust-example-rendered'>
<span class='kw'>pub</span> <span class='kw'>trait</span> <span class='ident'>FromIterator</span><span class='op'>&lt;</span><span class='ident'>A</span><span class='op'>&gt;</span> {
    <span class='kw'>fn</span> <span class='ident'>from_iter</span><span class='op'>&lt;</span><span class='ident'>T</span><span class='op'>&gt;</span>(<span class='ident'>iter</span>: <span class='ident'>T</span>) <span class='op'>-&gt;</span> <span class='self'>Self</span>
        <span class='kw'>where</span> <span class='ident'>T</span>: <span class='ident'>IntoIterator</span><span class='op'>&lt;</span><span class='ident'>Item</span><span class='op'>=</span><span class='ident'>A</span><span class='op'>&gt;</span>;
}<a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=fn%20main()%20%7B%0Apub%20trait%20FromIterator%3CA%3E%20%7B%0A%20%20%20%20fn%20from_iter%3CT%3E(iter%3A%20T)%20-%3E%20Self%0A%20%20%20%20%20%20%20%20where%20T%3A%20IntoIterator%3CItem%3DA%3E%3B%0A%7D%0A%7D">Run</a></pre>

<hr>

<pre class='rust rust-example-rendered'>
<span class='kw'>pub</span> <span class='kw'>trait</span> <span class='ident'>Iterator</span> {
    <span class='kw'>fn</span> <span class='ident'>partition</span><span class='op'>&lt;</span><span class='ident'>B</span>, <span class='ident'>F</span><span class='op'>&gt;</span>(<span class='self'>self</span>, <span class='kw-2'>mut</span> <span class='ident'>f</span>: <span class='ident'>F</span>) <span class='op'>-&gt;</span> (<span class='ident'>B</span>, <span class='ident'>B</span>)
        <span class='kw'>where</span> <span class='self'>Self</span>: <span class='ident'>Sized</span>,
              <span class='ident'>B</span>: <span class='ident'>Default</span> <span class='op'>+</span> <span class='ident'>Extend</span><span class='op'>&lt;</span><span class='self'>Self</span>::<span class='ident'>Item</span><span class='op'>&gt;</span>,
              <span class='ident'>F</span>: <span class='ident'>FnMut</span>(<span class='kw-2'>&amp;</span><span class='self'>Self</span>::<span class='ident'>Item</span>) <span class='op'>-&gt;</span> <span class='ident'>bool</span>
    {
        <span class='kw'>let</span> <span class='kw-2'>mut</span> <span class='ident'>left</span>: <span class='ident'>B</span> <span class='op'>=</span> <span class='ident'>Default</span>::<span class='ident'>default</span>();
        <span class='kw'>let</span> <span class='kw-2'>mut</span> <span class='ident'>right</span>: <span class='ident'>B</span> <span class='op'>=</span> <span class='ident'>Default</span>::<span class='ident'>default</span>();
        <span class='kw'>for</span> <span class='ident'>x</span> <span class='kw'>in</span> <span class='self'>self</span> {
            <span class='kw'>if</span> <span class='ident'>f</span>(<span class='kw-2'>&amp;</span><span class='ident'>x</span>) {
                <span class='kw'>let</span>.<span class='ident'>extend</span>(<span class='prelude-val'>Some</span>(<span class='ident'>x</span>))
            } <span class='kw'>else</span> {
                <span class='ident'>right</span>.<span class='ident'>extend</span>(<span class='prelude-val'>Some</span>(<span class='ident'>x</span>))
            }
        }
        (<span class='ident'>left</span>, <span class='ident'>right</span>)
    }
}<a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=fn%20main()%20%7B%0Apub%20trait%20Iterator%20%7B%0A%20%20%20%20fn%20partition%3CB%2C%20F%3E(self%2C%20mut%20f%3A%20F)%20-%3E%20(B%2C%20B)%0A%20%20%20%20%20%20%20%20where%20Self%3A%20Sized%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20B%3A%20Default%20%2B%20Extend%3CSelf%3A%3AItem%3E%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20F%3A%20FnMut(%26Self%3A%3AItem)%20-%3E%20bool%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20let%20mut%20left%3A%20B%20%3D%20Default%3A%3Adefault()%3B%0A%20%20%20%20%20%20%20%20let%20mut%20right%3A%20B%20%3D%20Default%3A%3Adefault()%3B%0A%20%20%20%20%20%20%20%20for%20x%20in%20self%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20f(%26x)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20let.extend(Some(x))%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20right.extend(Some(x))%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20(left%2C%20right)%0A%20%20%20%20%7D%0A%7D%0A%7D">Run</a></pre>

<p>Consumes the iterator, and creates two collections from it according to the given predicate.</p>

<p>The collection type should be <code>Default</code> constructible, and <code>Extend</code>able over the item type.</p>

<hr>

<pre class='rust rust-example-rendered'>
<span class='kw'>pub</span> <span class='kw'>trait</span> <span class='ident'>Iterator</span> {
    <span class='kw'>fn</span> <span class='ident'>all</span><span class='op'>&lt;</span><span class='ident'>F</span><span class='op'>&gt;</span>(<span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='self'>self</span>, <span class='kw-2'>mut</span> <span class='ident'>f</span>: <span class='ident'>F</span>) <span class='op'>-&gt;</span> <span class='ident'>bool</span>
        <span class='kw'>where</span> <span class='self'>Self</span>: <span class='ident'>Sized</span>, <span class='comment'>// for taking by value</span>
              <span class='ident'>F</span>: <span class='ident'>FnMut</span>(<span class='self'>Self</span>::<span class='ident'>Item</span>) <span class='op'>-&gt;</span> <span class='ident'>bool</span>
    {
        <span class='kw'>for</span> <span class='ident'>x</span> <span class='kw'>in</span> <span class='self'>self</span> {
            <span class='kw'>if</span> <span class='op'>!</span><span class='ident'>f</span>(<span class='ident'>x</span>) {
                <span class='kw'>return</span> <span class='bool-val'>false</span>;
            }
        }
        <span class='bool-val'>true</span>
    }

    <span class='kw'>fn</span> <span class='ident'>any</span><span class='op'>&lt;</span><span class='ident'>F</span><span class='op'>&gt;</span>(<span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='self'>self</span>, <span class='kw-2'>mut</span> <span class='ident'>f</span>: <span class='ident'>F</span>) <span class='op'>-&gt;</span> <span class='ident'>bool</span>
        <span class='kw'>where</span> <span class='self'>Self</span>: <span class='ident'>Sized</span>,
              <span class='ident'>F</span>: <span class='ident'>FmMut</span>(<span class='self'>Self</span>::<span class='ident'>Item</span>) <span class='op'>-&gt;</span> <span class='ident'>bool</span>
    {
        <span class='kw'>for</span> <span class='ident'>x</span> <span class='kw'>in</span> <span class='self'>self</span> {
            <span class='kw'>if</span> <span class='ident'>f</span>(<span class='ident'>x</span>) {
                <span class='kw'>return</span> <span class='bool-val'>true</span>;
            }
        }
        <span class='bool-val'>false</span>
    }
}<a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=fn%20main()%20%7B%0Apub%20trait%20Iterator%20%7B%0A%20%20%20%20fn%20all%3CF%3E(%26mut%20self%2C%20mut%20f%3A%20F)%20-%3E%20bool%0A%20%20%20%20%20%20%20%20where%20Self%3A%20Sized%2C%20%2F%2F%20for%20taking%20by%20value%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20F%3A%20FnMut(Self%3A%3AItem)%20-%3E%20bool%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20for%20x%20in%20self%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20!f(x)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20false%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20true%0A%20%20%20%20%7D%0A%0A%20%20%20%20fn%20any%3CF%3E(%26mut%20self%2C%20mut%20f%3A%20F)%20-%3E%20bool%0A%20%20%20%20%20%20%20%20where%20Self%3A%20Sized%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20F%3A%20FmMut(Self%3A%3AItem)%20-%3E%20bool%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20for%20x%20in%20self%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20f(x)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20true%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20false%0A%20%20%20%20%7D%0A%7D%0A%7D">Run</a></pre>

<p>These two are straightforward.</p>

<hr>

<pre class='rust rust-example-rendered'>
<span class='kw'>pub</span> <span class='kw'>trait</span> <span class='ident'>Iterator</span> {
    <span class='kw'>fn</span> <span class='ident'>find</span><span class='op'>&lt;</span><span class='ident'>F</span><span class='op'>&gt;</span>(<span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='self'>self</span>, <span class='kw-2'>mut</span> <span class='ident'>f</span>: <span class='ident'>F</span>) <span class='op'>-&gt;</span> <span class='prelude-ty'>Option</span><span class='op'>&lt;</span><span class='self'>Self</span>::<span class='ident'>Item</span><span class='op'>&gt;</span>
        <span class='kw'>where</span> <span class='self'>Self</span>: <span class='ident'>Sized</span>,
              <span class='ident'>P</span>: <span class='ident'>FnMut</span>(<span class='kw-2'>&amp;</span><span class='self'>Self</span>::<span class='ident'>Item</span>) <span class='op'>-&gt;</span> <span class='ident'>bool</span>
    {
        <span class='kw'>for</span> <span class='ident'>x</span> <span class='kw'>in</span> <span class='self'>self</span> {
            <span class='kw'>if</span> <span class='ident'>f</span>(<span class='kw-2'>&amp;</span><span class='ident'>x</span>) { <span class='kw'>return</span> <span class='prelude-val'>Some</span>(<span class='ident'>x</span>) }
        }
        <span class='prelude-val'>None</span>
    }
}<a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=fn%20main()%20%7B%0Apub%20trait%20Iterator%20%7B%0A%20%20%20%20fn%20find%3CF%3E(%26mut%20self%2C%20mut%20f%3A%20F)%20-%3E%20Option%3CSelf%3A%3AItem%3E%0A%20%20%20%20%20%20%20%20where%20Self%3A%20Sized%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20P%3A%20FnMut(%26Self%3A%3AItem)%20-%3E%20bool%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20for%20x%20in%20self%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20f(%26x)%20%7B%20return%20Some(x)%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20None%0A%20%20%20%20%7D%0A%7D%0A%7D">Run</a></pre>

<p>Returns the first item matching the predicate, if any.</p>

<hr>

<pre class='rust rust-example-rendered'>
<span class='kw'>pub</span> <span class='kw'>trait</span> <span class='ident'>Iterator</span> {
    <span class='kw'>fn</span> <span class='ident'>position</span><span class='op'>&lt;</span><span class='ident'>P</span><span class='op'>&gt;</span>(<span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='self'>self</span>, <span class='kw-2'>mut</span> <span class='ident'>predicate</span>: <span class='ident'>P</span>) <span class='op'>-&gt;</span> <span class='prelude-ty'>Option</span><span class='op'>&lt;</span><span class='ident'>usize</span><span class='op'>&gt;</span>
        <span class='kw'>where</span> <span class='self'>Self</span>: <span class='ident'>Sized</span>,
              <span class='ident'>P</span>: <span class='ident'>FnMut</span>(<span class='self'>Self</span>::<span class='ident'>Item</span>) <span class='op'>-&gt;</span> <span class='ident'>bool</span>,
    {
        <span class='comment'>// `enumerate` might overflow.</span>
        <span class='kw'>for</span> (<span class='ident'>i</span>, <span class='ident'>x</span>) <span class='kw'>in</span> <span class='self'>self</span>.<span class='ident'>enumerate</span>() {
            <span class='kw'>if</span> <span class='ident'>predicate</span>(<span class='ident'>x</span>) {
                <span class='kw'>return</span> <span class='prelude-val'>Some</span>(<span class='ident'>i</span>);
            }
        }
        <span class='prelude-val'>None</span>
    }
}<a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=fn%20main()%20%7B%0Apub%20trait%20Iterator%20%7B%0A%20%20%20%20fn%20position%3CP%3E(%26mut%20self%2C%20mut%20predicate%3A%20P)%20-%3E%20Option%3Cusize%3E%0A%20%20%20%20%20%20%20%20where%20Self%3A%20Sized%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20P%3A%20FnMut(Self%3A%3AItem)%20-%3E%20bool%2C%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%2F%2F%20%60enumerate%60%20might%20overflow.%0A%20%20%20%20%20%20%20%20for%20(i%2C%20x)%20in%20self.enumerate()%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20predicate(x)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20Some(i)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20None%0A%20%20%20%20%7D%0A%7D%0A%7D">Run</a></pre>

<p>Returns the index ( from the current position) of the first item matching the predicate. Now that this predicate consumes items by value, unlike the one used by <code>find</code>.</p>

<hr>

<p>For <code>ExactSizedIterator</code> and <code>DoubleEndedIterator</code>, we also have:</p>

<pre class='rust rust-example-rendered'>
<span class='kw'>pub</span> <span class='kw'>trait</span> <span class='ident'>Iterator</span> {
    <span class='kw'>fn</span> <span class='ident'>rposition</span><span class='op'>&lt;</span><span class='ident'>P</span><span class='op'>&gt;</span>(<span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='self'>self</span>, <span class='kw-2'>mut</span> <span class='ident'>predicate</span>: <span class='ident'>P</span>) <span class='op'>-&gt;</span> <span class='prelude-ty'>Option</span><span class='op'>&lt;</span><span class='ident'>usize</span><span class='op'>&gt;</span>
        <span class='kw'>where</span> <span class='ident'>P</span>: <span class='ident'>FnMut</span>(<span class='self'>Self</span>::<span class='ident'>Item</span>) <span class='op'>-&gt;</span> <span class='ident'>bool</span>,
              <span class='self'>Self</span>: <span class='ident'>Sized</span> <span class='op'>+</span> <span class='ident'>ExactSizeIterator</span> <span class='op'>+</span> <span class='ident'>DoubleEndedIterator</span>
    {
        <span class='kw'>let</span> <span class='kw-2'>mut</span> <span class='ident'>i</span> <span class='op'>=</span> <span class='self'>self</span>.<span class='ident'>len</span>();

        <span class='kw'>while</span> <span class='kw'>let</span> <span class='prelude-val'>Some</span>(<span class='ident'>v</span>) <span class='op'>=</span> <span class='self'>self</span>.<span class='ident'>next_back</span>() {
            <span class='kw'>if</span> <span class='ident'>predicate</span>(<span class='ident'>v</span>) {
                <span class='kw'>return</span> <span class='prelude-val'>Some</span>(<span class='ident'>i</span> <span class='op'>-</span> <span class='number'>1</span>);
            }
            <span class='comment'>// No need for an overflow check here, because `ExactSizeIterator`</span>
            <span class='comment'>// implies that the number of elements fits into a `usize`.</span>
            <span class='ident'>i</span> <span class='op'>-=</span> <span class='number'>1</span>;
        }
        <span class='prelude-val'>None</span>
    }
}<a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=fn%20main()%20%7B%0Apub%20trait%20Iterator%20%7B%0A%20%20%20%20fn%20rposition%3CP%3E(%26mut%20self%2C%20mut%20predicate%3A%20P)%20-%3E%20Option%3Cusize%3E%0A%20%20%20%20%20%20%20%20where%20P%3A%20FnMut(Self%3A%3AItem)%20-%3E%20bool%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20Self%3A%20Sized%20%2B%20ExactSizeIterator%20%2B%20DoubleEndedIterator%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20let%20mut%20i%20%3D%20self.len()%3B%0A%0A%20%20%20%20%20%20%20%20while%20let%20Some(v)%20%3D%20self.next_back()%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20predicate(v)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20Some(i%20-%201)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20No%20need%20for%20an%20overflow%20check%20here%2C%20because%20%60ExactSizeIterator%60%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20implies%20that%20the%20number%20of%20elements%20fits%20into%20a%20%60usize%60.%0A%20%20%20%20%20%20%20%20%20%20%20%20i%20-%3D%201%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20None%0A%20%20%20%20%7D%0A%7D%0A%7D">Run</a></pre>

<hr>

<p>For ordered item types, we have:</p>

<pre class='rust rust-example-rendered'>
<span class='kw'>pub</span> <span class='kw'>trait</span> <span class='ident'>Iterator</span> {
    <span class='kw'>fn</span> <span class='ident'>max</span>(<span class='self'>self</span>) <span class='op'>-&gt;</span> <span class='prelude-ty'>Option</span><span class='op'>&lt;</span><span class='self'>Self</span>::<span class='ident'>Item</span><span class='op'>&gt;</span>
        <span class='kw'>where</span> <span class='self'>Self</span>: <span class='ident'>Sized</span>,
              <span class='self'>Self</span>::<span class='ident'>Item</span>: <span class='ident'>Ord</span>
    {
        <span class='comment'>// ...</span>
    }

    <span class='kw'>fn</span> <span class='ident'>min</span>(<span class='self'>self</span>) <span class='op'>-&gt;</span> <span class='prelude-ty'>Option</span><span class='op'>&lt;</span><span class='self'>Self</span>::<span class='ident'>Item</span><span class='op'>&gt;</span>
        <span class='kw'>where</span> <span class='self'>Self</span>: <span class='ident'>Sized</span>,
              <span class='self'>Self</span>::<span class='ident'>Item</span>: <span class='ident'>Ord</span>
    {
        <span class='comment'>// ...</span>
    }
}<a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=fn%20main()%20%7B%0Apub%20trait%20Iterator%20%7B%0A%20%20%20%20fn%20max(self)%20-%3E%20Option%3CSelf%3A%3AItem%3E%0A%20%20%20%20%20%20%20%20where%20Self%3A%20Sized%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20Self%3A%3AItem%3A%20Ord%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%2F%2F%20...%0A%20%20%20%20%7D%0A%0A%20%20%20%20fn%20min(self)%20-%3E%20Option%3CSelf%3A%3AItem%3E%0A%20%20%20%20%20%20%20%20where%20Self%3A%20Sized%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20Self%3A%3AItem%3A%20Ord%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%2F%2F%20...%0A%20%20%20%20%7D%0A%7D%0A%7D">Run</a></pre>

<p>These functions returns the value closest to the current position of the iterator, among equally <code>max</code>/<code>min</code>s.</p>

<p>Additionally, we have:</p>

<pre class='rust rust-example-rendered'>
<span class='kw'>pub</span> <span class='kw'>trait</span> <span class='ident'>Iterator</span> {
    <span class='kw'>fn</span> <span class='ident'>max_by_key</span><span class='op'>&lt;</span><span class='ident'>B</span>, <span class='ident'>F</span><span class='op'>&gt;</span>(<span class='self'>self</span>, <span class='ident'>f</span>: <span class='ident'>F</span>) <span class='op'>-&gt;</span> <span class='prelude-ty'>Option</span><span class='op'>&lt;</span><span class='self'>Self</span>::<span class='ident'>Item</span><span class='op'>&gt;</span>
        <span class='kw'>where</span> <span class='ident'>B</span>: <span class='ident'>Ord</span>,
              <span class='ident'>F</span>: <span class='ident'>FnMut</span>(<span class='kw-2'>&amp;</span><span class='self'>Self</span>::<span class='ident'>Item</span>) <span class='op'>-&gt;</span> <span class='ident'>B</span> { ... }
    <span class='kw'>fn</span> <span class='ident'>max_by</span><span class='op'>&lt;</span><span class='ident'>F</span><span class='op'>&gt;</span>(<span class='self'>self</span>, <span class='ident'>compare</span>: <span class='ident'>F</span>) <span class='op'>-&gt;</span> <span class='prelude-ty'>Option</span><span class='op'>&lt;</span><span class='self'>Self</span>::<span class='ident'>Item</span><span class='op'>&gt;</span> <span class='kw'>where</span> <span class='ident'>F</span>: <span class='ident'>FnMut</span>(<span class='kw-2'>&amp;</span><span class='self'>Self</span>::<span class='ident'>Item</span>, <span class='kw-2'>&amp;</span><span class='self'>Self</span>::<span class='ident'>Item</span>) <span class='op'>-&gt;</span> <span class='ident'>Ordering</span> { ... }
    <span class='kw'>fn</span> <span class='ident'>min_by_key</span><span class='op'>&lt;</span><span class='ident'>B</span>, <span class='ident'>F</span><span class='op'>&gt;</span>(<span class='self'>self</span>, <span class='ident'>f</span>: <span class='ident'>F</span>) <span class='op'>-&gt;</span> <span class='prelude-ty'>Option</span><span class='op'>&lt;</span><span class='self'>Self</span>::<span class='ident'>Item</span><span class='op'>&gt;</span> <span class='kw'>where</span> <span class='ident'>B</span>: <span class='ident'>Ord</span>, <span class='ident'>F</span>: <span class='ident'>FnMut</span>(<span class='kw-2'>&amp;</span><span class='self'>Self</span>::<span class='ident'>Item</span>) <span class='op'>-&gt;</span> <span class='ident'>B</span> { ... }
    <span class='kw'>fn</span> <span class='ident'>min_by</span><span class='op'>&lt;</span><span class='ident'>F</span><span class='op'>&gt;</span>(<span class='self'>self</span>, <span class='ident'>compare</span>: <span class='ident'>F</span>) <span class='op'>-&gt;</span> <span class='prelude-ty'>Option</span><span class='op'>&lt;</span><span class='self'>Self</span>::<span class='ident'>Item</span><span class='op'>&gt;</span> <span class='kw'>where</span> <span class='ident'>F</span>: <span class='ident'>FnMut</span>(<span class='kw-2'>&amp;</span><span class='self'>Self</span>::<span class='ident'>Item</span>, <span class='kw-2'>&amp;</span><span class='self'>Self</span>::<span class='ident'>Item</span>) <span class='op'>-&gt;</span> <span class='ident'>Ordering</span> { ... }
}<a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=fn%20main()%20%7B%0Apub%20trait%20Iterator%20%7B%0A%20%20%20%20fn%20max_by_key%3CB%2C%20F%3E(self%2C%20f%3A%20F)%20-%3E%20Option%3CSelf%3A%3AItem%3E%0A%20%20%20%20%20%20%20%20where%20B%3A%20Ord%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20F%3A%20FnMut(%26Self%3A%3AItem)%20-%3E%20B%20%7B%20...%20%7D%0A%20%20%20%20fn%20max_by%3CF%3E(self%2C%20compare%3A%20F)%20-%3E%20Option%3CSelf%3A%3AItem%3E%20where%20F%3A%20FnMut(%26Self%3A%3AItem%2C%20%26Self%3A%3AItem)%20-%3E%20Ordering%20%7B%20...%20%7D%0A%20%20%20%20fn%20min_by_key%3CB%2C%20F%3E(self%2C%20f%3A%20F)%20-%3E%20Option%3CSelf%3A%3AItem%3E%20where%20B%3A%20Ord%2C%20F%3A%20FnMut(%26Self%3A%3AItem)%20-%3E%20B%20%7B%20...%20%7D%0A%20%20%20%20fn%20min_by%3CF%3E(self%2C%20compare%3A%20F)%20-%3E%20Option%3CSelf%3A%3AItem%3E%20where%20F%3A%20FnMut(%26Self%3A%3AItem%2C%20%26Self%3A%3AItem)%20-%3E%20Ordering%20%7B%20...%20%7D%0A%7D%0A%7D">Run</a></pre>

<p>that can cooperate with customized ordering functions.</p>

<hr>

<p>For <code>DoubleEndedIterator</code>s, we have a reverse adapter:</p>

<pre class='rust rust-example-rendered'>
<span class='kw'>pub</span> <span class='kw'>trait</span> <span class='ident'>Iterator</span> {
    <span class='kw'>fn</span> <span class='ident'>rev</span>(<span class='self'>self</span>) <span class='op'>-&gt;</span> <span class='ident'>Rev</span><span class='op'>&lt;</span><span class='self'>Self</span><span class='op'>&gt;</span>
        <span class='kw'>where</span> <span class='self'>Self</span>: <span class='ident'>Sized</span> <span class='op'>+</span> <span class='ident'>DoubleEndedIterator</span>
    { <span class='ident'>Rev</span> {<span class='ident'>iter</span>: <span class='self'>self</span>} }
}<a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=fn%20main()%20%7B%0Apub%20trait%20Iterator%20%7B%0A%20%20%20%20fn%20rev(self)%20-%3E%20Rev%3CSelf%3E%0A%20%20%20%20%20%20%20%20where%20Self%3A%20Sized%20%2B%20DoubleEndedIterator%0A%20%20%20%20%7B%20Rev%20%7Biter%3A%20self%7D%20%7D%0A%7D%0A%7D">Run</a></pre>

<hr>

<p>For a &quot;zipped&quot; iterator, we can unzip them into separate collections:</p>

<pre class='rust rust-example-rendered'>
<span class='kw'>pub</span> <span class='kw'>trait</span> <span class='ident'>Iterator</span> {
    <span class='kw'>fn</span> <span class='ident'>uzip</span><span class='op'>&lt;</span><span class='ident'>A</span>, <span class='ident'>B</span>, <span class='ident'>FromA</span>, <span class='ident'>FromB</span><span class='op'>&gt;</span>(<span class='self'>self</span>) <span class='op'>-&gt;</span> (<span class='ident'>FromA</span>, <span class='ident'>FromB</span>)
        <span class='kw'>where</span> <span class='ident'>FromA</span>: <span class='ident'>Default</span> <span class='op'>+</span> <span class='ident'>Extend</span><span class='op'>&lt;</span><span class='ident'>A</span><span class='op'>&gt;</span>,
              <span class='ident'>FromB</span>: <span class='ident'>Default</span> <span class='op'>+</span> <span class='ident'>Extend</span><span class='op'>&lt;</span><span class='ident'>B</span><span class='op'>&gt;</span>,
              <span class='self'>Self</span>: <span class='ident'>Sized</span> <span class='op'>+</span> <span class='ident'>Iterator</span><span class='op'>&lt;</span><span class='ident'>Item</span><span class='op'>=</span>(<span class='ident'>A</span>, <span class='ident'>B</span>)<span class='op'>&gt;</span>,
    {
        <span class='kw'>let</span> <span class='kw-2'>mut</span> <span class='kw'>as</span>: <span class='ident'>FromA</span> <span class='op'>=</span> <span class='ident'>Default</span>::<span class='ident'>default</span>();
        <span class='kw'>let</span> <span class='kw-2'>mut</span> <span class='ident'>bs</span>: <span class='ident'>FromB</span> <span class='op'>=</span> <span class='ident'>Default</span>::<span class='ident'>default</span>();

        <span class='kw'>for</span>(<span class='ident'>a</span>, <span class='ident'>b</span>) <span class='kw'>in</span> <span class='self'>self</span> {
            <span class='kw'>as</span>.<span class='ident'>extend</span>(<span class='prelude-val'>Some</span>(<span class='ident'>a</span>)); <span class='comment'>// pattern matching here</span>
            <span class='ident'>bs</span>.<span class='ident'>extend</span>(<span class='prelude-val'>Some</span>(<span class='ident'>b</span>));
        }

        (<span class='kw'>as</span>, <span class='ident'>bs</span>)
    }
}<a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=fn%20main()%20%7B%0Apub%20trait%20Iterator%20%7B%0A%20%20%20%20fn%20uzip%3CA%2C%20B%2C%20FromA%2C%20FromB%3E(self)%20-%3E%20(FromA%2C%20FromB)%0A%20%20%20%20%20%20%20%20where%20FromA%3A%20Default%20%2B%20Extend%3CA%3E%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20FromB%3A%20Default%20%2B%20Extend%3CB%3E%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20Self%3A%20Sized%20%2B%20Iterator%3CItem%3D(A%2C%20B)%3E%2C%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20let%20mut%20as%3A%20FromA%20%3D%20Default%3A%3Adefault()%3B%0A%20%20%20%20%20%20%20%20let%20mut%20bs%3A%20FromB%20%3D%20Default%3A%3Adefault()%3B%0A%0A%20%20%20%20%20%20%20%20for(a%2C%20b)%20in%20self%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20as.extend(Some(a))%3B%20%2F%2F%20pattern%20matching%20here%0A%20%20%20%20%20%20%20%20%20%20%20%20bs.extend(Some(b))%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20(as%2C%20bs)%0A%20%20%20%20%7D%0A%7D%0A%7D">Run</a></pre>

<hr>

<p>For an iterator that operates on some <code>&amp; T</code>, where <code>T: Clone</code>, we have an adapter yielding each of its item <code>clone</code>d:</p>

<pre class='rust rust-example-rendered'>
<span class='kw'>fn</span> <span class='ident'>cloned</span><span class='op'>&lt;</span><span class='lifetime'>&#39;a</span>, <span class='ident'>T</span><span class='op'>&gt;</span>(<span class='self'>self</span>) <span class='op'>-&gt;</span> <span class='ident'>Cloned</span><span class='op'>&lt;</span><span class='self'>Self</span><span class='op'>&gt;</span>
    <span class='kw'>where</span> <span class='self'>Self</span>: <span class='ident'>Sized</span> <span class='op'>+</span> <span class='ident'>Iterator</span><span class='op'>&lt;</span><span class='ident'>Item</span><span class='op'>=</span><span class='kw-2'>&amp;</span><span class='lifetime'>&#39;a</span> <span class='ident'>T</span><span class='op'>&gt;</span>,
          <span class='ident'>T</span>: <span class='ident'>Clone</span>
{
    <span class='ident'>Cloned</span> { <span class='ident'>it</span>: <span class='self'>self</span> }
}<a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=fn%20main()%20%7B%0Afn%20cloned%3C'a%2C%20T%3E(self)%20-%3E%20Cloned%3CSelf%3E%0A%20%20%20%20where%20Self%3A%20Sized%20%2B%20Iterator%3CItem%3D%26'a%20T%3E%2C%0A%20%20%20%20%20%20%20%20%20%20T%3A%20Clone%0A%7B%0A%20%20%20%20Cloned%20%7B%20it%3A%20self%20%7D%0A%7D%0A%7D">Run</a></pre>

<p>The returned adapter is defined as</p>

<pre class='rust rust-example-rendered'>
<span class='kw'>pub</span> <span class='kw'>struct</span> <span class='ident'>Cloned</span><span class='op'>&lt;</span><span class='ident'>T</span><span class='op'>&gt;</span> {
    <span class='ident'>it</span>: <span class='ident'>I</span>,
}

<span class='kw'>impl</span><span class='op'>&lt;</span><span class='lifetime'>&#39;a</span>, <span class='ident'>I</span>, <span class='ident'>T</span><span class='op'>&gt;</span> <span class='ident'>Iterator</span> <span class='kw'>for</span> <span class='ident'>Cloned</span><span class='op'>&lt;</span><span class='ident'>T</span><span class='op'>&gt;</span>
    <span class='kw'>where</span> <span class='ident'>I</span>: <span class='ident'>Iterator</span><span class='op'>&lt;</span><span class='ident'>Item</span><span class='op'>=</span><span class='kw-2'>&amp;</span><span class='lifetime'>&#39;a</span> <span class='ident'>T</span><span class='op'>&gt;</span>,
          <span class='ident'>T</span>: <span class='lifetime'>&#39;a</span> <span class='op'>+</span> <span class='ident'>Clone</span>
{
    <span class='kw'>type</span> <span class='ident'>Item</span> <span class='op'>=</span> <span class='ident'>T</span>;

    <span class='kw'>fn</span> <span class='ident'>next</span>(<span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='self'>self</span>) <span class='op'>-&gt;</span> <span class='prelude-ty'>Option</span><span class='op'>&lt;</span><span class='ident'>T</span><span class='op'>&gt;</span> {
        <span class='self'>self</span>.<span class='ident'>it</span>.<span class='ident'>next</span>().<span class='ident'>cloned</span>()
    }
     <span class='kw'>fn</span> <span class='ident'>size_hint</span>(<span class='kw-2'>&amp;</span><span class='self'>self</span>) <span class='op'>-&gt;</span> (<span class='ident'>usize</span>, <span class='prelude-ty'>Option</span><span class='op'>&lt;</span><span class='ident'>usize</span><span class='op'>&gt;</span>) {
         <span class='self'>self</span>.<span class='ident'>it</span>.<span class='ident'>size_hint</span>()
     }

     <span class='kw'>fn</span> <span class='ident'>fold</span><span class='op'>&lt;</span><span class='ident'>Acc</span>, <span class='ident'>F</span><span class='op'>&gt;</span>(<span class='self'>self</span>, <span class='ident'>init</span>: <span class='ident'>Acc</span>, <span class='kw-2'>mut</span> <span class='ident'>f</span>: <span class='ident'>F</span>) <span class='op'>-&gt;</span> <span class='ident'>Acc</span>
        <span class='kw'>where</span> <span class='ident'>F</span>: <span class='ident'>FnMut</span>(<span class='ident'>Acc</span>, <span class='self'>Self</span>::<span class='ident'>Item</span>) <span class='op'>-&gt;</span> <span class='ident'>Acc</span>
    {
        <span class='self'>self</span>.<span class='ident'>it</span>.<span class='ident'>fold</span>(<span class='ident'>init</span>, <span class='kw'>move</span> <span class='op'>|</span><span class='ident'>acc</span>, <span class='ident'>elt</span><span class='op'>|</span> <span class='ident'>f</span>(<span class='ident'>acc</span>, <span class='ident'>elt</span>.<span class='ident'>clone</span>()))
    }
}<a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=fn%20main()%20%7B%0Apub%20struct%20Cloned%3CT%3E%20%7B%0A%20%20%20%20it%3A%20I%2C%0A%7D%0A%0Aimpl%3C'a%2C%20I%2C%20T%3E%20Iterator%20for%20Cloned%3CT%3E%0A%20%20%20%20where%20I%3A%20Iterator%3CItem%3D%26'a%20T%3E%2C%0A%20%20%20%20%20%20%20%20%20%20T%3A%20'a%20%2B%20Clone%0A%7B%0A%20%20%20%20type%20Item%20%3D%20T%3B%0A%0A%20%20%20%20fn%20next(%26mut%20self)%20-%3E%20Option%3CT%3E%20%7B%0A%20%20%20%20%20%20%20%20self.it.next().cloned()%0A%20%20%20%20%7D%0A%20%20%20%20%20fn%20size_hint(%26self)%20-%3E%20(usize%2C%20Option%3Cusize%3E)%20%7B%0A%20%20%20%20%20%20%20%20%20self.it.size_hint()%0A%20%20%20%20%20%7D%0A%0A%20%20%20%20%20fn%20fold%3CAcc%2C%20F%3E(self%2C%20init%3A%20Acc%2C%20mut%20f%3A%20F)%20-%3E%20Acc%0A%20%20%20%20%20%20%20%20where%20F%3A%20FnMut(Acc%2C%20Self%3A%3AItem)%20-%3E%20Acc%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20self.it.fold(init%2C%20move%20%7Cacc%2C%20elt%7C%20f(acc%2C%20elt.clone()))%0A%20%20%20%20%7D%0A%7D%0A%7D">Run</a></pre>

<p>Note that the adapter has a customized version of <code>fold</code> implemented. This can be considered as an optimization, because when calling <code>fold</code> we presumes that we don&#39;t care about the intermediate items. However, this also means that if the <code>clone</code> method of <code>Item</code> has any kind of side-effects, they won&#39;t appear either (as one would reasonably assume) when calling <code>fold</code>.</p>

<hr>

<pre class='rust rust-example-rendered'>
<span class='kw'>pub</span> <span class='kw'>trait</span> <span class='ident'>Iterator</span> {
    <span class='kw'>fn</span> <span class='ident'>cycle</span>(<span class='self'>self</span>) <span class='op'>-&gt;</span> <span class='ident'>Cycle</span><span class='op'>&lt;</span><span class='self'>Self</span><span class='op'>&gt;</span> <span class='kw'>where</span> <span class='self'>Self</span>: <span class='ident'>Sized</span> <span class='op'>+</span> <span class='ident'>Clone</span> {
        <span class='ident'>Cycle</span>{<span class='ident'>orig</span>: <span class='self'>self</span>.<span class='ident'>clone</span>(), <span class='ident'>iter</span>: <span class='self'>self</span>}
    }
}<a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=fn%20main()%20%7B%0Apub%20trait%20Iterator%20%7B%0A%20%20%20%20fn%20cycle(self)%20-%3E%20Cycle%3CSelf%3E%20where%20Self%3A%20Sized%20%2B%20Clone%20%7B%0A%20%20%20%20%20%20%20%20Cycle%7Borig%3A%20self.clone()%2C%20iter%3A%20self%7D%0A%20%20%20%20%7D%0A%7D%0A%7D">Run</a></pre>

<p>Creates an adapter that, upon termination of the original iterator, *cycle*s the iteration process again. Looking into its implementation, we can see that it relies on the original iterator to be <code>Clone</code>able to achieve this.</p>

<pre class='rust rust-example-rendered'>
<span class='kw'>pub</span> <span class='kw'>struct</span> <span class='ident'>Cycle</span><span class='op'>&lt;</span><span class='ident'>I</span><span class='op'>&gt;</span> {
    <span class='ident'>orig</span>: <span class='ident'>I</span>,
    <span class='ident'>iter</span>: <span class='ident'>I</span>,
}

<span class='kw'>impl</span><span class='op'>&lt;</span><span class='ident'>I</span><span class='op'>&gt;</span> <span class='ident'>Iterator</span> <span class='kw'>for</span> <span class='ident'>Cycle</span><span class='op'>&lt;</span><span class='ident'>I</span><span class='op'>&gt;</span> <span class='kw'>where</span> <span class='ident'>I</span>: <span class='ident'>Clone</span> <span class='op'>+</span> <span class='ident'>Iterator</span> {
    <span class='kw'>type</span> <span class='ident'>Item</span> <span class='op'>=</span> <span class='op'>&lt;</span><span class='ident'>I</span> <span class='kw'>as</span> <span class='ident'>Iterator</span><span class='op'>&gt;</span>::<span class='ident'>Item</span>;

    <span class='attribute'>#[<span class='ident'>inline</span>]</span>
    <span class='kw'>fn</span> <span class='ident'>next</span>(<span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='self'>self</span>) <span class='op'>-&gt;</span> <span class='prelude-ty'>Option</span><span class='op'>&lt;&lt;</span><span class='ident'>I</span> <span class='kw'>as</span> <span class='ident'>Iterator</span><span class='op'>&gt;</span>::<span class='ident'>Item</span><span class='op'>&gt;</span> {
        <span class='kw'>match</span> <span class='self'>self</span>.<span class='ident'>iter</span>.<span class='ident'>next</span>() {
            <span class='prelude-val'>None</span> <span class='op'>=&gt;</span> { <span class='self'>self</span>.<span class='ident'>iter</span> <span class='op'>=</span> <span class='self'>self</span>.<span class='ident'>orig</span>.<span class='ident'>clone</span>(); <span class='self'>self</span>.<span class='ident'>iter</span>.<span class='ident'>next</span>() }
            <span class='ident'>y</span> <span class='op'>=&gt;</span> <span class='ident'>y</span>
        }
    }

    <span class='attribute'>#[<span class='ident'>inline</span>]</span>
    <span class='kw'>fn</span> <span class='ident'>size_hint</span>(<span class='kw-2'>&amp;</span><span class='self'>self</span>) <span class='op'>-&gt;</span> (<span class='ident'>usize</span>, <span class='prelude-ty'>Option</span><span class='op'>&lt;</span><span class='ident'>usize</span><span class='op'>&gt;</span>) {
        <span class='comment'>// the cycle iterator is either empty or infinite</span>
        <span class='kw'>match</span> <span class='self'>self</span>.<span class='ident'>orig</span>.<span class='ident'>size_hint</span>() {
            <span class='ident'>sz</span> @ (<span class='number'>0</span>, <span class='prelude-val'>Some</span>(<span class='number'>0</span>)) <span class='op'>=&gt;</span> <span class='ident'>sz</span>,
            (<span class='number'>0</span>, _) <span class='op'>=&gt;</span> (<span class='number'>0</span>, <span class='prelude-val'>None</span>),
            _ <span class='op'>=&gt;</span> (<span class='ident'>usize</span>::<span class='ident'>MAX</span>, <span class='prelude-val'>None</span>)
        }
    }
}<a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=fn%20main()%20%7B%0Apub%20struct%20Cycle%3CI%3E%20%7B%0A%20%20%20%20orig%3A%20I%2C%0A%20%20%20%20iter%3A%20I%2C%0A%7D%0A%0Aimpl%3CI%3E%20Iterator%20for%20Cycle%3CI%3E%20where%20I%3A%20Clone%20%2B%20Iterator%20%7B%0A%20%20%20%20type%20Item%20%3D%20%3CI%20as%20Iterator%3E%3A%3AItem%3B%0A%0A%20%20%20%20%23%5Binline%5D%0A%20%20%20%20fn%20next(%26mut%20self)%20-%3E%20Option%3C%3CI%20as%20Iterator%3E%3A%3AItem%3E%20%7B%0A%20%20%20%20%20%20%20%20match%20self.iter.next()%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20None%20%3D%3E%20%7B%20self.iter%20%3D%20self.orig.clone()%3B%20self.iter.next()%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20y%20%3D%3E%20y%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%0A%20%20%20%20%23%5Binline%5D%0A%20%20%20%20fn%20size_hint(%26self)%20-%3E%20(usize%2C%20Option%3Cusize%3E)%20%7B%0A%20%20%20%20%20%20%20%20%2F%2F%20the%20cycle%20iterator%20is%20either%20empty%20or%20infinite%0A%20%20%20%20%20%20%20%20match%20self.orig.size_hint()%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20sz%20%40%20(0%2C%20Some(0))%20%3D%3E%20sz%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20(0%2C%20_)%20%3D%3E%20(0%2C%20None)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20_%20%3D%3E%20(usize%3A%3AMAX%2C%20None)%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%7D%0A%7D">Run</a></pre>

<hr>

<p>For summable item types, we have</p>

<pre class='rust rust-example-rendered'>
<span class='kw'>pub</span> <span class='kw'>trait</span> <span class='ident'>Iterator</span> {
    <span class='kw'>fn</span> <span class='ident'>sum</span><span class='op'>&lt;</span><span class='ident'>S</span><span class='op'>&gt;</span>(<span class='self'>self</span>) <span class='op'>-&gt;</span> <span class='ident'>S</span>
        <span class='kw'>where</span> <span class='self'>Self</span>: <span class='ident'>Sized</span>,
              <span class='ident'>S</span>: <span class='ident'>Sum</span><span class='op'>&lt;</span><span class='self'>Self</span>::<span class='ident'>Item</span><span class='op'>&gt;</span>
    {
        <span class='ident'>Sum</span>::<span class='ident'>sum</span>(<span class='self'>self</span>)
    }
}<a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=fn%20main()%20%7B%0Apub%20trait%20Iterator%20%7B%0A%20%20%20%20fn%20sum%3CS%3E(self)%20-%3E%20S%0A%20%20%20%20%20%20%20%20where%20Self%3A%20Sized%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20S%3A%20Sum%3CSelf%3A%3AItem%3E%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20Sum%3A%3Asum(self)%0A%20%20%20%20%7D%0A%7D%0A%7D">Run</a></pre>

<p><code>Sum</code> here is a trait that represents a type that can be created by summing up another type:</p>

<pre class='rust rust-example-rendered'>
<span class='kw'>pub</span> <span class='kw'>trait</span> <span class='ident'>Sum</span><span class='op'>&lt;</span><span class='ident'>A</span> <span class='op'>=</span> <span class='self'>Self</span><span class='op'>&gt;</span> {
    <span class='kw'>fn</span> <span class='ident'>sum</span><span class='op'>&lt;</span><span class='ident'>I</span><span class='op'>&gt;</span>(<span class='ident'>iter</span>: <span class='ident'>I</span>) <span class='op'>-&gt;</span> <span class='self'>Self</span>
        <span class='kw'>where</span> <span class='ident'>I</span>: <span class='ident'>Iterator</span><span class='op'>&lt;</span><span class='ident'>Item</span><span class='op'>=</span><span class='ident'>A</span><span class='op'>&gt;</span>;
}<a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=fn%20main()%20%7B%0Apub%20trait%20Sum%3CA%20%3D%20Self%3E%20%7B%0A%20%20%20%20fn%20sum%3CI%3E(iter%3A%20I)%20-%3E%20Self%0A%20%20%20%20%20%20%20%20where%20I%3A%20Iterator%3CItem%3DA%3E%3B%0A%7D%0A%7D">Run</a></pre>

<p>The required method describes how the summing would be performed.</p>

<p>For built-in numeric types (as well as their <code>Wrapping</code>s) this trait is implemented by <code>libstd</code>.</p>

<hr>

<p>Similarly, we have</p>

<pre class='rust rust-example-rendered'>
<span class='kw'>pub</span> <span class='kw'>trait</span> <span class='ident'>Iterator</span> {
    <span class='kw'>fn</span> <span class='ident'>product</span><span class='op'>&lt;</span><span class='ident'>P</span><span class='op'>&gt;</span>(<span class='self'>self</span>) <span class='op'>-&gt;</span> <span class='ident'>P</span>
        <span class='kw'>where</span> <span class='self'>Self</span>: <span class='ident'>Sized</span>,
              <span class='ident'>P</span>: <span class='ident'>Product</span><span class='op'>&lt;</span><span class='self'>Self</span>::<span class='ident'>Item</span><span class='op'>&gt;</span>,
    {
        <span class='ident'>Product</span>::<span class='ident'>product</span>(<span class='self'>self</span>)
    }
}<a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=fn%20main()%20%7B%0Apub%20trait%20Iterator%20%7B%0A%20%20%20%20fn%20product%3CP%3E(self)%20-%3E%20P%0A%20%20%20%20%20%20%20%20where%20Self%3A%20Sized%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20P%3A%20Product%3CSelf%3A%3AItem%3E%2C%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20Product%3A%3Aproduct(self)%0A%20%20%20%20%7D%0A%7D%0A%7D">Run</a></pre>

<p>where</p>

<pre class='rust rust-example-rendered'>
<span class='kw'>pub</span> <span class='kw'>trait</span> <span class='ident'>Product</span><span class='op'>&lt;</span><span class='ident'>A</span> <span class='op'>=</span> <span class='self'>Self</span><span class='op'>&gt;</span> {
    <span class='kw'>fn</span> <span class='ident'>product</span><span class='op'>&lt;</span><span class='ident'>I</span><span class='op'>&gt;</span>(<span class='ident'>iter</span>: <span class='ident'>I</span>) <span class='op'>-&gt;</span> <span class='self'>Self</span>
        <span class='kw'>where</span> <span class='ident'>I</span>: <span class='ident'>Iterator</span><span class='op'>&lt;</span><span class='ident'>Item</span><span class='op'>=</span><span class='ident'>A</span><span class='op'>&gt;</span>;
}<a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=fn%20main()%20%7B%0Apub%20trait%20Product%3CA%20%3D%20Self%3E%20%7B%0A%20%20%20%20fn%20product%3CI%3E(iter%3A%20I)%20-%3E%20Self%0A%20%20%20%20%20%20%20%20where%20I%3A%20Iterator%3CItem%3DA%3E%3B%0A%7D%0A%7D">Run</a></pre>

<p>to deal with products. The trait is also implemented properly for built-in numeric types.</p>

<hr>

<p>Finally, for comparable item types, we have a bunch of methods to deal with lexicographical comparisons of iterators (actually comparing against their items):</p>

<pre class='rust rust-example-rendered'>
<span class='kw'>pub</span> <span class='kw'>trait</span> <span class='ident'>Iterator</span> {
    <span class='kw'>fn</span> <span class='ident'>cmp</span><span class='op'>&lt;</span><span class='ident'>I</span><span class='op'>&gt;</span>(<span class='self'>self</span>, <span class='ident'>other</span>: <span class='ident'>I</span>) <span class='op'>-&gt;</span> <span class='ident'>Ordering</span> <span class='kw'>where</span> <span class='ident'>I</span>: <span class='ident'>IntoIterator</span><span class='op'>&lt;</span><span class='ident'>Item</span><span class='op'>=</span><span class='self'>Self</span>::<span class='ident'>Item</span><span class='op'>&gt;</span>, <span class='self'>Self</span>::<span class='ident'>Item</span>: <span class='ident'>Ord</span> { ... }
    <span class='kw'>fn</span> <span class='ident'>partial_cmp</span><span class='op'>&lt;</span><span class='ident'>I</span><span class='op'>&gt;</span>(<span class='self'>self</span>, <span class='ident'>other</span>: <span class='ident'>I</span>) <span class='op'>-&gt;</span> <span class='prelude-ty'>Option</span><span class='op'>&lt;</span><span class='ident'>Ordering</span><span class='op'>&gt;</span> <span class='kw'>where</span> <span class='ident'>I</span>: <span class='ident'>IntoIterator</span>, <span class='self'>Self</span>::<span class='ident'>Item</span>: <span class='ident'>PartialOrd</span><span class='op'>&lt;</span><span class='ident'>I</span>::<span class='ident'>Item</span><span class='op'>&gt;</span> { ... }
    <span class='kw'>fn</span> <span class='ident'>eq</span><span class='op'>&lt;</span><span class='ident'>I</span><span class='op'>&gt;</span>(<span class='self'>self</span>, <span class='ident'>other</span>: <span class='ident'>I</span>) <span class='op'>-&gt;</span> <span class='ident'>bool</span> <span class='kw'>where</span> <span class='ident'>I</span>: <span class='ident'>IntoIterator</span>, <span class='self'>Self</span>::<span class='ident'>Item</span>: <span class='ident'>PartialEq</span><span class='op'>&lt;</span><span class='ident'>I</span>::<span class='ident'>Item</span><span class='op'>&gt;</span> { ... }
    <span class='kw'>fn</span> <span class='ident'>ne</span><span class='op'>&lt;</span><span class='ident'>I</span><span class='op'>&gt;</span>(<span class='self'>self</span>, <span class='ident'>other</span>: <span class='ident'>I</span>) <span class='op'>-&gt;</span> <span class='ident'>bool</span> <span class='kw'>where</span> <span class='ident'>I</span>: <span class='ident'>IntoIterator</span>, <span class='self'>Self</span>::<span class='ident'>Item</span>: <span class='ident'>PartialEq</span><span class='op'>&lt;</span><span class='ident'>I</span>::<span class='ident'>Item</span><span class='op'>&gt;</span> { ... }
    <span class='kw'>fn</span> <span class='ident'>lt</span><span class='op'>&lt;</span><span class='ident'>I</span><span class='op'>&gt;</span>(<span class='self'>self</span>, <span class='ident'>other</span>: <span class='ident'>I</span>) <span class='op'>-&gt;</span> <span class='ident'>bool</span> <span class='kw'>where</span> <span class='ident'>I</span>: <span class='ident'>IntoIterator</span>, <span class='self'>Self</span>::<span class='ident'>Item</span>: <span class='ident'>PartialOrd</span><span class='op'>&lt;</span><span class='ident'>I</span>::<span class='ident'>Item</span><span class='op'>&gt;</span> { ... }
    <span class='kw'>fn</span> <span class='ident'>le</span><span class='op'>&lt;</span><span class='ident'>I</span><span class='op'>&gt;</span>(<span class='self'>self</span>, <span class='ident'>other</span>: <span class='ident'>I</span>) <span class='op'>-&gt;</span> <span class='ident'>bool</span> <span class='kw'>where</span> <span class='ident'>I</span>: <span class='ident'>IntoIterator</span>, <span class='self'>Self</span>::<span class='ident'>Item</span>: <span class='ident'>PartialOrd</span><span class='op'>&lt;</span><span class='ident'>I</span>::<span class='ident'>Item</span><span class='op'>&gt;</span> { ... }
    <span class='kw'>fn</span> <span class='ident'>gt</span><span class='op'>&lt;</span><span class='ident'>I</span><span class='op'>&gt;</span>(<span class='self'>self</span>, <span class='ident'>other</span>: <span class='ident'>I</span>) <span class='op'>-&gt;</span> <span class='ident'>bool</span> <span class='kw'>where</span> <span class='ident'>I</span>: <span class='ident'>IntoIterator</span>, <span class='self'>Self</span>::<span class='ident'>Item</span>: <span class='ident'>PartialOrd</span><span class='op'>&lt;</span><span class='ident'>I</span>::<span class='ident'>Item</span><span class='op'>&gt;</span> { ... }
    <span class='kw'>fn</span> <span class='ident'>ge</span><span class='op'>&lt;</span><span class='ident'>I</span><span class='op'>&gt;</span>(<span class='self'>self</span>, <span class='ident'>other</span>: <span class='ident'>I</span>) <span class='op'>-&gt;</span> <span class='ident'>bool</span> <span class='kw'>where</span> <span class='ident'>I</span>: <span class='ident'>IntoIterator</span>, <span class='self'>Self</span>::<span class='ident'>Item</span>: <span class='ident'>PartialOrd</span><span class='op'>&lt;</span><span class='ident'>I</span>::<span class='ident'>Item</span><span class='op'>&gt;</span> { ... }
}<a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=fn%20main()%20%7B%0Apub%20trait%20Iterator%20%7B%0A%20%20%20%20fn%20cmp%3CI%3E(self%2C%20other%3A%20I)%20-%3E%20Ordering%20where%20I%3A%20IntoIterator%3CItem%3DSelf%3A%3AItem%3E%2C%20Self%3A%3AItem%3A%20Ord%20%7B%20...%20%7D%0A%20%20%20%20fn%20partial_cmp%3CI%3E(self%2C%20other%3A%20I)%20-%3E%20Option%3COrdering%3E%20where%20I%3A%20IntoIterator%2C%20Self%3A%3AItem%3A%20PartialOrd%3CI%3A%3AItem%3E%20%7B%20...%20%7D%0A%20%20%20%20fn%20eq%3CI%3E(self%2C%20other%3A%20I)%20-%3E%20bool%20where%20I%3A%20IntoIterator%2C%20Self%3A%3AItem%3A%20PartialEq%3CI%3A%3AItem%3E%20%7B%20...%20%7D%0A%20%20%20%20fn%20ne%3CI%3E(self%2C%20other%3A%20I)%20-%3E%20bool%20where%20I%3A%20IntoIterator%2C%20Self%3A%3AItem%3A%20PartialEq%3CI%3A%3AItem%3E%20%7B%20...%20%7D%0A%20%20%20%20fn%20lt%3CI%3E(self%2C%20other%3A%20I)%20-%3E%20bool%20where%20I%3A%20IntoIterator%2C%20Self%3A%3AItem%3A%20PartialOrd%3CI%3A%3AItem%3E%20%7B%20...%20%7D%0A%20%20%20%20fn%20le%3CI%3E(self%2C%20other%3A%20I)%20-%3E%20bool%20where%20I%3A%20IntoIterator%2C%20Self%3A%3AItem%3A%20PartialOrd%3CI%3A%3AItem%3E%20%7B%20...%20%7D%0A%20%20%20%20fn%20gt%3CI%3E(self%2C%20other%3A%20I)%20-%3E%20bool%20where%20I%3A%20IntoIterator%2C%20Self%3A%3AItem%3A%20PartialOrd%3CI%3A%3AItem%3E%20%7B%20...%20%7D%0A%20%20%20%20fn%20ge%3CI%3E(self%2C%20other%3A%20I)%20-%3E%20bool%20where%20I%3A%20IntoIterator%2C%20Self%3A%3AItem%3A%20PartialOrd%3CI%3A%3AItem%3E%20%7B%20...%20%7D%0A%7D%0A%7D">Run</a></pre>

<h1 id='other-iterators' class='section-header'><a href='#other-iterators'>Other iterators</a></h1>
<pre class='rust rust-example-rendered'>
<span class='kw'>pub</span> <span class='kw'>trait</span> <span class='ident'>DoubleEndedIterator</span>: <span class='ident'>Iterator</span> {
    <span class='kw'>fn</span> <span class='ident'>next_back</span>(<span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='self'>self</span>) <span class='op'>-&gt;</span> <span class='prelude-ty'>Option</span><span class='op'>&lt;</span><span class='self'>Self</span>::<span class='ident'>Item</span><span class='op'>&gt;</span>;
}

<span class='kw'>pub</span> <span class='kw'>trait</span> <span class='ident'>ExactSizeIterator</span>: <span class='ident'>Iterator</span> {
    <span class='attribute'>#[<span class='ident'>inline</span>]</span>
    <span class='kw'>fn</span> <span class='ident'>len</span>(<span class='kw-2'>&amp;</span><span class='self'>self</span>) <span class='op'>-&gt;</span> <span class='ident'>usize</span> {
        <span class='kw'>let</span> (<span class='ident'>lower</span>, <span class='ident'>upper</span>) <span class='op'>=</span> <span class='self'>self</span>.<span class='ident'>size_hint</span>();
        <span class='comment'>// Note: This assertion is overly defensive, but it checks the invariant</span>
        <span class='comment'>// guaranteed by the trait. If this trait were rust-internal,</span>
        <span class='comment'>// we could use debug_assert!; assert_eq! will check all Rust user</span>
        <span class='comment'>// implementations too.</span>
        <span class='macro'>assert_eq</span><span class='macro'>!</span>(<span class='ident'>upper</span>, <span class='prelude-val'>Some</span>(<span class='ident'>lower</span>));
        <span class='ident'>lower</span>
    }

    <span class='doccomment'>/// Returns whether the iterator is empty.</span>
    <span class='attribute'>#[<span class='ident'>inline</span>]</span>
    <span class='attribute'>#[<span class='ident'>unstable</span>(<span class='ident'>feature</span> <span class='op'>=</span> <span class='string'>&quot;exact_size_is_empty&quot;</span>, <span class='ident'>issue</span> <span class='op'>=</span> <span class='string'>&quot;35428&quot;</span>)]</span>
    <span class='kw'>fn</span> <span class='ident'>is_empty</span>(<span class='kw-2'>&amp;</span><span class='self'>self</span>) <span class='op'>-&gt;</span> <span class='ident'>bool</span> {
        <span class='self'>self</span>.<span class='ident'>len</span>() <span class='op'>==</span> <span class='number'>0</span>
    }
}

<span class='attribute'>#[<span class='ident'>unstable</span>(<span class='ident'>feature</span> <span class='op'>=</span> <span class='string'>&quot;fused&quot;</span>, <span class='ident'>issue</span> <span class='op'>=</span> <span class='string'>&quot;35602&quot;</span>)]</span>
<span class='kw'>pub</span> <span class='kw'>trait</span> <span class='ident'>FusedIterator</span>: <span class='ident'>Iterator</span> {}

<span class='attribute'>#[<span class='ident'>unstable</span>(<span class='ident'>feature</span> <span class='op'>=</span> <span class='string'>&quot;trusted_len&quot;</span>, <span class='ident'>issue</span> <span class='op'>=</span> <span class='string'>&quot;37572&quot;</span>)]</span>
<span class='kw'>pub</span> <span class='kw'>unsafe</span> <span class='kw'>trait</span> <span class='ident'>TrustedLen</span> : <span class='ident'>Iterator</span> {}<a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=fn%20main()%20%7B%0Apub%20trait%20DoubleEndedIterator%3A%20Iterator%20%7B%0A%20%20%20%20fn%20next_back(%26mut%20self)%20-%3E%20Option%3CSelf%3A%3AItem%3E%3B%0A%7D%0A%0Apub%20trait%20ExactSizeIterator%3A%20Iterator%20%7B%0A%20%20%20%20%23%5Binline%5D%0A%20%20%20%20fn%20len(%26self)%20-%3E%20usize%20%7B%0A%20%20%20%20%20%20%20%20let%20(lower%2C%20upper)%20%3D%20self.size_hint()%3B%0A%20%20%20%20%20%20%20%20%2F%2F%20Note%3A%20This%20assertion%20is%20overly%20defensive%2C%20but%20it%20checks%20the%20invariant%0A%20%20%20%20%20%20%20%20%2F%2F%20guaranteed%20by%20the%20trait.%20If%20this%20trait%20were%20rust-internal%2C%0A%20%20%20%20%20%20%20%20%2F%2F%20we%20could%20use%20debug_assert!%3B%20assert_eq!%20will%20check%20all%20Rust%20user%0A%20%20%20%20%20%20%20%20%2F%2F%20implementations%20too.%0A%20%20%20%20%20%20%20%20assert_eq!(upper%2C%20Some(lower))%3B%0A%20%20%20%20%20%20%20%20lower%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F%2F%2F%20Returns%20whether%20the%20iterator%20is%20empty.%0A%20%20%20%20%23%5Binline%5D%0A%20%20%20%20%23%5Bunstable(feature%20%3D%20%22exact_size_is_empty%22%2C%20issue%20%3D%20%2235428%22)%5D%0A%20%20%20%20fn%20is_empty(%26self)%20-%3E%20bool%20%7B%0A%20%20%20%20%20%20%20%20self.len()%20%3D%3D%200%0A%20%20%20%20%7D%0A%7D%0A%0A%23%5Bunstable(feature%20%3D%20%22fused%22%2C%20issue%20%3D%20%2235602%22)%5D%0Apub%20trait%20FusedIterator%3A%20Iterator%20%7B%7D%0A%0A%23%5Bunstable(feature%20%3D%20%22trusted_len%22%2C%20issue%20%3D%20%2237572%22)%5D%0Apub%20unsafe%20trait%20TrustedLen%20%3A%20Iterator%20%7B%7D%0A%7D">Run</a></pre>

<p>TODO: introduce them a bit.</p>

<h1 id='utility-functions' class='section-header'><a href='#utility-functions'>Utility Functions</a></h1>
<pre class='rust rust-example-rendered'>
<span class='doccomment'>/// Creates an iterator that yields nothing.</span>
<span class='kw'>pub</span> <span class='kw'>fn</span> <span class='ident'>empty</span><span class='op'>&lt;</span><span class='ident'>T</span><span class='op'>&gt;</span>() <span class='op'>-&gt;</span> <span class='ident'>Empty</span><span class='op'>&lt;</span><span class='ident'>T</span><span class='op'>&gt;</span> {
    <span class='ident'>Empty</span>(<span class='ident'>marker</span>::<span class='ident'>PhantomData</span>)
}<a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=fn%20main()%20%7B%0A%2F%2F%2F%20Creates%20an%20iterator%20that%20yields%20nothing.%0Apub%20fn%20empty%3CT%3E()%20-%3E%20Empty%3CT%3E%20%7B%0A%20%20%20%20Empty(marker%3A%3APhantomData)%0A%7D%0A%7D">Run</a></pre>

<pre class='rust rust-example-rendered'>
<span class='doccomment'>/// Creates an iterator that yields an element exactly once.</span>
<span class='attribute'>#[<span class='ident'>stable</span>(<span class='ident'>feature</span> <span class='op'>=</span> <span class='string'>&quot;iter_once&quot;</span>, <span class='ident'>since</span> <span class='op'>=</span> <span class='string'>&quot;1.2.0&quot;</span>)]</span>
<span class='kw'>pub</span> <span class='kw'>fn</span> <span class='ident'>once</span><span class='op'>&lt;</span><span class='ident'>T</span><span class='op'>&gt;</span>(<span class='ident'>value</span>: <span class='ident'>T</span>) <span class='op'>-&gt;</span> <span class='ident'>Once</span><span class='op'>&lt;</span><span class='ident'>T</span><span class='op'>&gt;</span> {
    <span class='ident'>Once</span> { <span class='ident'>inner</span>: <span class='prelude-val'>Some</span>(<span class='ident'>value</span>).<span class='ident'>into_iter</span>() }
}<a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=fn%20main()%20%7B%0A%2F%2F%2F%20Creates%20an%20iterator%20that%20yields%20an%20element%20exactly%20once.%0A%23%5Bstable(feature%20%3D%20%22iter_once%22%2C%20since%20%3D%20%221.2.0%22)%5D%0Apub%20fn%20once%3CT%3E(value%3A%20T)%20-%3E%20Once%3CT%3E%20%7B%0A%20%20%20%20Once%20%7B%20inner%3A%20Some(value).into_iter()%20%7D%0A%7D%0A%7D">Run</a></pre>

<pre class='rust rust-example-rendered'>
<span class='doccomment'>/// Creates a new iterator that endlessly repeats a single element.</span>
<span class='attribute'>#[<span class='ident'>inline</span>]</span>
<span class='attribute'>#[<span class='ident'>stable</span>(<span class='ident'>feature</span> <span class='op'>=</span> <span class='string'>&quot;rust1&quot;</span>, <span class='ident'>since</span> <span class='op'>=</span> <span class='string'>&quot;1.0.0&quot;</span>)]</span>
<span class='kw'>pub</span> <span class='kw'>fn</span> <span class='ident'>repeat</span><span class='op'>&lt;</span><span class='ident'>T</span>: <span class='ident'>Clone</span><span class='op'>&gt;</span>(<span class='ident'>elt</span>: <span class='ident'>T</span>) <span class='op'>-&gt;</span> <span class='ident'>Repeat</span><span class='op'>&lt;</span><span class='ident'>T</span><span class='op'>&gt;</span> {
    <span class='ident'>Repeat</span>{<span class='ident'>element</span>: <span class='ident'>elt</span>}
}<a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=fn%20main()%20%7B%0A%2F%2F%2F%20Creates%20a%20new%20iterator%20that%20endlessly%20repeats%20a%20single%20element.%0A%23%5Binline%5D%0A%23%5Bstable(feature%20%3D%20%22rust1%22%2C%20since%20%3D%20%221.0.0%22)%5D%0Apub%20fn%20repeat%3CT%3A%20Clone%3E(elt%3A%20T)%20-%3E%20Repeat%3CT%3E%20%7B%0A%20%20%20%20Repeat%7Belement%3A%20elt%7D%0A%7D%0A%7D">Run</a></pre>

    <script src='rustbook.js'></script>
</div></div>


</body>
</html>