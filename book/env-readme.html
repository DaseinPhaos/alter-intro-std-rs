<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="rustdoc">
    <title>std::env</title>

    <link rel="stylesheet" type="text/css" href="rustbook.css">

    
</head>
<body class="rustdoc">
    <!--[if lte IE 8]>
    <div class="warning">
        This old browser is unsupported and will most likely display funky
        things.
    </div>
    <![endif]-->

    
                <div id="nav">
                    <button id="toggle-nav">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="bar"></span>
                        <span class="bar"></span>
                        <span class="bar"></span>
                    </button>
                </div>
<div id='toc' class='mobile-hidden'>
<ol class='chapter'>
<li><a  href='README.html'><b>1.</b> Introduction</a>
</li>
<li><a  href='macros-readme.html'><b>2.</b> Macros in std</a>
</li>
<li><a  href='mods-readme.html'><b>3.</b> Uncategorized Modules</a>
<ol class='section'>
<li><a  href='any-readme.html'><b>3.1.</b> std::any</a>
</li>
<li><a  href='ascii-readme.html'><b>3.2.</b> std::ascii</a>
</li>
<li><a  href='borrow-readme.html'><b>3.3.</b> std::borrow</a>
</li>
<li><a  href='boxed-readme.html'><b>3.4.</b> std::boxed</a>
</li>
<li><a  href='cell-readme.html'><b>3.5.</b> std::cell</a>
</li>
<li><a  href='clone-readme.html'><b>3.6.</b> std::clone</a>
</li>
<li><a  href='cmp-readme.html'><b>3.7.</b> std::cmp</a>
</li>
<li><a  href='collections-readme.html'><b>3.8.</b> std::collections</a>
</li>
<li><a  href='convert-readme.html'><b>3.9.</b> std::convert</a>
</li>
<li><a  href='default-readme.html'><b>3.10.</b> std::default</a>
</li>
<li><a class='active' href='env-readme.html'><b>3.11.</b> std::env</a>
</li>
<li><a  href='error-readme.html'><b>3.12.</b> std::error</a>
</li>
<li><a  href='ffi-readme.html'><b>3.13.</b> std::ffi</a>
</li>
<li><a  href='fmt-readme.html'><b>3.14.</b> std::fmt</a>
</li>
<li><a  href='fs-readme.html'><b>3.15.</b> std::fmt</a>
</li>
</ol>
</li>
</ol>
</div>
<div id='page-wrapper'>
<div id='page'>


    <h1 class="title">std::env</h1>
    <blockquote>
<p><a href="https://doc.rust-lang.org/std/env/">https://doc.rust-lang.org/std/env/</a></p>
</blockquote>

<p>This module defines some functions inspecting and manipulating the environment of the running process.</p>

<p>The &quot;environment&quot; here includes aspects such as environment argments, current directory, command line arguments and so on.</p>

<p>It also contains a submodule <code>const</code> which defines some constant values specifically associated with the current building target.</p>

<p>Let first take a look at some functions.</p>

<h1 id='command-line-arguments' class='section-header'><a href='#command-line-arguments'>Command Line Arguments</a></h1>
<pre class='rust rust-example-rendered'>
<span class='kw'>use</span> <span class='ident'>sys</span>;

<span class='comment'>// ...</span>

<span class='kw'>pub</span> <span class='kw'>fn</span> <span class='ident'>args_os</span>() <span class='op'>-&gt;</span> <span class='ident'>ArgsOs</span> {
    <span class='ident'>ArgsOs</span>{ <span class='ident'>inner</span>: <span class='ident'>sys</span>::<span class='ident'>args</span>::<span class='ident'>args</span>() }
}

<span class='kw'>pub</span> <span class='kw'>fn</span> <span class='ident'>args</span>() <span class='op'>-&gt;</span> <span class='ident'>Args</span> {
    <span class='ident'>Args</span>{ <span class='ident'>inner</span>: <span class='ident'>args_os</span>() }
}<a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=fn%20main()%20%7B%0Ause%20sys%3B%0A%0A%2F%2F%20...%0A%0Apub%20fn%20args_os()%20-%3E%20ArgsOs%20%7B%0A%20%20%20%20ArgsOs%7B%20inner%3A%20sys%3A%3Aargs%3A%3Aargs()%20%7D%0A%7D%0A%0Apub%20fn%20args()%20-%3E%20Args%20%7B%0A%20%20%20%20Args%7B%20inner%3A%20args_os()%20%7D%0A%7D%0A%7D">Run</a></pre>

<p>These two functions both return an iterator over the arguments the program started with (these arguments are normally passed via command line, thus also called command line arguments in this case).</p>

<p>The first function, <code>arg_os</code> returns an iterator yielding these arguments as <code>StringOs</code>, while the <code>args</code> method returns iterator yielding <code>String</code>. As such, the <code>Args</code> iterator might panic if the process&#39;s argments contain invalid unicode codepoints. If this is not desired, the <code>args_os</code> method should be preferred.</p>

<p>Note that during the construction of <code>ArgsOs</code>, a module <code>sys</code> is used. This module is hidden from users of the standard library, as it is considered to be an implementation detail. We won&#39;t dig into it here, but interested readers can refer to the <a href="https://github.com/rust-lang/rust/tree/master/src/libstd/sys">source code of libstd</a>.</p>

<p>Let&#39;s check out the definitions of these iterator structs. Firstly the <code>ArgsOs</code>:</p>

<pre class='rust rust-example-rendered'>
<span class='kw'>pub</span> <span class='kw'>struct</span> <span class='ident'>ArgsOs</span>{ <span class='ident'>inner</span>: <span class='ident'>sys</span>::<span class='ident'>args</span>::<span class='ident'>Args</span> }<a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=fn%20main()%20%7B%0Apub%20struct%20ArgsOs%7B%20inner%3A%20sys%3A%3Aargs%3A%3AArgs%20%7D%0A%7D">Run</a></pre>

<p>The type implements <code>iterator</code>, <code>ExactSizeIterator</code> and <code>DoubleEndedIterator</code>, with the methods implementation being simply forwarded to its field <code>inner</code>, which also implements these traits.</p>

<p>Then the <code>Args</code>:</p>

<pre class='rust rust-example-rendered'>
<span class='kw'>pub</span> <span class='kw'>struct</span> <span class='ident'>Args</span> { <span class='ident'>inner</span>: <span class='ident'>ArgsOs</span> }<a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=fn%20main()%20%7B%0Apub%20struct%20Args%20%7B%20inner%3A%20ArgsOs%20%7D%0A%7D">Run</a></pre>

<p>Naturally, the type also implements <code>iterator</code>, <code>ExactSizeIterator</code> and <code>DoubleEndedIterator</code>. While most of the methods implementations are simple forwarding, as its field <code>inner</code> yields <code>OsString</code> while itself should yield <code>String</code>, a conversion is needed within the yielding methods. The conversion is done via <code>OsString</code>&#39;s <code>into_string</code> method, which returns a <code>Result</code> with <code>Err</code> indicating conversion failure. The implementation simply <code>unwrap</code>s the result, thus would panic when encounter an argument with invalid unicode codepoints, as we stated above.</p>

<h1 id='environment-variables' class='section-header'><a href='#environment-variables'>Environment Variables</a></h1>
<p>Similarly, we have two functions to retrive environment Variables:</p>

<pre class='rust rust-example-rendered'>
<span class='kw'>pub</span> <span class='kw'>fn</span> <span class='ident'>vars_os</span>() <span class='op'>-&gt;</span> <span class='ident'>VarsOs</span> {
    <span class='ident'>VarsOs</span> { <span class='ident'>inner</span>: <span class='ident'>sys</span>::<span class='ident'>os_imp</span>::<span class='ident'>env</span>() }
}

<span class='kw'>pub</span> <span class='kw'>fn</span> <span class='ident'>vars</span>() <span class='op'>-&gt;</span> <span class='ident'>Vars</span> {
    <span class='ident'>Vars</span> { <span class='ident'>inner</span>: <span class='ident'>vars_os</span>() }
}<a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=fn%20main()%20%7B%0Apub%20fn%20vars_os()%20-%3E%20VarsOs%20%7B%0A%20%20%20%20VarsOs%20%7B%20inner%3A%20sys%3A%3Aos_imp%3A%3Aenv()%20%7D%0A%7D%0A%0Apub%20fn%20vars()%20-%3E%20Vars%20%7B%0A%20%20%20%20Vars%20%7B%20inner%3A%20vars_os()%20%7D%0A%7D%0A%7D">Run</a></pre>

<p>The corresponding struct definitions are also similar:</p>

<pre class='rust rust-example-rendered'>
 <span class='kw'>pub</span> <span class='kw'>struct</span> <span class='ident'>VarsOs</span> { <span class='ident'>inner</span>: <span class='ident'>sys</span>::<span class='ident'>os_imp</span>::<span class='ident'>Env</span> }

 <span class='kw'>pub</span> <span class='kw'>struct</span> <span class='ident'>Vars</span> { <span class='ident'>inner</span>: <span class='ident'>VarsOs</span> }<a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=fn%20main()%20%7B%0A%20pub%20struct%20VarsOs%20%7B%20inner%3A%20sys%3A%3Aos_imp%3A%3AEnv%20%7D%0A%0A%20pub%20struct%20Vars%20%7B%20inner%3A%20VarsOs%20%7D%0A%7D">Run</a></pre>

<p>These iterators yield a (variable, value) pair of strings, for all the environment variables of the current process. It is a snapshot at the time of the function invocation, respectively. As such, modification after the <code>vars</code>(<code>_os</code>) invocation to the environment variables won&#39;t be reflected in the returned iterator.</p>

<p>Similarly, <code>VarsOs</code> yields <code>(OsString, OsString)</code> while <code>Vars</code> yields <code>(String, String)</code>. The later one also might panic. However, they only have the <code>Iterator</code> trait implemented.</p>

<p>Additionally, there are <code>var</code> methods for specific variable query:</p>

<pre class='rust rust-example-rendered'>
<span class='kw'>pub</span> <span class='kw'>fn</span> <span class='ident'>var_os</span><span class='op'>&lt;</span><span class='ident'>K</span><span class='op'>&gt;</span>(<span class='ident'>key</span>: <span class='ident'>K</span>) <span class='op'>-&gt;</span> <span class='prelude-ty'>Option</span><span class='op'>&lt;</span><span class='ident'>OsString</span><span class='op'>&gt;</span> {
    <span class='ident'>_var_os</span>(<span class='ident'>key</span>.<span class='ident'>as_ref</span>())
}

<span class='kw'>fn</span> <span class='ident'>_var_os</span>(<span class='ident'>key</span>: <span class='kw-2'>&amp;</span><span class='ident'>OsStr</span>) <span class='op'>-&gt;</span> <span class='prelude-ty'>Option</span><span class='op'>&lt;</span><span class='ident'>OsString</span><span class='op'>&gt;</span> {
    <span class='ident'>sys</span>::<span class='ident'>os_imp</span>::<span class='ident'>getenv</span>(<span class='ident'>key</span>).<span class='ident'>unwrap_or_else</span>(<span class='op'>|</span><span class='ident'>e</span><span class='op'>|</span> {
        <span class='macro'>panic</span><span class='macro'>!</span>(<span class='string'>&quot;failed to get environment variable `{:?}`: {}&quot;</span>, <span class='ident'>key</span>, <span class='ident'>e</span>)
    })
}

<span class='kw'>pub</span> <span class='kw'>fn</span> <span class='ident'>var</span><span class='op'>&lt;</span><span class='ident'>K</span><span class='op'>&gt;</span>(<span class='ident'>key</span>: <span class='ident'>K</span>) <span class='op'>-&gt;</span> <span class='prelude-ty'>Result</span><span class='op'>&lt;</span><span class='ident'>String</span>, <span class='ident'>VarError</span><span class='op'>&gt;</span>
    <span class='kw'>where</span> <span class='ident'>K</span>: <span class='ident'>AsRef</span><span class='op'>&lt;</span><span class='ident'>OsStr</span><span class='op'>&gt;</span> {
    <span class='ident'>_var</span>(<span class='ident'>key</span>.<span class='ident'>as_ref</span>())
}

<span class='kw'>fn</span> <span class='ident'>_var</span>(<span class='ident'>key</span>: <span class='kw-2'>&amp;</span><span class='ident'>OsStr</span>) <span class='op'>-&gt;</span> <span class='prelude-ty'>Result</span><span class='op'>&lt;</span><span class='ident'>String</span>, <span class='ident'>VarError</span><span class='op'>&gt;</span> {
    <span class='kw'>match</span> <span class='ident'>var_os</span>(<span class='ident'>key</span>) {
        <span class='prelude-val'>Some</span>(<span class='ident'>s</span>) <span class='op'>=&gt;</span> <span class='ident'>s</span>.<span class='ident'>into_string</span>().<span class='ident'>map_err</span>(<span class='ident'>VarError</span>::<span class='ident'>NotUnicode</span>),
        <span class='prelude-val'>None</span> <span class='op'>=&gt;</span> <span class='prelude-val'>Err</span>(<span class='ident'>VarError</span>::<span class='ident'>NotPresent</span>)
    }
}<a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=fn%20main()%20%7B%0Apub%20fn%20var_os%3CK%3E(key%3A%20K)%20-%3E%20Option%3COsString%3E%20%7B%0A%20%20%20%20_var_os(key.as_ref())%0A%7D%0A%0Afn%20_var_os(key%3A%20%26OsStr)%20-%3E%20Option%3COsString%3E%20%7B%0A%20%20%20%20sys%3A%3Aos_imp%3A%3Agetenv(key).unwrap_or_else(%7Ce%7C%20%7B%0A%20%20%20%20%20%20%20%20panic!(%22failed%20to%20get%20environment%20variable%20%60%7B%3A%3F%7D%60%3A%20%7B%7D%22%2C%20key%2C%20e)%0A%20%20%20%20%7D)%0A%7D%0A%0Apub%20fn%20var%3CK%3E(key%3A%20K)%20-%3E%20Result%3CString%2C%20VarError%3E%0A%20%20%20%20where%20K%3A%20AsRef%3COsStr%3E%20%7B%0A%20%20%20%20_var(key.as_ref())%0A%7D%0A%0Afn%20_var(key%3A%20%26OsStr)%20-%3E%20Result%3CString%2C%20VarError%3E%20%7B%0A%20%20%20%20match%20var_os(key)%20%7B%0A%20%20%20%20%20%20%20%20Some(s)%20%3D%3E%20s.into_string().map_err(VarError%3A%3ANotUnicode)%2C%0A%20%20%20%20%20%20%20%20None%20%3D%3E%20Err(VarError%3A%3ANotPresent)%0A%20%20%20%20%7D%0A%7D%0A%7D">Run</a></pre>

<p><code>var_os</code> would fetch the environment variable <code>key</code> as an <code>OsString</code>, returning <code>None</code> if the variable isn&#39;t set, while <code>var</code> fetches the corresponding variable as an <code>String</code>, returning an <code>VarError</code> when failed. The returned error message indicates why the invocation fails (either not present, orr the variable is not valid unicode).</p>

<p>Finally, we have <code>set_var</code> to set a specific environment variable, and <code>remove_var</code> to remove a specific variable.</p>

<pre class='rust rust-example-rendered'>
<span class='kw'>pub</span> <span class='kw'>fn</span> <span class='ident'>set_var</span><span class='op'>&lt;</span><span class='ident'>K</span>, <span class='ident'>V</span><span class='op'>&gt;</span>(<span class='ident'>k</span>: <span class='ident'>K</span>, <span class='ident'>v</span>: <span class='ident'>V</span>)
    <span class='kw'>where</span> <span class='ident'>K</span>: <span class='ident'>AsRef</span><span class='op'>&lt;</span><span class='ident'>OsStr</span><span class='op'>&gt;</span>, <span class='ident'>V</span>: <span class='ident'>AsRef</span><span class='op'>&lt;</span><span class='ident'>OsStr</span><span class='op'>&gt;</span> {
    <span class='ident'>_set_var</span>(<span class='ident'>k</span>.<span class='ident'>as_ref</span>(), <span class='ident'>v</span>.<span class='ident'>as_ref</span>())
}

<span class='kw'>fn</span> <span class='ident'>_set_var</span>(<span class='ident'>k</span>: <span class='kw-2'>&amp;</span><span class='ident'>OsStr</span>, <span class='ident'>v</span>: <span class='kw-2'>&amp;</span><span class='ident'>OsStr</span>) {
    <span class='ident'>sys</span>::<span class='ident'>os_imp</span>::<span class='ident'>setenv</span>(<span class='ident'>k</span>, <span class='ident'>v</span>).<span class='ident'>unwrap_or_else</span>(<span class='op'>|</span><span class='ident'>e</span><span class='op'>|</span> {
        <span class='macro'>panic</span><span class='macro'>!</span>(<span class='string'>&quot;failed to set environment variable `{:?}` to `{:?}`: {}&quot;</span>, <span class='ident'>k</span>, <span class='ident'>v</span>, <span class='ident'>e</span>)
    })
}

<span class='kw'>pub</span> <span class='kw'>fn</span> <span class='ident'>remove_var</span><span class='op'>&lt;</span><span class='ident'>K</span><span class='op'>&gt;</span>(<span class='ident'>k</span>: <span class='ident'>K</span>)
    <span class='kw'>where</span> <span class='ident'>K</span>: <span class='ident'>AsRef</span><span class='op'>&lt;</span><span class='ident'>OsStr</span><span class='op'>&gt;</span> {
    <span class='ident'>_remove_var</span>(<span class='ident'>k</span>.<span class='ident'>as_ref</span>())
}

<span class='kw'>fn</span> <span class='ident'>_remove_var</span>(<span class='ident'>k</span>: <span class='kw-2'>&amp;</span><span class='ident'>OsStr</span>) {
    <span class='ident'>sys</span>::<span class='ident'>os_imp</span>::<span class='ident'>unsetenv</span>(<span class='ident'>k</span>).<span class='ident'>unwrap_or_else</span>(<span class='op'>|</span><span class='ident'>e</span><span class='op'>|</span> {
        <span class='macro'>panic</span><span class='macro'>!</span>(<span class='string'>&quot;failed to remove environment variable `{:?}`: {}&quot;</span>, <span class='ident'>k</span>, <span class='ident'>e</span>)
    })
}<a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=fn%20main()%20%7B%0Apub%20fn%20set_var%3CK%2C%20V%3E(k%3A%20K%2C%20v%3A%20V)%0A%20%20%20%20where%20K%3A%20AsRef%3COsStr%3E%2C%20V%3A%20AsRef%3COsStr%3E%20%7B%0A%20%20%20%20_set_var(k.as_ref()%2C%20v.as_ref())%0A%7D%0A%0Afn%20_set_var(k%3A%20%26OsStr%2C%20v%3A%20%26OsStr)%20%7B%0A%20%20%20%20sys%3A%3Aos_imp%3A%3Asetenv(k%2C%20v).unwrap_or_else(%7Ce%7C%20%7B%0A%20%20%20%20%20%20%20%20panic!(%22failed%20to%20set%20environment%20variable%20%60%7B%3A%3F%7D%60%20to%20%60%7B%3A%3F%7D%60%3A%20%7B%7D%22%2C%20k%2C%20v%2C%20e)%0A%20%20%20%20%7D)%0A%7D%0A%0Apub%20fn%20remove_var%3CK%3E(k%3A%20K)%0A%20%20%20%20where%20K%3A%20AsRef%3COsStr%3E%20%7B%0A%20%20%20%20_remove_var(k.as_ref())%0A%7D%0A%0Afn%20_remove_var(k%3A%20%26OsStr)%20%7B%0A%20%20%20%20sys%3A%3Aos_imp%3A%3Aunsetenv(k).unwrap_or_else(%7Ce%7C%20%7B%0A%20%20%20%20%20%20%20%20panic!(%22failed%20to%20remove%20environment%20variable%20%60%7B%3A%3F%7D%60%3A%20%7B%7D%22%2C%20k%2C%20e)%0A%20%20%20%20%7D)%0A%7D%0A%7D">Run</a></pre>

<p><code>set_var(k, v)</code> would set environment variable <code>k</code> to value <code>v</code> for the current process. <code>remove_var(k)</code> would remove ev <code>k</code> from the environment of the current process.</p>

<p>Note that, all the above four methods would panic if <code>key</code> provided is empty, or contains an ASCII <code>=</code>/<code>\0</code>; or when the value <code>v</code> contains <code>\0</code>.</p>

<p>Also note that these methods delegate the real work to their underscore-prefixed implementation functions. This pattern is common when dealing with generic functions. In this case, only the work of <code>as_ref</code> needs to be generic, separating such part out from the actual non-generic implementation can help reduce the size of the actual binary code generated.</p>

<h1 id='directorys' class='section-header'><a href='#directorys'>Directorys</a></h1>
<p>Next, we have a set of methods for some specific directorys.</p>

<p><code>current_dir</code> and <code>set_current_dir</code> deal with the current working directory of the process:</p>

<pre class='rust rust-example-rendered'>
<span class='kw'>pub</span> <span class='kw'>fn</span> <span class='ident'>current_dir</span>() <span class='op'>-&gt;</span> <span class='ident'>io</span>::<span class='prelude-ty'>Result</span><span class='op'>&lt;</span><span class='ident'>PathBuf</span><span class='op'>&gt;</span> {
    <span class='ident'>sys</span>::<span class='ident'>os_imp</span>::<span class='ident'>getcwd</span>()
}

<span class='kw'>pub</span> <span class='kw'>fn</span> <span class='ident'>set_current_dir</span><span class='op'>&lt;</span><span class='ident'>P</span><span class='op'>&gt;</span>(<span class='ident'>p</span>: <span class='ident'>P</span>) <span class='op'>-&gt;</span> <span class='ident'>io</span>::<span class='prelude-ty'>Result</span><span class='op'>&lt;</span>()<span class='op'>&gt;</span>
    <span class='kw'>where</span> <span class='ident'>P</span>: <span class='ident'>AsRef</span><span class='op'>&lt;</span><span class='ident'>Path</span><span class='op'>&gt;</span> {
    <span class='ident'>sys</span>::<span class='ident'>os_imp</span>::<span class='ident'>chdir</span>(<span class='ident'>p</span>.<span class='ident'>as_ref</span>())
}<a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=fn%20main()%20%7B%0Apub%20fn%20current_dir()%20-%3E%20io%3A%3AResult%3CPathBuf%3E%20%7B%0A%20%20%20%20sys%3A%3Aos_imp%3A%3Agetcwd()%0A%7D%0A%0Apub%20fn%20set_current_dir%3CP%3E(p%3A%20P)%20-%3E%20io%3A%3AResult%3C()%3E%0A%20%20%20%20where%20P%3A%20AsRef%3CPath%3E%20%7B%0A%20%20%20%20sys%3A%3Aos_imp%3A%3Achdir(p.as_ref())%0A%7D%0A%7D">Run</a></pre>

<p><code>current_dir</code> returns the directory as a <code>PathBuf</code>. It will returns an <code>Err</code> if the current working directory value is invalid, like when:
* Current directory does not exist.
* There are insufficient permissions to access the current directory.</p>

<p><code>set_current_dir</code> sets the directory, returning whether the change was completed successfully or not.</p>

<p>Similarly, <code>current_exe</code> returns the full filesystem path of the current running executable file:</p>

<pre class='rust rust-example-rendered'>
<span class='kw'>pub</span> <span class='kw'>fn</span> <span class='ident'>current_exe</span>() <span class='op'>-&gt;</span> <span class='ident'>io</span>::<span class='prelude-ty'>Result</span><span class='op'>&lt;</span><span class='ident'>PathBuf</span><span class='op'>&gt;</span> {
    <span class='ident'>sys</span>::<span class='ident'>os_imp</span>::<span class='ident'>current_exe</span>()
}<a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=fn%20main()%20%7B%0Apub%20fn%20current_exe()%20-%3E%20io%3A%3AResult%3CPathBuf%3E%20%7B%0A%20%20%20%20sys%3A%3Aos_imp%3A%3Acurrent_exe()%0A%7D%0A%7D">Run</a></pre>

<p>Based on the specific platform, the invocation can fail for many reasons. Such failure would be captured by the returned <code>Err</code> variant. Also note that, the returned path might be an intermediate symlinks, not necessarily the actual &quot;real path&quot;.</p>

<p>Then we have <code>home_dir</code>, which returns the current user&#39;s home directory:</p>

<pre class='rust rust-example-rendered'>
<span class='kw'>pub</span> <span class='kw'>fn</span> <span class='ident'>home_dir</span>() <span class='op'>-&gt;</span> <span class='prelude-ty'>Option</span><span class='op'>&lt;</span><span class='ident'>PathBuf</span><span class='op'>&gt;</span> {
    <span class='ident'>sys</span>::<span class='ident'>os_imp</span>::<span class='ident'>home_dir</span>()
}<a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=fn%20main()%20%7B%0Apub%20fn%20home_dir()%20-%3E%20Option%3CPathBuf%3E%20%7B%0A%20%20%20%20sys%3A%3Aos_imp%3A%3Ahome_dir()%0A%7D%0A%7D">Run</a></pre>

<p>the value of the <code>HOME</code> environment variable would be returned if it is set and not empty. Otherwise, on Unix systems, the invocation tries to determine the home directory by invoking the <code>getpwuid_r</code> function on the UID of the current user; while on Windows systems, it will further explore the value of <code>USERPROFILE</code> environment variable, if that is also not set or empty, the invocation would call the Win32 function <code>GetUserProfileDirectory</code> to determine the path.</p>

<p>Finally, <code>temp_dir</code> returns the path of a temporary directory:</p>

<pre class='rust rust-example-rendered'>
<span class='kw'>pub</span> <span class='kw'>fn</span> <span class='ident'>temp_dir</span>() <span class='op'>-&gt;</span> <span class='ident'>PathBuf</span> {
    <span class='ident'>sys</span>::<span class='ident'>os_imp</span>::<span class='ident'>temp_dir</span>()
}<a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=fn%20main()%20%7B%0Apub%20fn%20temp_dir()%20-%3E%20PathBuf%20%7B%0A%20%20%20%20sys%3A%3Aos_imp%3A%3Atemp_dir()%0A%7D%0A%7D">Run</a></pre>

<p>On Unix systems, it returns the <code>TMPDIR</code> ev if set and not empty. Otherwise, for non-Android, it returns <code>/tmp</code>; for Android, it returns <code>/data/local/tmp</code>.</p>

<p>On Windows systems, it returns the value of <code>TMP</code>, <code>TEMP</code> or <code>USERPROFILE</code> ev, in order, if any are set and not empty. Otherwise, it returns the path of the Windows directory. This is actually identical to the behavior of the Win32 function <code>GetTempPath</code>, which the function uses internally.</p>

<h1 id='path' class='section-header'><a href='#path'>PATH</a></h1>
<p>Finally, for the <code>PATH</code> environment variable, we have two additional functions. Either on Unix or on Windows systems, this environment variable has a special meaning of specifying the universally directly callable binaries&#39; directories. However, the separating strategies of these pathes are not identical across platforms. As such, the standard library provides the following two functuons for <code>PATH</code> ev manipulation:</p>

<pre class='rust rust-example-rendered'>
<span class='kw'>pub</span> <span class='kw'>fn</span> <span class='ident'>split_paths</span><span class='op'>&lt;</span><span class='ident'>T</span><span class='op'>&gt;</span>(<span class='ident'>unparsed</span>: <span class='kw-2'>&amp;</span><span class='ident'>T</span>) <span class='op'>-&gt;</span> <span class='ident'>SplitPaths</span>
    <span class='kw'>where</span> <span class='ident'>T</span>: <span class='ident'>AsRef</span><span class='op'>&lt;</span><span class='ident'>OsStr</span><span class='op'>&gt;</span> <span class='op'>+</span> <span class='question-mark'>?</span><span class='ident'>Sized</span> {
    <span class='ident'>SplitPaths</span> { <span class='ident'>inner</span>: <span class='ident'>sys</span>::<span class='ident'>os_imp</span>::<span class='ident'>split_paths</span>(<span class='ident'>unparsed</span>.<span class='ident'>as_ref</span>()) }
}

<span class='kw'>pub</span> <span class='kw'>struct</span> <span class='ident'>SplitPaths</span><span class='op'>&lt;</span><span class='lifetime'>&#39;a</span><span class='op'>&gt;</span> {
    <span class='ident'>inner</span>: <span class='ident'>sys</span>::<span class='ident'>os_imp</span>::<span class='ident'>SplitPaths</span><span class='op'>&lt;</span><span class='lifetime'>&#39;a</span><span class='op'>&gt;</span>
}

<span class='kw'>impl</span><span class='op'>&lt;</span><span class='lifetime'>&#39;a</span><span class='op'>&gt;</span> <span class='ident'>Iterator</span> <span class='kw'>for</span> <span class='ident'>SplitPaths</span><span class='op'>&lt;</span><span class='lifetime'>&#39;a</span><span class='op'>&gt;</span> {
    <span class='kw'>type</span> <span class='ident'>Item</span> <span class='op'>=</span> <span class='ident'>PathBuf</span>;
    <span class='kw'>fn</span> <span class='ident'>next</span>(<span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='self'>self</span>) <span class='op'>-&gt;</span> <span class='prelude-ty'>Option</span><span class='op'>&lt;</span><span class='ident'>PathBuf</span><span class='op'>&gt;</span> {
        <span class='self'>self</span>.<span class='ident'>inner</span>.<span class='ident'>next</span>()
    }
    <span class='kw'>fn</span> <span class='ident'>size_hint</span>(<span class='kw-2'>&amp;</span><span class='self'>self</span>) <span class='op'>-&gt;</span> (<span class='ident'>usize</span>, <span class='prelude-ty'>Option</span><span class='op'>&lt;</span><span class='ident'>usize</span><span class='op'>&gt;</span>) {
        <span class='self'>self</span>.<span class='ident'>inner</span>.<span class='ident'>size_hint</span>()
    }
}<a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=fn%20main()%20%7B%0Apub%20fn%20split_paths%3CT%3E(unparsed%3A%20%26T)%20-%3E%20SplitPaths%0A%20%20%20%20where%20T%3A%20AsRef%3COsStr%3E%20%2B%20%3FSized%20%7B%0A%20%20%20%20SplitPaths%20%7B%20inner%3A%20sys%3A%3Aos_imp%3A%3Asplit_paths(unparsed.as_ref())%20%7D%0A%7D%0A%0Apub%20struct%20SplitPaths%3C'a%3E%20%7B%0A%20%20%20%20inner%3A%20sys%3A%3Aos_imp%3A%3ASplitPaths%3C'a%3E%0A%7D%0A%0Aimpl%3C'a%3E%20Iterator%20for%20SplitPaths%3C'a%3E%20%7B%0A%20%20%20%20type%20Item%20%3D%20PathBuf%3B%0A%20%20%20%20fn%20next(%26mut%20self)%20-%3E%20Option%3CPathBuf%3E%20%7B%0A%20%20%20%20%20%20%20%20self.inner.next()%0A%20%20%20%20%7D%0A%20%20%20%20fn%20size_hint(%26self)%20-%3E%20(usize%2C%20Option%3Cusize%3E)%20%7B%0A%20%20%20%20%20%20%20%20self.inner.size_hint()%0A%20%20%20%20%7D%0A%7D%0A%7D">Run</a></pre>

<p>Function <code>split_paths(paths)</code> takes an unparsed <code>PATH</code> value <code>paths</code>, and returns an iterator over the actual paths contained in <code>paths</code>. The iterator yields these paths as <code>PathBuf</code>s.</p>

<p>Function <code>join_paths</code> does the contrary:</p>

<pre class='rust rust-example-rendered'>
<span class='kw'>pub</span> <span class='kw'>fn</span> <span class='ident'>join_paths</span><span class='op'>&lt;</span><span class='ident'>I</span>, <span class='ident'>T</span><span class='op'>&gt;</span>(<span class='ident'>paths</span>: <span class='ident'>I</span>) <span class='op'>-&gt;</span> <span class='prelude-ty'>Result</span><span class='op'>&lt;</span><span class='ident'>OsString</span>, <span class='ident'>JoinPathsError</span><span class='op'>&gt;</span>
    <span class='kw'>where</span> <span class='ident'>I</span>: <span class='ident'>IntoIterator</span><span class='op'>&lt;</span><span class='ident'>Item</span><span class='op'>=</span><span class='ident'>T</span><span class='op'>&gt;</span>, <span class='ident'>T</span>: <span class='ident'>AsRef</span><span class='op'>&lt;</span><span class='ident'>OsStr</span><span class='op'>&gt;</span> {
    <span class='ident'>sys</span>::<span class='ident'>os_imp</span>::<span class='ident'>join_paths</span>(<span class='ident'>paths</span>.<span class='ident'>into_iter</span>()).<span class='ident'>map_err</span>(<span class='op'>|</span><span class='ident'>e</span><span class='op'>|</span> {
        <span class='ident'>JoinPathsError</span>{ <span class='ident'>inner</span>: <span class='ident'>e</span>}
    })
}<a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=fn%20main()%20%7B%0Apub%20fn%20join_paths%3CI%2C%20T%3E(paths%3A%20I)%20-%3E%20Result%3COsString%2C%20JoinPathsError%3E%0A%20%20%20%20where%20I%3A%20IntoIterator%3CItem%3DT%3E%2C%20T%3A%20AsRef%3COsStr%3E%20%7B%0A%20%20%20%20sys%3A%3Aos_imp%3A%3Ajoin_paths(paths.into_iter()).map_err(%7Ce%7C%20%7B%0A%20%20%20%20%20%20%20%20JoinPathsError%7B%20inner%3A%20e%7D%0A%20%20%20%20%7D)%0A%7D%0A%7D">Run</a></pre>

<p>It joins a collection of <code>paths</code> for the <code>PATH</code> ev, returning an <code>OsString</code> on success. If one of the input <code>Path</code>s contains invalid chracter for contructing the value of a <code>PATH</code> variable( dobule quote on Windows, colon on Unix), the function returns an <code>Err</code>.</p>

<h1 id='constants' class='section-header'><a href='#constants'>Constants</a></h1>
<p>The module also contains a submodule, <code>const</code>, which contains some constants associated with the current building target.</p>

<p>The provided infomation include:</p>

<ul>
<li><code>ARCH: &amp;&#39;static str</code>: A string describing the architecture of the CPU that is currently in use. Possible values include &quot;x86&quot;, &quot;x86_64&quot;, &quot;arm&quot;, &quot;aarch64&quot;, &quot;mips&quot;, &quot;mips64&quot;, &quot;powerpc&quot;, &quot;powerpc64&quot;, etc.</li>
<li><code>FAMILIY: &amp;&#39;static str</code>: A string describing the family of the OS. Possible values include &quot;unix&quot;, &quot;windows&quot;.</li>
<li><code>OS: &amp;&#39;static str</code>: A string describing the specific OS. Possible values include &quot;linux&quot;, &quot;macos&quot;, &quot;ios&quot;, &quot;freebsd&quot;, &quot;android&quot;, &quot;windows&quot;.</li>
<li><code>DLL_PREFIX: &amp;&#39;static str</code>: A string specifying the filename prefix used for shared libraries on the platform. Possible values include &quot;lib&quot;, &quot;&quot;(an empty string).</li>
<li><code>DLL_SUFFIX: &amp;&#39;static str</code>: A string specifying the filename suffix used for shared libraries on the platform. Possible values include &quot;.so&quot;, &quot;.dylib&quot;, &quot;.dll&quot;.</li>
<li><code>DLL_EXTENSION: &amp;&#39;static str</code>: A string specifying the file extension used for shared libraries on the platform that goes after the last dot. Possible values include &quot;so&quot;, &quot;dylib&quot;, &quot;dll&quot;.</li>
<li><code>EXE_SUFFIX: &amp;&#39;static str</code>: A string specifying the filename suffix used for executable binaries on the platform. Possible values include &quot;.exe&quot;, &quot;.nexe&quot;, &quot;.pexe&quot;, &quot;&quot;.</li>
<li><code>EXE_EXTENSION: &amp;&#39;static str</code>: A string specifying the file extension used for executable binaries on the platform. Possible values include &quot;exe&quot;, &quot;&quot;.</li>
</ul>

    <script src='rustbook.js'></script>
</div></div>


</body>
</html>