<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="rustdoc">
    <title>std::ops</title>

    <link rel="stylesheet" type="text/css" href="rustbook.css">

    
</head>
<body class="rustdoc">
    <!--[if lte IE 8]>
    <div class="warning">
        This old browser is unsupported and will most likely display funky
        things.
    </div>
    <![endif]-->

    
                <div id="nav">
                    <button id="toggle-nav">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="bar"></span>
                        <span class="bar"></span>
                        <span class="bar"></span>
                    </button>
                </div>
<div id='toc' class='mobile-hidden'>
<ol class='chapter'>
<li><a  href='README.html'><b>1.</b> Introduction</a>
</li>
<li><a  href='macros-readme.html'><b>2.</b> Macros in std</a>
</li>
<li><a  href='mods-readme.html'><b>3.</b> Uncategorized Modules</a>
<ol class='section'>
<li><a  href='any-readme.html'><b>3.1.</b> std::any</a>
</li>
<li><a  href='ascii-readme.html'><b>3.2.</b> std::ascii</a>
</li>
<li><a  href='borrow-readme.html'><b>3.3.</b> std::borrow</a>
</li>
<li><a  href='boxed-readme.html'><b>3.4.</b> std::boxed</a>
</li>
<li><a  href='cell-readme.html'><b>3.5.</b> std::cell</a>
</li>
<li><a  href='clone-readme.html'><b>3.6.</b> std::clone</a>
</li>
<li><a  href='cmp-readme.html'><b>3.7.</b> std::cmp</a>
</li>
<li><a  href='collections-readme.html'><b>3.8.</b> std::collections</a>
</li>
<li><a  href='convert-readme.html'><b>3.9.</b> std::convert</a>
</li>
<li><a  href='default-readme.html'><b>3.10.</b> std::default</a>
</li>
<li><a  href='env-readme.html'><b>3.11.</b> std::env</a>
</li>
<li><a  href='error-readme.html'><b>3.12.</b> std::error</a>
</li>
<li><a  href='ffi-readme.html'><b>3.13.</b> std::ffi</a>
</li>
<li><a  href='fmt-readme.html'><b>3.14.</b> std::fmt</a>
</li>
<li><a  href='fs-readme.html'><b>3.15.</b> std::fs</a>
</li>
<li><a  href='hash-readme.html'><b>3.16.</b> std::hash</a>
</li>
<li><a  href='io-readme.html'><b>3.17.</b> std::io</a>
</li>
<li><a  href='iter-readme.html'><b>3.18.</b> std::iter</a>
</li>
<li><a  href='marker-readme.html'><b>3.19.</b> std::marker</a>
</li>
<li><a  href='mem-readme.html'><b>3.20.</b> std::mem</a>
</li>
<li><a  href='net-readme.html'><b>3.21.</b> std::net</a>
</li>
<li><a  href='num-readme.html'><b>3.22.</b> std::num</a>
</li>
<li><a class='active' href='ops-readme.html'><b>3.23.</b> std::ops</a>
</li>
<li><a  href='option-readme.html'><b>3.24.</b> std::option</a>
</li>
<li><a  href='os-readme.html'><b>3.25.</b> std::os</a>
</li>
<li><a  href='panic-readme.html'><b>3.26.</b> std::panic</a>
</li>
<li><a  href='path-readme.html'><b>3.27.</b> std::path</a>
</li>
<li><a  href='prelude-readme.html'><b>3.28.</b> std::prelude</a>
</li>
<li><a  href='process-readme.html'><b>3.29.</b> std::process</a>
</li>
</ol>
</li>
</ol>
</div>
<div id='page-wrapper'>
<div id='page'>


    <h1 class="title">std::ops</h1>
    <p>This module contains traits that allow the user to overload certain operators.</p>

<p>The first set of traits deals with numerical operators, including <code>+</code>, <code>-</code>, <code>*</code>, <code>/</code>, <code>%</code>, and bitwise operators <code>&amp;</code>, <code>|</code>, <code>^</code>, <code>&lt;&lt;</code>, <code>&gt;&gt;</code>:</p>

<pre class='rust rust-example-rendered'>
<span class='kw'>pub</span> <span class='kw'>trait</span> <span class='ident'>Add</span><span class='op'>&lt;</span><span class='ident'>RHS</span> <span class='op'>=</span> <span class='self'>Self</span><span class='op'>&gt;</span> {
    <span class='kw'>type</span> <span class='ident'>Output</span>;
    <span class='kw'>fn</span> <span class='ident'>add</span>(<span class='self'>self</span>, <span class='ident'>rhs</span>: <span class='ident'>RHS</span>) <span class='op'>-&gt;</span> <span class='self'>Self</span>::<span class='ident'>Output</span>;
}

<span class='kw'>pub</span> <span class='kw'>trait</span> <span class='ident'>Sub</span><span class='op'>&lt;</span><span class='ident'>RHS</span> <span class='op'>=</span> <span class='self'>Self</span><span class='op'>&gt;</span> {
    <span class='kw'>type</span> <span class='ident'>Output</span>;
    <span class='kw'>fn</span> <span class='ident'>sub</span>(<span class='self'>self</span>, <span class='ident'>rhs</span>: <span class='ident'>RHS</span>) <span class='op'>-&gt;</span> <span class='self'>Self</span>::<span class='ident'>Output</span>;
}

<span class='kw'>pub</span> <span class='kw'>trait</span> <span class='ident'>Mul</span><span class='op'>&lt;</span><span class='ident'>RHS</span> <span class='op'>=</span> <span class='self'>Self</span><span class='op'>&gt;</span> {
    <span class='kw'>type</span> <span class='ident'>Output</span>;
    <span class='kw'>fn</span> <span class='ident'>mul</span>(<span class='self'>self</span>, <span class='ident'>rhs</span>: <span class='ident'>RHS</span>) <span class='op'>-&gt;</span> <span class='self'>Self</span>::<span class='ident'>Output</span>;
}

<span class='kw'>pub</span> <span class='kw'>trait</span> <span class='ident'>Div</span><span class='op'>&lt;</span><span class='ident'>RHS</span> <span class='op'>=</span> <span class='self'>Self</span><span class='op'>&gt;</span> {
    <span class='kw'>type</span> <span class='ident'>Output</span>;
    <span class='kw'>fn</span> <span class='ident'>div</span>(<span class='self'>self</span>, <span class='ident'>rhs</span>: <span class='ident'>RHS</span>) <span class='op'>-&gt;</span> <span class='self'>Self</span>::<span class='ident'>Output</span>;
}

<span class='kw'>pub</span> <span class='kw'>trait</span> <span class='ident'>Rem</span><span class='op'>&lt;</span><span class='ident'>RHS</span> <span class='op'>=</span> <span class='self'>Self</span><span class='op'>&gt;</span> {
    <span class='kw'>type</span> <span class='ident'>Output</span> <span class='op'>=</span> <span class='self'>Self</span>;
    <span class='kw'>fn</span> <span class='ident'>rem</span>(<span class='self'>self</span>, <span class='ident'>rhs</span>: <span class='ident'>RHS</span>) <span class='op'>-&gt;</span> <span class='self'>Self</span>::<span class='ident'>Output</span>;
}

<span class='kw'>pub</span> <span class='kw'>trait</span> <span class='ident'>BitAnd</span><span class='op'>&lt;</span><span class='ident'>RHS</span> <span class='op'>=</span> <span class='self'>Self</span><span class='op'>&gt;</span> {
    <span class='kw'>type</span> <span class='ident'>Output</span>;
    <span class='kw'>fn</span> <span class='ident'>bitand</span>(<span class='self'>self</span>, <span class='ident'>rhs</span>: <span class='ident'>RHS</span>) <span class='op'>-&gt;</span> <span class='self'>Self</span>::<span class='ident'>Output</span>;
}

<span class='kw'>pub</span> <span class='kw'>trait</span> <span class='ident'>BitOr</span><span class='op'>&lt;</span><span class='ident'>RHS</span> <span class='op'>=</span> <span class='self'>Self</span><span class='op'>&gt;</span> {
    <span class='kw'>type</span> <span class='ident'>Output</span>;
    <span class='kw'>fn</span> <span class='ident'>bitor</span>(<span class='self'>self</span>, <span class='ident'>rhs</span>: <span class='ident'>RHS</span>) <span class='op'>-&gt;</span> <span class='self'>Self</span>::<span class='ident'>Output</span>;
}

<span class='kw'>pub</span> <span class='kw'>trait</span> <span class='ident'>BitXor</span><span class='op'>&lt;</span><span class='ident'>RHS</span> <span class='op'>=</span> <span class='self'>Self</span><span class='op'>&gt;</span> {
    <span class='kw'>type</span> <span class='ident'>Output</span>;
    <span class='kw'>fn</span> <span class='ident'>bitxor</span>(<span class='self'>self</span>, <span class='ident'>rhs</span>: <span class='ident'>RHS</span>) <span class='op'>-&gt;</span> <span class='self'>Self</span>::<span class='ident'>Output</span>;
}

<span class='kw'>pub</span> <span class='kw'>trait</span> <span class='ident'>Shl</span><span class='op'>&lt;</span><span class='ident'>RHS</span><span class='op'>&gt;</span> {
    <span class='kw'>type</span> <span class='ident'>Output</span>;
    <span class='kw'>fn</span> <span class='ident'>shl</span>(<span class='self'>self</span>, <span class='ident'>rhs</span>: <span class='ident'>RHS</span>) <span class='op'>-&gt;</span> <span class='self'>Self</span>::<span class='ident'>Output</span>;
}

<span class='kw'>pub</span> <span class='kw'>trait</span> <span class='ident'>Shr</span><span class='op'>&lt;</span><span class='ident'>RHS</span><span class='op'>&gt;</span> {
    <span class='kw'>type</span> <span class='ident'>Output</span>;
    <span class='kw'>fn</span> <span class='ident'>shr</span>(<span class='self'>self</span>, <span class='ident'>rhs</span>: <span class='ident'>RHS</span>) <span class='op'>-&gt;</span> <span class='self'>Self</span>::<span class='ident'>Output</span>;
}<a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=fn%20main()%20%7B%0Apub%20trait%20Add%3CRHS%20%3D%20Self%3E%20%7B%0A%20%20%20%20type%20Output%3B%0A%20%20%20%20fn%20add(self%2C%20rhs%3A%20RHS)%20-%3E%20Self%3A%3AOutput%3B%0A%7D%0A%0Apub%20trait%20Sub%3CRHS%20%3D%20Self%3E%20%7B%0A%20%20%20%20type%20Output%3B%0A%20%20%20%20fn%20sub(self%2C%20rhs%3A%20RHS)%20-%3E%20Self%3A%3AOutput%3B%0A%7D%0A%0Apub%20trait%20Mul%3CRHS%20%3D%20Self%3E%20%7B%0A%20%20%20%20type%20Output%3B%0A%20%20%20%20fn%20mul(self%2C%20rhs%3A%20RHS)%20-%3E%20Self%3A%3AOutput%3B%0A%7D%0A%0Apub%20trait%20Div%3CRHS%20%3D%20Self%3E%20%7B%0A%20%20%20%20type%20Output%3B%0A%20%20%20%20fn%20div(self%2C%20rhs%3A%20RHS)%20-%3E%20Self%3A%3AOutput%3B%0A%7D%0A%0Apub%20trait%20Rem%3CRHS%20%3D%20Self%3E%20%7B%0A%20%20%20%20type%20Output%20%3D%20Self%3B%0A%20%20%20%20fn%20rem(self%2C%20rhs%3A%20RHS)%20-%3E%20Self%3A%3AOutput%3B%0A%7D%0A%0Apub%20trait%20BitAnd%3CRHS%20%3D%20Self%3E%20%7B%0A%20%20%20%20type%20Output%3B%0A%20%20%20%20fn%20bitand(self%2C%20rhs%3A%20RHS)%20-%3E%20Self%3A%3AOutput%3B%0A%7D%0A%0Apub%20trait%20BitOr%3CRHS%20%3D%20Self%3E%20%7B%0A%20%20%20%20type%20Output%3B%0A%20%20%20%20fn%20bitor(self%2C%20rhs%3A%20RHS)%20-%3E%20Self%3A%3AOutput%3B%0A%7D%0A%0Apub%20trait%20BitXor%3CRHS%20%3D%20Self%3E%20%7B%0A%20%20%20%20type%20Output%3B%0A%20%20%20%20fn%20bitxor(self%2C%20rhs%3A%20RHS)%20-%3E%20Self%3A%3AOutput%3B%0A%7D%0A%0Apub%20trait%20Shl%3CRHS%3E%20%7B%0A%20%20%20%20type%20Output%3B%0A%20%20%20%20fn%20shl(self%2C%20rhs%3A%20RHS)%20-%3E%20Self%3A%3AOutput%3B%0A%7D%0A%0Apub%20trait%20Shr%3CRHS%3E%20%7B%0A%20%20%20%20type%20Output%3B%0A%20%20%20%20fn%20shr(self%2C%20rhs%3A%20RHS)%20-%3E%20Self%3A%3AOutput%3B%0A%7D%0A%7D">Run</a></pre>

<p>Note that these traits consumes both parameters by value.</p>

<hr>

<p>Next comes a set of traits dealing with assigning-operators, including <code>+=</code>, <code>-=</code>, <code>*=</code>, <code>/=</code>, <code>%=</code>, <code>&amp;=</code>, <code>|=</code> and <code>^=</code>:</p>

<pre class='rust rust-example-rendered'>
<span class='kw'>pub</span> <span class='kw'>trait</span> <span class='ident'>AddAssign</span><span class='op'>&lt;</span><span class='ident'>Rhs</span> <span class='op'>=</span> <span class='self'>Self</span><span class='op'>&gt;</span> {
    <span class='kw'>fn</span> <span class='ident'>add_assign</span>(<span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='self'>self</span>, <span class='ident'>Rhs</span>);
}

<span class='kw'>pub</span> <span class='kw'>trait</span> <span class='ident'>SubAssign</span><span class='op'>&lt;</span><span class='ident'>Rhs</span> <span class='op'>=</span> <span class='self'>Self</span><span class='op'>&gt;</span> {
    <span class='kw'>fn</span> <span class='ident'>sub_assign</span>(<span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='self'>self</span>, <span class='ident'>Rhs</span>);
}

<span class='kw'>pub</span> <span class='kw'>trait</span> <span class='ident'>MulAssign</span><span class='op'>&lt;</span><span class='ident'>Rhs</span> <span class='op'>=</span> <span class='self'>Self</span><span class='op'>&gt;</span> {
    <span class='kw'>fn</span> <span class='ident'>mul_assign</span>(<span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='self'>self</span>, <span class='ident'>Rhs</span>);
}

<span class='kw'>pub</span> <span class='kw'>trait</span> <span class='ident'>DivAssign</span><span class='op'>&lt;</span><span class='ident'>Rhs</span> <span class='op'>=</span> <span class='self'>Self</span><span class='op'>&gt;</span> {
    <span class='kw'>fn</span> <span class='ident'>div_assign</span>(<span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='self'>self</span>, <span class='ident'>Rhs</span>);
}

<span class='kw'>pub</span> <span class='kw'>trait</span> <span class='ident'>RemAssign</span><span class='op'>&lt;</span><span class='ident'>Rhs</span> <span class='op'>=</span> <span class='self'>Self</span><span class='op'>&gt;</span> {
    <span class='kw'>fn</span> <span class='ident'>rem_assign</span>(<span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='self'>self</span>, <span class='ident'>Rhs</span>);
}

<span class='kw'>pub</span> <span class='kw'>trait</span> <span class='ident'>BitAndAssign</span><span class='op'>&lt;</span><span class='ident'>Rhs</span> <span class='op'>=</span> <span class='self'>Self</span><span class='op'>&gt;</span> {
    <span class='kw'>fn</span> <span class='ident'>bitand_assign</span>(<span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='self'>self</span>, <span class='ident'>Rhs</span>);
}

<span class='kw'>pub</span> <span class='kw'>trait</span> <span class='ident'>BitOrAssign</span><span class='op'>&lt;</span><span class='ident'>Rhs</span> <span class='op'>=</span> <span class='self'>Self</span><span class='op'>&gt;</span> {
    <span class='kw'>fn</span> <span class='ident'>bitor_assign</span>(<span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='self'>self</span>, <span class='ident'>Rhs</span>);
}

<span class='kw'>pub</span> <span class='kw'>trait</span> <span class='ident'>BitXorAssign</span><span class='op'>&lt;</span><span class='ident'>Rhs</span> <span class='op'>=</span> <span class='self'>Self</span><span class='op'>&gt;</span> {
    <span class='kw'>fn</span> <span class='ident'>bitxor_assign</span>(<span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='self'>self</span>, <span class='ident'>Rhs</span>);
}

<span class='kw'>pub</span> <span class='kw'>trait</span> <span class='ident'>ShlAssign</span><span class='op'>&lt;</span><span class='ident'>Rhs</span><span class='op'>&gt;</span> {
    <span class='kw'>fn</span> <span class='ident'>shl_assign</span>(<span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='self'>self</span>, <span class='ident'>Rhs</span>);
}

<span class='kw'>pub</span> <span class='kw'>trait</span> <span class='ident'>ShrAssign</span><span class='op'>&lt;</span><span class='ident'>Rhs</span><span class='op'>&gt;</span> {
    <span class='kw'>fn</span> <span class='ident'>shr_assign</span>(<span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='self'>self</span>, <span class='ident'>Rhs</span>);
}<a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=fn%20main()%20%7B%0Apub%20trait%20AddAssign%3CRhs%20%3D%20Self%3E%20%7B%0A%20%20%20%20fn%20add_assign(%26mut%20self%2C%20Rhs)%3B%0A%7D%0A%0Apub%20trait%20SubAssign%3CRhs%20%3D%20Self%3E%20%7B%0A%20%20%20%20fn%20sub_assign(%26mut%20self%2C%20Rhs)%3B%0A%7D%0A%0Apub%20trait%20MulAssign%3CRhs%20%3D%20Self%3E%20%7B%0A%20%20%20%20fn%20mul_assign(%26mut%20self%2C%20Rhs)%3B%0A%7D%0A%0Apub%20trait%20DivAssign%3CRhs%20%3D%20Self%3E%20%7B%0A%20%20%20%20fn%20div_assign(%26mut%20self%2C%20Rhs)%3B%0A%7D%0A%0Apub%20trait%20RemAssign%3CRhs%20%3D%20Self%3E%20%7B%0A%20%20%20%20fn%20rem_assign(%26mut%20self%2C%20Rhs)%3B%0A%7D%0A%0Apub%20trait%20BitAndAssign%3CRhs%20%3D%20Self%3E%20%7B%0A%20%20%20%20fn%20bitand_assign(%26mut%20self%2C%20Rhs)%3B%0A%7D%0A%0Apub%20trait%20BitOrAssign%3CRhs%20%3D%20Self%3E%20%7B%0A%20%20%20%20fn%20bitor_assign(%26mut%20self%2C%20Rhs)%3B%0A%7D%0A%0Apub%20trait%20BitXorAssign%3CRhs%20%3D%20Self%3E%20%7B%0A%20%20%20%20fn%20bitxor_assign(%26mut%20self%2C%20Rhs)%3B%0A%7D%0A%0Apub%20trait%20ShlAssign%3CRhs%3E%20%7B%0A%20%20%20%20fn%20shl_assign(%26mut%20self%2C%20Rhs)%3B%0A%7D%0A%0Apub%20trait%20ShrAssign%3CRhs%3E%20%7B%0A%20%20%20%20fn%20shr_assign(%26mut%20self%2C%20Rhs)%3B%0A%7D%0A%7D">Run</a></pre>

<hr>

<p>Additionally, some unary-operators can also be overloaded, including: <code>-</code>, <code>!</code>, <code>*</code>:</p>

<pre class='rust rust-example-rendered'>
<span class='kw'>pub</span> <span class='kw'>trait</span> <span class='ident'>Neg</span> {
    <span class='kw'>type</span> <span class='ident'>Output</span>;
    <span class='kw'>fn</span> <span class='ident'>neg</span>(<span class='self'>self</span>) <span class='op'>-&gt;</span> <span class='self'>Self</span>::<span class='ident'>Output</span>;
}

<span class='kw'>pub</span> <span class='kw'>trait</span> <span class='ident'>Not</span> {
    <span class='kw'>type</span> <span class='ident'>Output</span>;
    <span class='kw'>fn</span> <span class='ident'>not</span>(<span class='self'>self</span>) <span class='op'>-&gt;</span> <span class='self'>Self</span>::<span class='ident'>Output</span>;
}<a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=fn%20main()%20%7B%0Apub%20trait%20Neg%20%7B%0A%20%20%20%20type%20Output%3B%0A%20%20%20%20fn%20neg(self)%20-%3E%20Self%3A%3AOutput%3B%0A%7D%0A%0Apub%20trait%20Not%20%7B%0A%20%20%20%20type%20Output%3B%0A%20%20%20%20fn%20not(self)%20-%3E%20Self%3A%3AOutput%3B%0A%7D%0A%7D">Run</a></pre>

<p>The dereference operator <code>*</code> is kind of special. According to the context, a <code>*v</code> can be treated either as a lvalue( e.g. <code>let x = *y;</code>) or a rvalue (e.g. <code>*x = y;</code>). Thus, two different traits are provided for this operator.</p>

<p>Under the lvalue context, we have</p>

<pre class='rust rust-example-rendered'>
<span class='kw'>pub</span> <span class='kw'>trait</span> <span class='ident'>Deref</span> {
    <span class='kw'>type</span> <span class='ident'>Target</span>: <span class='question-mark'>?</span><span class='ident'>Sized</span>;
    <span class='kw'>fn</span> <span class='ident'>deref</span>(<span class='kw-2'>&amp;</span><span class='self'>self</span>) <span class='op'>-&gt;</span> <span class='kw-2'>&amp;</span><span class='self'>Self</span>::<span class='ident'>Target</span>;
}<a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=fn%20main()%20%7B%0Apub%20trait%20Deref%20%7B%0A%20%20%20%20type%20Target%3A%20%3FSized%3B%0A%20%20%20%20fn%20deref(%26self)%20-%3E%20%26Self%3A%3ATarget%3B%0A%7D%0A%7D">Run</a></pre>

<p>Thus, say we have</p>

<pre class='rust rust-example-rendered'>
<span class='kw'>use</span> <span class='ident'>std</span>::<span class='ident'>ops</span>::<span class='ident'>Deref</span>;

<span class='kw'>struct</span> <span class='ident'>Foo</span> {
    <span class='ident'>u</span>: <span class='ident'>i32</span>,
    <span class='ident'>v</span>: <span class='ident'>i32</span>,
}

<span class='kw'>impl</span> <span class='ident'>Deref</span> <span class='kw'>for</span> <span class='ident'>Foo</span> {
    <span class='kw'>type</span> <span class='ident'>Target</span> <span class='op'>=</span> <span class='ident'>i32</span>;

    <span class='kw'>fn</span> <span class='ident'>deref</span>(<span class='kw-2'>&amp;</span><span class='self'>self</span>) <span class='op'>-&gt;</span> <span class='kw-2'>&amp;</span><span class='ident'>i32</span> {
        <span class='kw-2'>&amp;</span><span class='self'>self</span>.<span class='ident'>u</span>
    }
}<a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=fn%20main()%20%7B%0Ause%20std%3A%3Aops%3A%3ADeref%3B%0A%0Astruct%20Foo%20%7B%0A%20%20%20%20u%3A%20i32%2C%0A%20%20%20%20v%3A%20i32%2C%0A%7D%0A%0Aimpl%20Deref%20for%20Foo%20%7B%0A%20%20%20%20type%20Target%20%3D%20i32%3B%0A%0A%20%20%20%20fn%20deref(%26self)%20-%3E%20%26i32%20%7B%0A%20%20%20%20%20%20%20%20%26self.u%0A%20%20%20%20%7D%0A%7D%0A%7D">Run</a></pre>

<p>Then</p>

<pre class='rust rust-example-rendered'>
<span class='kw'>let</span> <span class='ident'>foo</span> <span class='op'>=</span> <span class='ident'>Foo</span> { <span class='ident'>u</span>: <span class='number'>2</span>, <span class='ident'>v</span>: <span class='number'>3</span> };
<span class='kw'>let</span> <span class='ident'>x</span> <span class='op'>=</span> <span class='kw-2'>*</span><span class='ident'>foo</span>; <span class='comment'>// let x: i32 = foo.u</span>
<span class='macro'>assert_eq</span><span class='macro'>!</span>(<span class='ident'>x</span>, <span class='number'>2</span>);<a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=fn%20main()%20%7B%0Ause%20std%3A%3Aops%3A%3ADeref%3B%0A%0Astruct%20Foo%20%7B%0A%20%20%20u%3A%20i32%2C%0A%20%20%20v%3A%20i32%2C%0A%7D%0A%0Aimpl%20Deref%20for%20Foo%20%7B%0A%20%20%20%20type%20Target%20%3D%20i32%3B%0A%0A%20%20%20%20fn%20deref(%26self)%20-%3E%20%26i32%20%7B%0A%20%20%20%20%20%20%20%20%26self.u%0A%20%20%20%20%7D%0A%7D%0A%0Alet%20foo%20%3D%20Foo%20%7B%20u%3A%202%2C%20v%3A%203%20%7D%3B%0Alet%20x%20%3D%20*foo%3B%20%2F%2F%20let%20x%3A%20i32%20%3D%20foo.u%0Aassert_eq!(x%2C%202)%3B%0A%7D">Run</a></pre>

<p>Under the rvalue context, we have:</p>

<pre class='rust rust-example-rendered'>
<span class='kw'>pub</span> <span class='kw'>trait</span> <span class='ident'>DerefMut</span>: <span class='ident'>Deref</span> {
    <span class='kw'>fn</span> <span class='ident'>deref_mut</span>(<span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='self'>self</span>) <span class='op'>-&gt;</span> <span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='self'>Self</span>::<span class='ident'>Target</span>;
}<a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=fn%20main()%20%7B%0Apub%20trait%20DerefMut%3A%20Deref%20%7B%0A%20%20%20%20fn%20deref_mut(%26mut%20self)%20-%3E%20%26mut%20Self%3A%3ATarget%3B%0A%7D%0A%7D">Run</a></pre>

<p>Note that <code>DerefMut</code> was built on top of <code>Deref</code>. This ensures that the underlying type returned by different context stays consistent.</p>

<p>Continuing with our example above, we implement <code>DerefMut</code> for <code>Foo</code> as well:</p>

<pre class='rust rust-example-rendered'>
<span class='kw'>use</span> <span class='ident'>std</span>::<span class='ident'>ops</span>::<span class='ident'>DerefMut</span>;

<span class='kw'>impl</span> <span class='ident'>DerefMut</span> <span class='kw'>for</span> <span class='ident'>Foo</span> {
    <span class='kw'>fn</span> <span class='ident'>deref_mut</span>(<span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='self'>self</span>) <span class='op'>-&gt;</span> <span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='ident'>i32</span> {
        <span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='self'>self</span>.<span class='ident'>v</span>
    }
}

<span class='kw'>let</span> <span class='kw-2'>mut</span> <span class='ident'>foo</span> <span class='op'>=</span> <span class='ident'>Foo</span> { <span class='ident'>u</span>: <span class='number'>0</span>, <span class='ident'>v</span>: <span class='number'>0</span> };
<span class='kw-2'>*</span><span class='ident'>foo</span> <span class='op'>=</span> <span class='number'>2</span>; <span class='comment'>// foo.v = 2</span>
<span class='macro'>assert_eq</span><span class='macro'>!</span>(<span class='number'>0</span>, <span class='kw-2'>*</span><span class='ident'>foo</span>); <span class='comment'>// foo.u == 0</span>
<span class='macro'>assert_eq</span><span class='macro'>!</span>(<span class='number'>2</span>, <span class='ident'>foo</span>.<span class='ident'>v</span>); <span class='comment'>// foo.v == 2</span><a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=fn%20main()%20%7B%0Ause%20std%3A%3Aops%3A%3ADerefMut%3B%0Ause%20std%3A%3Aops%3A%3ADeref%3B%0A%0Astruct%20Foo%20%7B%0A%20%20%20u%3A%20i32%2C%0A%20%20%20v%3A%20i32%2C%0A%7D%0A%0Aimpl%20Deref%20for%20Foo%20%7B%0A%20%20%20%20type%20Target%20%3D%20i32%3B%0A%0A%20%20%20%20fn%20deref(%26self)%20-%3E%20%26i32%20%7B%0A%20%20%20%20%20%20%20%20%26self.u%0A%20%20%20%20%7D%0A%7D%0A%0Aimpl%20DerefMut%20for%20Foo%20%7B%0A%20%20%20%20fn%20deref_mut(%26mut%20self)%20-%3E%20%26mut%20i32%20%7B%0A%20%20%20%20%20%20%20%20%26mut%20self.v%0A%20%20%20%20%7D%0A%7D%0A%0Alet%20mut%20foo%20%3D%20Foo%20%7B%20u%3A%200%2C%20v%3A%200%20%7D%3B%0A*foo%20%3D%202%3B%20%2F%2F%20foo.v%20%3D%202%0Aassert_eq!(0%2C%20*foo)%3B%20%2F%2F%20foo.u%20%3D%3D%200%0Aassert_eq!(2%2C%20foo.v)%3B%20%2F%2F%20foo.v%20%3D%3D%202%0A%7D">Run</a></pre>

<p>In our example, we implement the two traits such that they actually return references to <em>different</em> places. This is merely a demonstration of the ability that we <em>can</em>, but in practice I don&#39;t see any reason that we <em>should</em>, as this may cause confusion to the user.</p>

<hr>

<p>Additionally, the module contains two traits for indexing operator <code>[]</code>. Like <code>*</code>, depending on the context, one of the two trait methods would be chosen.</p>

<pre class='rust rust-example-rendered'>
<span class='kw'>pub</span> <span class='kw'>trait</span> <span class='ident'>Index</span><span class='op'>&lt;</span><span class='ident'>Idx</span>: <span class='question-mark'>?</span><span class='ident'>Sized</span><span class='op'>&gt;</span> {
    <span class='kw'>type</span> <span class='ident'>Output</span>: <span class='question-mark'>?</span><span class='ident'>Sized</span>;
    <span class='kw'>fn</span> <span class='ident'>index</span>(<span class='kw-2'>&amp;</span><span class='self'>self</span>, <span class='ident'>index</span>: <span class='ident'>Idx</span>) <span class='op'>-&gt;</span> <span class='kw-2'>&amp;</span><span class='self'>Self</span>::<span class='ident'>Output</span>;
}

<span class='kw'>pub</span> <span class='kw'>trait</span> <span class='ident'>IndexMut</span><span class='op'>&lt;</span><span class='ident'>Idx</span>: <span class='question-mark'>?</span><span class='ident'>Sized</span><span class='op'>&gt;</span>: <span class='ident'>Index</span><span class='op'>&lt;</span><span class='ident'>Idx</span><span class='op'>&gt;</span> {
    <span class='kw'>fn</span> <span class='ident'>index_mut</span>(<span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='self'>self</span>, <span class='ident'>index</span>: <span class='ident'>Idx</span>) <span class='op'>-&gt;</span> <span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='self'>Self</span>::<span class='ident'>Output</span>;
}<a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=fn%20main()%20%7B%0Apub%20trait%20Index%3CIdx%3A%20%3FSized%3E%20%7B%0A%20%20%20%20type%20Output%3A%20%3FSized%3B%0A%20%20%20%20fn%20index(%26self%2C%20index%3A%20Idx)%20-%3E%20%26Self%3A%3AOutput%3B%0A%7D%0A%0Apub%20trait%20IndexMut%3CIdx%3A%20%3FSized%3E%3A%20Index%3CIdx%3E%20%7B%0A%20%20%20%20fn%20index_mut(%26mut%20self%2C%20index%3A%20Idx)%20-%3E%20%26mut%20Self%3A%3AOutput%3B%0A%7D%0A%7D">Run</a></pre>

<hr>

<p>Additionally, the module contains traits for operator<code>()</code>: <code>FnOnce</code>, <code>FnMut</code> and <code>Fn</code>. As the time of writing these three traits act more like a marker. Their usage and implementation are feature-gated, thus we might not discuss them here.</p>

<hr>

<p>Finally, the module contains the special trait <code>Drop</code>. This trait doesn&#39;t have any operator associated. Its associated method would get invoked when the value goes out of scope.</p>

<pre class='rust rust-example-rendered'>
<span class='kw'>pub</span> <span class='kw'>trait</span> <span class='ident'>Drop</span> {
    <span class='kw'>fn</span> <span class='ident'>drop</span>(<span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='self'>self</span>);
}<a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=fn%20main()%20%7B%0Apub%20trait%20Drop%20%7B%0A%20%20%20%20fn%20drop(%26mut%20self)%3B%0A%7D%0A%7D">Run</a></pre>

    <script src='rustbook.js'></script>
</div></div>


</body>
</html>